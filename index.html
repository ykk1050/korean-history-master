<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title>ì—­ì‚¬ì˜ ì„ íƒ: ê´‘ë³µì„ í–¥í•˜ì—¬</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nanum+Myeongjo:wght@400;700;800&display=swap');
        
        body {
            font-family: 'Nanum Myeongjo', serif;
            background-color: #f5f5f0;
            background-image: url('background.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            color: #2c2c2c;
        }
        
        .fade-in {
            animation: fadeIn 0.4s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .btn-card {
            transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1);
            background-color: #ffffff;
            color: #44403c;
            border: 1px solid #d6d3d1;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .btn-card:hover {
            transform: translateY(-2px);
            background-color: #fafaf9;
            border-color: #a8a29e;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .btn-card:active {
            transform: translateY(0);
            background-color: #f5f5f4;
        }

        .btn-special {
            background-color: #78350f !important;
            color: white !important;
            border-color: #78350f !important;
        }

        /* ì‹œëŒ€ë³„ ë±ƒì§€ ìŠ¤íƒ€ì¼ */
        .badge-ancient { background-color: #eab308; color: #fff; } /* ê³ ëŒ€ */
        .badge-goguryeo { background-color: #b91c1c; color: #fff; } /* ê³ êµ¬ë ¤ (ë¶‰ì€ ê¸°ìƒ) */
        .badge-goryeo { background-color: #0d9488; color: #fff; } /* ê³ ë ¤ (ì²­ììƒ‰) */
        .badge-joseon { background-color: #1d4ed8; color: #fff; } /* ì¡°ì„  (ì²­ìƒ‰) */
        .badge-modern { background-color: #4b5563; color: #fff; } /* ê·¼ëŒ€/ì¼ì œ */
        .badge-crisis { background-color: #dc2626; color: #fff; animation: pulse 2s infinite; } /* ìœ„ê¸° ìƒí™© */

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.8; }
            100% { opacity: 1; }
        }

        /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.6);
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .title-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .title-item.locked {
            color: #aaa;
            filter: grayscale(100%);
        }
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #333;
            color: #fff;
            padding: 12px 24px;
            border-radius: 24px;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 200;
            pointer-events: none;
        }

        /* ì›…ë…€ ë¯¸ë‹ˆê²Œì„ ìŠ¤íƒ€ì¼ */
        #minigame-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100dvh;
            background-color: rgba(0,0,0,0.8);
            background-image: url('dangunbackground.png');
            background-size: cover;
            background-position: center;
            z-index: 300;
            touch-action: none;
        }
        
        /* ë¯¸ë‹ˆê²Œì„ ìŠ¤íƒ€ì¼ */
        #river-game-overlay,
        #defense-game-window {
            display: none;
        }

        #defense-game-window {
            z-index: 9999; /* ìµœìƒìœ„ ë ˆì´ì–´ */
            touch-action: none;
        }
        .defense-frame {
            width: min(1200px, 96vw) !important;
            height: min(820px, 92dvh) !important;
        }
        @media (max-width: 640px) {
            .defense-frame {
                border-width: 2px;
            }
        }

        /* ì•ˆì¤‘ê·¼ ë¦¬ë“¬ ë¯¸ë‹ˆê²Œì„ */
        #ahn-game-overlay {
            display: none;
            position: fixed;
            inset: 0;
            width: 100vw;
            height: 100dvh;
            background: rgba(0,0,0,0.85);
            z-index: 520;
            touch-action: none;
            backdrop-filter: blur(4px);
        }
        .ahn-wrapper {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
        }
        .ahn-stage {
            position: relative;
            width: min(980px, 95vw);
            height: min(580px, 78dvh);
            background: url('ahn.png') center/cover no-repeat;
            border-radius: 18px;
            border: 3px solid rgba(255,255,255,0.2);
            box-shadow: 0 20px 40px rgba(0,0,0,0.45);
            overflow: hidden;
        }
        .ahn-darken {
            position: absolute;
            inset: 0;
            background: linear-gradient(180deg, rgba(0,0,0,0.55), rgba(0,0,0,0.75));
        }
        .ahn-hud {
            position: absolute;
            top: 16px;
            left: 50%;
            transform: translateX(-50%);
            color: #fff;
            text-align: center;
            z-index: 2;
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        .ahn-hud h2 {
            font-size: clamp(26px, 4vw, 42px);
            font-weight: 900;
            color: #facc15;
            text-shadow: 0 2px 8px rgba(0,0,0,0.6);
        }
        .ahn-lights {
            position: absolute;
            top: 10%;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 14px;
            z-index: 3;
            pointer-events: none;
        }
        .ahn-light {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: rgba(255,255,255,0.12);
            border: 3px solid rgba(255,255,255,0.35);
            box-shadow: inset 0 0 12px rgba(0,0,0,0.6);
            transition: background 0.12s, transform 0.12s;
        }
        .ahn-light.active {
            background: #f87171;
            transform: scale(1.08);
            box-shadow: 0 0 16px #f87171, inset 0 0 10px rgba(0,0,0,0.4);
        }
        .ahn-btn {
            position: absolute;
            bottom: 28px;
            left: 50%;
            transform: translateX(-50%);
            padding: 16px 26px;
            border-radius: 14px;
            border: 2px solid rgba(255,255,255,0.35);
            background: linear-gradient(90deg, #ef4444, #f97316);
            color: #fff;
            font-weight: 900;
            font-size: 18px;
            box-shadow: 0 12px 22px rgba(0,0,0,0.45);
            z-index: 2;
            touch-action: manipulation;
        }
        .ahn-result {
            position: absolute;
            inset: 0;
            display: none;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 12px;
            background: rgba(0,0,0,0.8);
            color: #fff;
            z-index: 3;
            text-align: center;
            padding: 20px;
        }
        .ahn-result h3 {
            font-size: clamp(26px, 4vw, 38px);
            font-weight: 800;
        }
        .ahn-result button {
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 800;
            border: 2px solid rgba(255,255,255,0.3);
            background: linear-gradient(90deg, #2563eb, #22d3ee);
            color: #fff;
            box-shadow: 0 10px 18px rgba(0,0,0,0.35);
        }
        .ahn-lane {
            position: absolute;
            inset: 12% 26% 20% 26%;
            display: flex;
            align-items: flex-start;
            justify-content: center;
            pointer-events: none;
            z-index: 2;
            touch-action: none;
        }
        .ahn-hitline {
            position: absolute;
            bottom: 12%;
            left: 0;
            width: 100%;
            height: 6px;
            background: linear-gradient(90deg, #f97316, #facc15);
            box-shadow: 0 0 12px rgba(250,204,21,0.7);
            opacity: 0.9;
        }
        .ahn-note {
            position: absolute;
            top: -80px;
            left: 50%;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            transform: translateX(-50%);
            background: radial-gradient(circle, #fef2f2 0%, #f87171 65%, #b91c1c 100%);
            box-shadow: 0 8px 18px rgba(0,0,0,0.45), 0 0 10px rgba(248,113,113,0.8);
            pointer-events: none;
        }
        .ahn-note.fast { width: 62px; height: 62px; background: radial-gradient(circle, #e0f2fe, #38bdf8 70%, #075985 100%); }
        .ahn-note.slow { width: 78px; height: 78px; background: radial-gradient(circle, #ecfccb, #a3e635 70%, #4d7c0f 100%); }

        @media (max-width: 768px) {
            .ahn-stage { width: 96vw; height: 70dvh; }
            .ahn-lane { inset: 10% 18% 24% 18%; }
            .ahn-lights { top: 8%; }
            .ahn-btn { bottom: 18px; font-size: 16px; padding: 14px 22px; }
        }

        /* í¥ì„ ëŒ€ì›êµ° ë¯¸ë‹ˆê²Œì„ (ì²™í™”ë¹„ ë•…ë”°ë¨¹ê¸°) */
        #heung-game-overlay {
            display: none;
            position: fixed;
            inset: 0;
            width: 100vw;
            height: 100dvh;
            background: rgba(0,0,0,0.9);
            z-index: 500;
            touch-action: none;
        }
        .heung-wrapper {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        #heung-game-area {
            position: absolute;
            inset: 0;
            background-image: url('Monument.png');
            background-size: contain; /* ì›ë³¸ ë¹„ìœ¨ ìœ ì§€, ì˜ë¦¼ ë°©ì§€ */
            background-repeat: no-repeat;
            background-position: center;
            background-color: black;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .heung-tile {
            position: absolute;
            background: rgba(0,0,0,0.85);
            pointer-events: none;
            transition: opacity 0.2s;
        }
        #heung-player {
            position: absolute;
            width: 96px;
            height: 96px;
            object-fit: contain;
            z-index: 5;
            filter: drop-shadow(0 0 6px #fff);
            transition: transform 0.1s;
        }
        .heung-ship {
            position: absolute;
            width: 140px;
            height: 140px;
            object-fit: contain;
            z-index: 4;
            filter: drop-shadow(0 0 8px #1f2937);
        }
        .heung-hud {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            text-align: center;
        }
        .heung-hearts {
            display: flex;
            gap: 6px;
            font-size: 22px;
            color: #f87171;
        }
        .heung-progress {
            min-width: 240px;
            background: rgba(0,0,0,0.4);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 999px;
            overflow: hidden;
        }
        .heung-progress-bar {
            height: 14px;
            width: 0%;
            background: linear-gradient(90deg, #fbbf24, #22d3ee, #34d399);
            transition: width 0.2s;
        }
        .heung-virtual-controls {
            position: absolute;
            bottom: 24px;
            right: 24px;
            display: grid;
            grid-template-columns: repeat(3, 64px);
            grid-template-rows: repeat(2, 64px);
            gap: 10px;
            z-index: 12;
            touch-action: none;
            padding-bottom: env(safe-area-inset-bottom, 0px);
            padding-right: env(safe-area-inset-right, 0px);
        }
        .heung-vbtn {
            width: 64px;
            height: 64px;
            background: rgba(255,255,255,0.25);
            border: 2px solid rgba(255,255,255,0.4);
            border-radius: 16px;
            color: white;
            font-size: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            user-select: none;
            backdrop-filter: blur(4px);
            touch-action: none;
        }
        .heung-vbtn:active {
            background: rgba(255,255,255,0.45);
        }
        .heung-vup { grid-column: 2; grid-row: 1; }
        .heung-vleft { grid-column: 1; grid-row: 2; }
        .heung-vdown { grid-column: 2; grid-row: 2; }
        .heung-vright { grid-column: 3; grid-row: 2; }
        @media (hover: hover) and (pointer: fine) {
            .heung-virtual-controls { display: none; }
        }
        #heung-result, #heung-fail {
            position: absolute;
            inset: 0;
            background: rgba(0,0,0,0.86);
            z-index: 20;
            display: none;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            color: white;
            text-align: center;
            padding: 20px;
            gap: 14px;
        }
        #heung-result h2, #heung-fail h2 {
            font-size: clamp(28px, 4vw, 44px);
            font-weight: 800;
            color: #fbbf24;
        }
        #heung-fail h2 { color: #f87171; }
        .heung-btn {
            padding: 14px 24px;
            border-radius: 14px;
            font-weight: 800;
            color: #fff;
            border: 2px solid rgba(255,255,255,0.3);
            background: linear-gradient(90deg, #2563eb, #22d3ee);
            box-shadow: 0 10px 20px rgba(0,0,0,0.35);
        }
        .heung-btn.fail {
            background: linear-gradient(90deg, #ef4444, #f97316);
        }

        #river-game-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100dvh;
            background-color: rgba(0,0,0,0.8);
            background-image: url('river.jpg');
            background-size: cover;
            background-position: center;
            z-index: 300;
            touch-action: none;
        }
        #jumong-char {
            position: absolute;
            width: 180px; /* 3ë°° í¬ê¸°: 60px * 3 */
            height: 180px; /* 3ë°° í¬ê¸°: 60px * 3 */
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            transition: all 0.3s ease-out;
            z-index: 320;
            pointer-events: none; /* í´ë¦­ í†µê³¼ */
            filter: drop-shadow(0 0 5px white);
        }
        .river-item {
            position: absolute;
            width: 210px; /* 3ë°° í¬ê¸°: 70px * 3 */
            height: 150px; /* 3ë°° í¬ê¸°: 50px * 3 */
            object-fit: contain;
            animation: float 2s infinite ease-in-out;
            transition: opacity 0.5s;
        }
        
        /* ê°€ìƒ ì»¨íŠ¸ë¡¤ëŸ¬ ìŠ¤íƒ€ì¼ */
        .virtual-controls {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: grid;
            grid-template-columns: repeat(3, 60px);
            grid-template-rows: repeat(2, 60px);
            gap: 10px;
            z-index: 330;
            touch-action: none;
            padding-bottom: env(safe-area-inset-bottom, 0px);
            padding-right: env(safe-area-inset-right, 0px);
        }
        .v-btn {
            width: 60px;
            height: 60px;
            background-color: rgba(255, 255, 255, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            user-select: none;
            cursor: pointer;
            backdrop-filter: blur(4px);
            touch-action: none;
        }
        .v-btn:active {
            background-color: rgba(255, 255, 255, 0.6);
        }
        .v-up { grid-column: 2; grid-row: 1; }
        .v-left { grid-column: 1; grid-row: 2; }
        .v-down { grid-column: 2; grid-row: 2; }
        .v-right { grid-column: 3; grid-row: 2; }
        
        /* í„°ì¹˜ ìŠ¤í¬ë¡¤ ë°©ì§€ */
        #rg-game-area, #heung-game-area, #defense-game-area, #mg-game-area {
            touch-action: none;
        }
        
        /* PCì—ì„œëŠ” ê°€ìƒ í‚¤íŒ¨ë“œë¥¼ ìˆ¨ê¸°ê³ , í„°ì¹˜ ë””ë°”ì´ìŠ¤ì—ì„œëŠ” í‘œì‹œ */
        @media (hover: hover) and (pointer: fine) {
            .virtual-controls {
                display: none;
            }
        }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        
        .falling-item {
            position: absolute;
            width: 80px;
            height: 80px;
            cursor: pointer;
            object-fit: contain;
            animation: fall linear forwards;
            user-select: none;
            touch-action: manipulation; 
        }
        @media (max-width: 768px) {
            .falling-item {
                width: 60px;
                height: 60px;
            }
        }
        @keyframes fall {
            from { top: -100px; transform: rotate(0deg); }
            to { top: 110vh; transform: rotate(360deg); }
        }
        .score-popup {
            position: absolute;
            font-size: 32px;
            font-weight: bold;
            pointer-events: none;
            animation: popup 0.8s ease-out forwards;
            z-index: 310;
            text-shadow: 2px 2px 0 #000;
        }
        @keyframes popup {
            0% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-50px); }
        }

        /* íƒ•í‰ì±… ë¯¸ë‹ˆê²Œì„ ìŠ¤íƒ€ì¼ */
        #faction-game-overlay {
            display: none;
            position: fixed;
            inset: 0;
            width: 100vw;
            height: 100dvh;
            background-color: rgba(0, 0, 0, 0.85);
            z-index: 450;
            touch-action: none;
        }
        #faction-game-overlay .bg-layer {
            position: absolute;
            inset: 0;
            background-image: url('indoor.png');
            background-size: cover;
            background-position: center;
            opacity: 0.55;
        }
        .faction-wrapper {
            position: relative;
            z-index: 1;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            padding: 20px;
            gap: 12px;
            color: #fff;
            overflow-y: auto;
            padding-bottom: env(safe-area-inset-bottom, 24px);
        }
        .faction-topbar {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            pointer-events: none;
            text-align: center;
        }
        .faction-gauge {
            width: min(560px, 90vw);
            height: 14px;
            background: rgba(255,255,255,0.12);
            border-radius: 999px;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.22);
        }
        .faction-gauge-bar {
            height: 100%;
            width: 50%;
            background: linear-gradient(90deg, #60a5fa, #fcd34d, #f472b6);
            transition: width 0.3s ease;
        }
        .faction-status {
            display: flex;
            gap: 12px;
            font-size: 14px;
            opacity: 0.9;
        }
        .faction-board {
            flex: 1;
            min-height: 0;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 14px;
        }
        .faction-column {
            position: relative;
            background: rgba(0, 0, 0, 0.35);
            border: 1px solid rgba(255,255,255,0.12);
            border-radius: 16px;
            padding: 14px;
            backdrop-filter: blur(4px);
            overflow: hidden;
            min-height: 0;
        }
        .faction-column h3 {
            text-align: center;
            font-weight: 800;
            letter-spacing: 1px;
            font-size: 24px;
            margin-bottom: 8px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.4);
        }
        .faction-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(4, 1fr);
            gap: 6px;
            width: 100%;
            height: calc(100% - 40px);
            min-height: 620px; /* ìºë¦­í„° 2ë°° í™•ëŒ€ì— ë§ì¶° ë†’ì´ í™•ë³´ */
        }
        .faction-cell {
            position: relative;
            background: rgba(0,0,0,0.15);
            border: 1px dashed rgba(255,255,255,0.12);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        .faction-figure {
            width: 144px;  /* 2ë°° í™•ëŒ€ */
            height: 144px; /* 2ë°° í™•ëŒ€ */
            object-fit: contain;
            animation: float 2s ease-in-out infinite;
            pointer-events: none;
        }
        .faction-controls {
            position: sticky;
            bottom: 0;
            z-index: 2;
            display: flex;
            gap: 12px;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            padding: 12px;
            margin-top: auto;
            background: rgba(0,0,0,0.35);
            backdrop-filter: blur(8px);
        }
        @media (max-width: 768px) {
            .faction-wrapper {
                padding: 12px;
            }
            .faction-controls {
                gap: 8px;
                padding: 10px;
            }
        }
        .faction-btn {
            padding: 14px 20px;
            border-radius: 12px;
            font-weight: 800;
            color: #fff;
            border: 2px solid rgba(255,255,255,0.3);
            background: rgba(0,0,0,0.35);
            backdrop-filter: blur(4px);
            min-width: 140px;
            transition: transform 0.15s ease, background 0.2s ease;
        }
        .faction-btn:active {
            transform: scale(0.97);
            background: rgba(255,255,255,0.12);
        }
        .faction-result {
            position: absolute;
            inset: 0;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            text-align: center;
            padding: 20px;
            gap: 16px;
        }
        .faction-result h2 {
            font-size: clamp(28px, 4vw, 42px);
            font-weight: 800;
            color: #fbbf24;
            text-shadow: 0 3px 8px rgba(0,0,0,0.5);
        }
        .faction-result p {
            font-size: clamp(16px, 2.6vw, 22px);
            line-height: 1.6;
            color: #f5f5f5;
        }
        @media (max-width: 900px) {
            .faction-board {
                grid-template-columns: 1fr;
                grid-template-rows: repeat(2, 1fr);
            }
            .faction-grid {
                height: 240px;
            }
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-2 md:p-4 gap-4">
    <!-- ì›…ë…€ ë¯¸ë‹ˆê²Œì„ ì˜¤ë²„ë ˆì´ -->
    <div id="minigame-overlay" style="touch-action: none;">
        <!-- ì ìˆ˜íŒ -->
        <div class="absolute top-4 left-4 bg-black/60 text-white p-4 rounded-lg z-10 border border-white/30 backdrop-blur-sm">
            <div id="mg-title-text" class="text-3xl font-bold mb-2 text-yellow-400 select-none cursor-pointer">ì¸ë‚´ì‹¬: <span id="mg-score">0</span> / 100</div>
            <div class="text-sm text-gray-200">
                <span class="text-green-400 font-bold">â— ì‘¥ & ë§ˆëŠ˜: +2ì </span><br>
                <span class="text-red-400 font-bold">â— ê³ ê¸° & ë²¼: -2ì </span>
            </div>
        </div>
        
        <!-- ê²Œì„ ì˜ì—­ -->
        <div id="mg-game-area" class="w-full h-full absolute top-0 left-0 overflow-hidden"></div>

        <!-- ê²°ê³¼ ë©”ì‹œì§€ -->
        <div id="mg-result" class="hidden absolute inset-0 flex flex-col items-center justify-center bg-black/80 z-50 text-white text-center p-8 transition-opacity duration-500">
            <h2 class="text-5xl font-bold mb-8 text-yellow-400 animate-bounce">ğŸ» ì¸ë‚´ì˜ ê²°ì‹¤ ğŸ‰</h2>
            <p class="text-2xl mb-12 leading-loose">
                ê³°ì´ ì‚¬ëŒìœ¼ë¡œ ë³€í•˜ëŠ”ë° ì„±ê³µí•˜ì—¬<br>
                í™˜ì›…ê³¼ ê²°í˜¼í•˜ê³ ,<br>
                <span class="font-bold text-yellow-200">ë‹¨êµ°ì™•ê²€</span>ì´ íƒœì–´ë‚˜<br>
                ê³ ì¡°ì„ ì„ ì„¸ì› ìŠµë‹ˆë‹¤!
            </p>
            <button id="mg-proceed-btn" class="px-10 py-5 bg-blue-600 hover:bg-blue-500 text-white rounded-full text-2xl font-bold transition transform hover:scale-105 shadow-xl border-4 border-blue-400">
                ì—­ì‚¬ ê³„ì†í•˜ê¸° â–¶
            </button>
        </div>
    </div>

    <!-- ì£¼ëª½ ê°• ê±´ë„ˆê¸° ë¯¸ë‹ˆê²Œì„ ì˜¤ë²„ë ˆì´ -->
    <div id="river-game-overlay" style="touch-action: none;">
        <!-- ì•ˆë‚´ ë©”ì‹œì§€ -->
        <div class="absolute top-4 left-0 w-full text-center z-20 pointer-events-none">
            <div class="inline-block bg-black/60 text-white px-6 py-2 rounded-full border border-white/30 backdrop-blur-sm">
                <span class="text-yellow-400 font-bold">ë¬¼ê³ ê¸°</span>ì™€ <span class="text-green-400 font-bold">ìë¼</span>ë¥¼ ë°Ÿê³  ê°•ì„ ê±´ë„ˆì„¸ìš”!
            </div>
        </div>

        <!-- ê²Œì„ ì˜ì—­ -->
        <div id="rg-game-area" class="w-full h-full absolute top-0 left-0 overflow-hidden">
            <!-- ì£¼ëª½ ìºë¦­í„° -->
            <img id="jumong-char" src="mong.png" alt="ì£¼ëª½">
        </div>

        <!-- ê°€ìƒ ì»¨íŠ¸ë¡¤ëŸ¬ -->
        <div class="virtual-controls">
            <div class="v-btn v-up" data-dir="up">â–²</div>
            <div class="v-btn v-left" data-dir="left">â—€</div>
            <div class="v-btn v-down" data-dir="down">â–¼</div>
            <div class="v-btn v-right" data-dir="right">â–¶</div>
        </div>

        <!-- ê²°ê³¼ ë©”ì‹œì§€ -->
        <div id="rg-result" class="hidden absolute inset-0 flex flex-col items-center justify-center bg-black/80 z-50 text-white text-center p-8 transition-opacity duration-500">
            <h2 class="text-5xl font-bold mb-8 text-blue-400 animate-bounce">ğŸŒŠ íƒˆì¶œ ì„±ê³µ! ğŸ</h2>
            <p class="text-2xl mb-12 leading-loose">
                ì£¼ëª½ì´ ë¶€ì—¬ì˜ ì™•ìë“¤ë¡œë¶€í„°<br>
                ë¬´ì‚¬íˆ íƒˆì¶œí–ˆìŠµë‹ˆë‹¤!<br><br>
                <span class="font-bold text-yellow-200">ì£¼ëª½ì€ ì¡¸ë³¸ìœ¼ë¡œ í–¥í•©ë‹ˆë‹¤!</span>
            </p>
            <button id="rg-proceed-btn" class="px-10 py-5 bg-blue-600 hover:bg-blue-500 text-white rounded-full text-2xl font-bold transition transform hover:scale-105 shadow-xl border-4 border-blue-400">
                ê³ êµ¬ë ¤ ê±´êµ­í•˜ê¸° â–¶
            </button>
        </div>

        <!-- ì‹¤íŒ¨ ë©”ì‹œì§€ -->
        <div id="rg-failure" class="hidden absolute inset-0 flex flex-col items-center justify-center bg-black/90 z-50 text-white text-center p-8 transition-opacity duration-500">
            <h2 class="text-5xl font-bold mb-8 text-red-400 animate-pulse">ğŸ’” íƒˆì¶œ ì‹¤íŒ¨ ğŸ˜¢</h2>
            <p class="text-2xl mb-12 leading-loose">
                ë¬¼ê³ ê¸°ì™€ ìë¼ê°€ ëª¨ë‘ ì‚¬ë¼ì ¸<br>
                ê°•ì„ ê±´ë„ˆì§€ ëª»í–ˆìŠµë‹ˆë‹¤.<br><br>
                <span class="font-bold text-red-300">ì£¼ëª½ì€ ë¶€ì—¬ ì™•ìë“¤ì—ê²Œ ì¡í˜”ìŠµë‹ˆë‹¤.<br>
                ê³ êµ¬ë ¤ì˜ ì—­ì‚¬ëŠ” ê°•ë¬¼ ì†ìœ¼ë¡œ ì‚¬ë¼ì¡ŒìŠµë‹ˆë‹¤.</span>
            </p>
            <button id="rg-restart-btn" class="px-10 py-5 bg-red-600 hover:bg-red-500 text-white rounded-full text-2xl font-bold transition transform hover:scale-105 shadow-xl border-4 border-red-400">
                ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘ ğŸ”„
            </button>
        </div>
    </div>

    <!-- íƒ•í‰ì±… ê· í˜• ë¯¸ë‹ˆê²Œì„ ì˜¤ë²„ë ˆì´ -->
    <div id="faction-game-overlay">
        <div class="bg-layer"></div>
        <div class="faction-wrapper">
            <div class="faction-topbar">
                <div class="text-xl md:text-2xl font-extrabold drop-shadow">íƒ•í‰ì±…: ë‹¹íŒŒ ê· í˜•ì„ ë§ì¶”ì„¸ìš”</div>
                <div class="faction-gauge">
                    <div id="faction-balance-bar" class="faction-gauge-bar" style="width: 50%;"></div>
                </div>
                <div class="faction-status">
                    <span id="faction-balance-wrap">
                        ê· í˜• ìœ ì§€ ì‹œê°„: <span id="faction-balance-time">0</span>
                        <span id="faction-balance-target"> / 60ì´ˆ</span>
                    </span>
                    <span id="faction-unbalance-text" class="hidden">
                        ê· í˜• ê¹¨ì§! <span id="faction-unbalance-left">3</span>ì´ˆ í›„ ê²Œì„ ì˜¤ë²„
                    </span>
                </div>
            </div>

            <div class="faction-board">
                <div class="faction-column">
                    <h3>ë…¸ë¡ </h3>
                    <div id="noron-grid" class="faction-grid"></div>
                </div>
                <div class="faction-column">
                    <h3>ì†Œë¡ </h3>
                    <div id="soron-grid" class="faction-grid"></div>
                </div>
            </div>

            <div class="faction-controls">
                <button id="noron-btn" class="faction-btn bg-amber-600/60 hover:bg-amber-500/60">ë…¸ë¡  ë“±ìš©</button>
                <button id="soron-btn" class="faction-btn bg-blue-600/60 hover:bg-blue-500/60">ì†Œë¡  ë“±ìš©</button>
            </div>

            <div id="faction-result" class="faction-result">
                <h2>ğŸ‰ ê· í˜• ë‹¬ì„±!</h2>
                <p>ì—¬ëŸ¬ ë‹¹íŒŒì˜ ì‹ í•˜ë“¤ì˜ ìˆ«ìê°€ ê³ ë¥´ê²Œ ë¶„ë°°ë˜ì—ˆìŠµë‹ˆë‹¤.<br>
                íƒ•í‰ì±…ì´ íš¨ê³¼ë¥¼ ë°œíœ˜í•˜ì—¬ ì¡°ì„ ì´ ë” ë‚˜ì€ ë‚˜ë¼ê°€ ë©ë‹ˆë‹¤!</p>
                <button id="faction-proceed-btn" class="px-8 py-4 bg-emerald-600 hover:bg-emerald-500 text-white font-bold rounded-xl border border-white/30 shadow-xl">ì§„í–‰í•˜ê¸° â–¶</button>
            </div>
        </div>
    </div>

    <!-- í¥ì„ ëŒ€ì›êµ° ì²™í™”ë¹„ ë¯¸ë‹ˆê²Œì„ ì˜¤ë²„ë ˆì´ -->
    <div id="heung-game-overlay">
        <div class="heung-wrapper">
            <div class="heung-hud">
                <div class="font-bold text-lg text-white drop-shadow">ì²™í™”ë¹„ë¥¼ ì™„ì„±í•˜ë¼!</div>
                <div class="heung-hearts" id="heung-hearts">â¤ï¸â¤ï¸â¤ï¸</div>
                <div class="heung-progress">
                    <div id="heung-progress-bar" class="heung-progress-bar"></div>
                </div>
                <div class="text-sm text-amber-200 drop-shadow">ìˆ¨ê²¨ì§„ ê·¸ë¦¼ì„ 80% ì´ìƒ ë“œëŸ¬ë‚´ì„¸ìš”</div>
            </div>

            <div id="heung-game-area">
                <canvas id="heung-mask" class="absolute inset-0 w-full h-full"></canvas>
            </div>

            <!-- ê°€ìƒ í‚¤íŒ¨ë“œ -->
            <div class="heung-virtual-controls">
                <div class="heung-vbtn heung-vup" data-dir="up">â–²</div>
                <div class="heung-vbtn heung-vleft" data-dir="left">â—€</div>
                <div class="heung-vbtn heung-vdown" data-dir="down">â–¼</div>
                <div class="heung-vbtn heung-vright" data-dir="right">â–¶</div>
            </div>

            <!-- ì„±ê³µ -->
            <div id="heung-result">
                <h2>ì²™í™”ë¹„ ì™„ì„±! ğŸ‰</h2>
                <p class="text-lg leading-relaxed">
                    ì²™í™”ë¹„ê°€ ì™„ì„±ë˜ì–´ ì¡°ì„ ì˜ ëª¨ë“  ë°±ì„±ë“¤ì´<br>
                    ì„œì–‘ ì„¸ë ¥ì„ ë§‰ê³ ì í•˜ëŠ” ëŒ€ì›êµ°ì˜ ëœ»ì„ ì•Œê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤!<br><br>
                    ì•ìœ¼ë¡œ ì¡°ì„ ì˜ ìš´ëª…ì€?
                </p>
                <button id="heung-proceed-btn" class="heung-btn">ì§„í–‰í•˜ê¸° â–¶</button>
            </div>

            <!-- ì‹¤íŒ¨ -->
            <div id="heung-fail">
                <h2>ëª©ìˆ¨ì„ ëª¨ë‘ ìƒì—ˆìŠµë‹ˆë‹¤â€¦</h2>
                <p class="text-lg leading-relaxed">
                    ì´ì–‘ì„ ì— ë§ì„œë‹¤ ì“°ëŸ¬ì¡ŒìŠµë‹ˆë‹¤.<br>
                    ë‹¤ì‹œ ì‹œì‘í•˜ì—¬ ê°œêµ­: í•˜ëŠ˜ì˜ ëœ»ì„ ì‡ë‹¤ë¶€í„° ì„ íƒí•˜ì„¸ìš”.
                </p>
                <button id="heung-restart-btn" class="heung-btn fail">ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸° ğŸ”„</button>
            </div>
        </div>
    </div>

    <!-- ì•ˆì¤‘ê·¼ ë¦¬ë“¬ ë¯¸ë‹ˆê²Œì„ -->
    <div id="ahn-game-overlay">
        <div class="ahn-wrapper">
            <div class="ahn-stage">
                <div class="ahn-darken"></div>
                <div class="ahn-hud">
                    <h2>íƒ•! íƒ•! íƒ•! ë¦¬ë“¬ì— ë§ì¶° ì‚¬ê²©</h2>
                    <div class="text-sm text-amber-200">ë¶ˆë¹›ì´ ì¼œì§ˆ ë•Œ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì£¼ì„¸ìš” (3íšŒ)</div>
                    <div class="text-xs text-stone-200 opacity-80">ì„±ê³µí•˜ë©´ "ì½”ë ˆì•„ ìš°ë¼!"</div>
                </div>
                <div class="ahn-lane">
                    <div class="ahn-hitline" id="ahn-hitline"></div>
                </div>
                <div class="ahn-lights">
                    <div class="ahn-light" id="ahn-light-1"></div>
                    <div class="ahn-light" id="ahn-light-2"></div>
                    <div class="ahn-light" id="ahn-light-3"></div>
                </div>
                <button id="ahn-hit-btn" class="ahn-btn">ë°œì‚¬ / ë°•ì ì…ë ¥</button>
                <div id="ahn-result-ok" class="ahn-result">
                    <h3>ğŸ¯ ëª…ì¤‘! ì½”ë ˆì•„ ìš°ë¼!</h3>
                    <p>ì„¸ ë°œì„ ì •í™•íˆ ë‚ ë ¸ìŠµë‹ˆë‹¤. ì´í†  íˆë¡œë¶€ë¯¸ë¥¼ ì‚¬ì‚´í•˜ì˜€ìŠµë‹ˆë‹¤.</p>
                    <button id="ahn-proceed-btn">ë‹¤ìŒìœ¼ë¡œ â–¶</button>
                </div>
                <div id="ahn-result-fail" class="ahn-result">
                    <h3>ğŸ’¥ ì´í†  íˆë¡œë¶€ë¯¸ë¥¼ ì‚¬ì‚´í•˜ëŠ”ë° ì‹¤íŒ¨í•˜ê³  ì•ˆì¤‘ê·¼ì€ ë¶™ì¡í˜“ìŠµë‹ˆë‹¤.</h3>
                    <p>ë‹¤ì‹œ ì‹œë„í•´ ë³´ì„¸ìš”.</p>
                    <button id="ahn-retry-btn">ë‹¤ì‹œ ë„ì „</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ì˜¬ë°”ë¥¸ ì„ íƒ ê²°ê³¼ ì˜¤ë²„ë ˆì´ -->
    <!-- ëª…ì˜ˆì˜ ì „ë‹¹ (íƒœê·¹ê¸° ì›Œë“œí´ë¼ìš°ë“œ) ëª¨ë‹¬ -->
    <div id="hof-modal" class="modal hidden fixed inset-0 bg-black/90 z-[15000] flex items-center justify-center p-4">
        <div class="bg-stone-100 rounded-2xl shadow-2xl max-w-5xl w-full p-6 text-stone-800 border border-stone-300 relative flex flex-col max-h-[95vh]">
            <button onclick="closeHofModal()" class="absolute top-4 right-4 text-stone-500 hover:text-stone-800 text-3xl font-bold z-10">âœ•</button>
            
            <h2 class="text-3xl font-extrabold text-stone-900 mb-2 text-center font-serif">ğŸ‡°ğŸ‡· ëª…ì˜ˆì˜ ì „ë‹¹</h2>
            <p class="text-center text-stone-600 mb-4">ê´‘ë³µì„ ì´ë¤„ë‚¸ ì˜ì›…ë“¤ì˜ ì´ë¦„ì´ ëª¨ì—¬ íƒœê·¹ê¸°ë¥¼ ì™„ì„±í•©ë‹ˆë‹¤. ìµœê·¼ 1ì‹œê°„ ì´ë‚´ì— ë“±ë¡ëœ ì´ë¦„ì€ íŠ¹ë³„í•˜ê²Œ í‘œì‹œë©ë‹ˆë‹¤.</p>
            
            <!-- ì…ë ¥ í¼ (ì•„ì§ ë“±ë¡ ì•ˆí•œ ê²½ìš°) -->
            <div id="hof-input-area" class="flex flex-col items-center gap-3 mb-4 hidden">
                <div class="flex gap-2 w-full max-w-md">
                    <input type="text" id="hof-nickname" placeholder="ë…ë¦½ ìœ ê³µì(ë‹‰ë„¤ì„) ì…ë ¥" class="flex-1 px-4 py-2 border border-stone-400 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 font-bold" maxlength="10">
                    <button onclick="submitHofName()" class="px-6 py-2 bg-amber-600 hover:bg-amber-700 text-white font-bold rounded-lg whitespace-nowrap">ë“±ë¡</button>
                </div>
                <p id="hof-registration-info" class="text-xs text-stone-500">â€» ìš•ì„¤ì´ë‚˜ ë¶€ì ì ˆí•œ ë‹¨ì–´ëŠ” ì‚­ì œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            </div>

            <!-- íƒœê·¹ê¸° ìº”ë²„ìŠ¤ ì˜ì—­ -->
            <div class="flex-1 bg-white rounded-xl shadow-inner border border-stone-200 relative overflow-hidden flex items-center justify-center min-h-[400px]" id="hof-canvas-container">
                <canvas id="hof-canvas" class="max-w-full max-h-full"></canvas>
                <div id="hof-loading" class="absolute inset-0 flex items-center justify-center bg-white/80 z-10 hidden">
                    <span class="text-xl font-bold text-stone-500 animate-pulse">ì˜ì›…ë“¤ì˜ ì´ë¦„ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</span>
                </div>
            </div>
            
            <div class="mt-4 text-center text-stone-400 text-xs">
                Total Heroes: <span id="hof-count">0</span>
            </div>
        </div>
    </div>

    <!-- ë¯¸ë‹ˆê²Œì„ ì„ íƒ ëª¨ë‹¬ -->
    <div id="minigame-modal" class="modal hidden fixed inset-0 bg-black/90 z-[13000] flex items-center justify-center p-4">
        <div class="bg-stone-800 rounded-2xl shadow-2xl max-w-4xl w-full p-6 text-stone-100 max-h-[90vh] overflow-y-auto border border-stone-600">
            <div class="flex justify-between items-center mb-6 border-b border-stone-700 pb-4">
                <h2 class="text-3xl font-extrabold text-amber-400">ğŸ® ë¯¸ë‹ˆê²Œì„ ì•„ì¼€ì´ë“œ</h2>
                <button onclick="closeMinigameMenu()" class="text-stone-400 hover:text-white text-2xl">âœ•</button>
            </div>
            <p class="text-stone-400 mb-6 text-center">ì‹œê°„ ì œí•œ ì—†ëŠ” ë¬´í•œ ëª¨ë“œ ë˜ëŠ” ê¸°ë¡ ê°±ì‹ ì— ë„ì „í•˜ì„¸ìš”!</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="minigame-list">
                <!-- ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ë™ì  ìƒì„± -->
            </div>
        </div>
    </div>

    <!-- ë¯¸ë‹ˆê²Œì„ ê²°ê³¼ ì˜¤ë²„ë ˆì´ (ì•„ì¼€ì´ë“œìš©) -->
    <div id="arcade-result-overlay" class="hidden fixed inset-0 bg-black/90 z-[14000] flex items-center justify-center p-6">
        <div class="bg-stone-900 border-2 border-amber-500 rounded-2xl shadow-2xl max-w-md w-full p-8 text-center relative">
            <h2 id="arcade-result-title" class="text-3xl font-bold text-amber-400 mb-2">GAME OVER</h2>
            <div class="text-6xl mb-4 py-4" id="arcade-result-icon">ğŸ</div>
            <p id="arcade-result-score" class="text-2xl text-white font-mono mb-2">Score: 100</p>
            <p id="arcade-result-best" class="text-sm text-stone-400 mb-8">Best: 200</p>
            
            <div class="flex flex-col gap-3">
                <button onclick="closeArcadeResult()" class="w-full py-3 bg-stone-700 hover:bg-stone-600 text-stone-300 font-bold rounded-lg">ë©”ë‰´ë¡œ ë‚˜ê°€ê¸°</button>
            </div>
        </div>
    </div>

    <div id="choice-result-overlay" class="hidden fixed inset-0 bg-black/80 z-[12000] flex items-center justify-center p-6">
        <div class="bg-white rounded-2xl shadow-2xl max-w-xl w-full p-6 space-y-4 text-center">
            <h2 id="choice-result-title" class="text-2xl font-extrabold text-stone-800"></h2>
            <p id="choice-result-desc" class="text-stone-700 leading-relaxed"></p>
            <button id="choice-result-proceed" class="px-6 py-3 bg-blue-600 text-white font-bold rounded-xl hover:bg-blue-500">ì§„í–‰í•˜ê¸° â–¶</button>
        </div>
    </div>

    <div class="max-w-4xl w-full bg-white rounded-xl shadow-2xl overflow-hidden border border-stone-300 relative fade-in" id="game-container">
        
        <!-- ìƒë‹¨ í—¤ë” -->
        <div class="bg-stone-900 text-stone-200 px-6 py-4 flex justify-between items-center shadow-md z-10 relative">
            <div class="flex flex-col">
                <span id="current-era-badge" class="text-xs font-bold px-2 py-1 rounded mb-1 w-fit bg-stone-600">ì‹œëŒ€ ë¯¸ì •</span>
                <span id="scene-title-header" class="font-bold text-lg md:text-xl text-stone-100">ê²Œì„ ì‹œì‘</span>
            </div>
            <div class="text-right flex flex-col items-end">
                <span id="game-year" class="block text-2xl font-serif text-amber-500 font-bold">START</span>
                <div class="flex gap-3 mt-1">
                    <button id="minigame-menu-btn" onclick="showMinigameMenu()" class="text-xs text-amber-400 hover:text-amber-300 underline hidden font-bold">ğŸ® ë¯¸ë‹ˆê²Œì„</button>
                    <button id="hof-menu-btn" onclick="openHofModal(false)" class="text-xs text-blue-400 hover:text-blue-300 underline hidden font-bold">ğŸ‡°ğŸ‡· ëª…ì˜ˆì˜ ì „ë‹¹</button>
                    <button onclick="showTitles()" class="text-xs text-stone-400 hover:text-stone-200 underline">ğŸ† ì—…ì  ë³´ê¸°</button>
                </div>
            </div>
        </div>

        <!-- ì§„í–‰ë°” -->
        <div class="w-full bg-stone-200 h-2">
            <div class="bg-amber-700 h-2 transition-all duration-500 ease-out relative" id="progress-bar" style="width: 0%"></div>
        </div>

        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <div class="p-6 md:p-10 flex flex-col md:flex-row gap-8">
            
            <!-- ì™¼ìª½: ì´ë¯¸ì§€/ì•„ì´ì½˜ ì˜ì—­ -->
            <div class="md:w-1/4 flex flex-col items-center justify-start pt-4">
                <div id="scene-icon" class="w-24 h-24 md:w-32 md:h-32 rounded-full bg-stone-50 flex items-center justify-center text-6xl md:text-7xl shadow-inner border-4 border-stone-200 mb-4">
                    ğŸ“œ
                </div>
                <div class="text-center text-stone-500 text-sm font-bold" id="era-name">ì—­ì‚¬ì˜ ì„œë§‰</div>
            </div>

            <!-- ì˜¤ë¥¸ìª½: í…ìŠ¤íŠ¸ ë° ì„ íƒì§€ -->
            <div class="md:w-3/4">
                <div class="bg-stone-50 p-6 rounded-lg border border-stone-200 mb-6 shadow-sm relative">
                    <span class="absolute top-0 left-0 text-4xl text-stone-200 p-2 transform -translate-y-2 -translate-x-2">â</span>
                    <p id="scene-desc" class="text-lg leading-loose text-stone-800 break-keep text-justify relative z-10">
                        í™˜ì˜í•©ë‹ˆë‹¤. ë‹¹ì‹ ì€ ì´ì œ ë°˜ë§Œë…„ ì—­ì‚¬ì˜ ê²°ì •ì ì¸ ìˆœê°„ë§ˆë‹¤ ê°œì…í•˜ê²Œ ë©ë‹ˆë‹¤.<br><br>
                        êµê³¼ì„œì˜ ìš”ì•½ëœ ë¬¸ì¥ì´ ì•„ë‹Œ, ìƒìƒí•œ ì—­ì‚¬ì˜ í˜„ì¥ ì†ì—ì„œ ì˜¬ë°”ë¥¸ ì„ íƒì„ í•´ì£¼ì‹­ì‹œì˜¤. ë‹¹ì‹ ì˜ ì„ íƒ í•˜ë‚˜í•˜ë‚˜ê°€ ì´ ë•…ì˜ ìš´ëª…ì„ ë°”ê¿€ ê²ƒì…ë‹ˆë‹¤.
                    </p>
                </div>

                <!-- ì„ íƒì§€ ì˜ì—­ -->
                <div id="choices" class="space-y-3">
                    <button onclick="startGame()" class="w-full py-4 px-6 rounded-lg font-bold text-lg btn-card border-stone-400 text-stone-800 shadow-md">
                        ì—­ì‚¬ì˜ ëŒ€ì¥ì • ì‹œì‘í•˜ê¸°
                    </button>
                </div>
            </div>
        </div>

        <!-- í•˜ë‹¨ í‘¸í„° -->
        <div class="bg-stone-100 p-3 text-center text-xs text-stone-400 border-t border-stone-200 flex justify-between px-8">
            <span>âšœï¸ í•œêµ­ì‚¬ ëŒ€ì„œì‚¬ì‹œ</span>
            <span id="turn-count">Turn: 0</span>
        </div>
    </div>

    <!-- ì—…ì  ëª¨ë‹¬ -->
    <div id="title-modal" class="modal" onclick="closeTitles(event)">
        <div class="modal-content">
            <h2 class="text-2xl font-bold mb-4 text-stone-800 border-b pb-2">ğŸ† íšë“í•œ ì¹­í˜¸</h2>
            <div id="title-list" class="space-y-2">
                <!-- ì¹­í˜¸ ëª©ë¡ì´ ì—¬ê¸°ì— í‘œì‹œë¨ -->
            </div>
            <button onclick="document.getElementById('title-modal').style.display='none'" class="mt-6 w-full py-2 bg-stone-600 text-white rounded hover:bg-stone-700">ë‹«ê¸°</button>
        </div>
    </div>

    <!-- í† ìŠ¤íŠ¸ ë©”ì‹œì§€ -->
    <div id="toast" class="toast">ì¹­í˜¸ íšë“!</div>

    <!-- ì‚¼ë³„ì´ˆ ë°©ì–´ì „ ë¯¸ë‹ˆê²Œì„ ìƒˆ ì°½ -->
    <div id="defense-game-window" class="hidden fixed inset-0 bg-black z-50 flex items-center justify-center">
        <div class="bg-gradient-to-b from-blue-900 to-green-900 w-11/12 h-5/6 defense-frame rounded-lg shadow-2xl border-4 border-yellow-400 overflow-hidden relative">
            <!-- í—¤ë” -->
            <div class="bg-yellow-600 text-black p-4 text-center font-bold text-xl border-b-4 border-yellow-400">
                ğŸ° ê³ ë ¤ ëŒ€ëª½ í•­ìŸ 1231ë…„~ ğŸ¹
            </div>

            <!-- ê²Œì„ ì˜ì—­ -->
            <div id="defense-game-area" class="w-full h-full relative overflow-hidden" style="background-image: url('forestbackground.png'); background-size: cover; background-position: center;">
                <!-- ì„± (ì™¼ìª½ ì•„ë˜, 3ë°° í¬ê¸°) -->
                <img id="defense-castle" src="castlekorean.png" alt="ê³ ë ¤ ì„±" class="absolute bottom-4 left-4 w-96 h-96">
            </div>

            <!-- ì ìˆ˜íŒ -->
            <div class="absolute top-20 left-4 bg-black/80 text-white p-4 rounded-lg z-20 border border-white/50 backdrop-blur-sm">
                <div class="text-yellow-400 font-bold text-2xl mb-2">ì‚¼ë³„ì´ˆ ë°©ì–´ì „</div>
                <div class="text-sm text-gray-200">
                    <span class="text-red-400 font-bold">ì„± HP: <span id="defense-castle-hp">100</span></span><br>
                    <span class="text-blue-400 font-bold">ì²˜ì¹˜: <span id="defense-score">0</span></span>
                </div>
            </div>

            <!-- UI ìš”ì†Œë“¤ -->
            <div class="absolute top-4 right-4 flex flex-col gap-2">
                <button id="defense-achievement-btn" class="bg-yellow-500 hover:bg-yellow-400 text-black px-4 py-2 rounded-lg font-bold shadow-lg">
                    ğŸ† ì—…ì  ë³´ê¸°
                </button>
                <div class="bg-blue-600 text-white px-4 py-2 rounded-lg font-bold">
                    â˜¸ï¸ ê³ ë ¤
                </div>
            </div>


            <!-- ê²°ê³¼ ë©”ì‹œì§€ -->
            <div id="defense-result" class="hidden absolute inset-0 bg-black/90 flex flex-col items-center justify-center text-white text-center p-8">
                <h2 class="text-5xl font-bold mb-8 text-red-400 animate-pulse">âš”ï¸ ë°©ì–´ ì‹¤íŒ¨ ğŸ’”</h2>
                <p class="text-2xl mb-12 leading-loose">
                    ì‚¼ë³„ì´ˆëŠ” ì—´ì‹¬íˆ ì‹¸ì› ì§€ë§Œ<br>
                    ê²°êµ­ ëª½ê³¨ì„ ì´ê¸°ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.<br><br>
                    <span class="font-bold text-yellow-200">ê³ ë ¤ëŠ” ëª½ê³¨ì´ ì•½í•´ì§€ëŠ” ë•Œê¹Œì§€<br>
                    ê¸°íšŒë¥¼ ì—¿ë³´ë©° ì¸ë‚´í•˜ê¸°ë¡œ í•©ë‹ˆë‹¤.</span>
                </p>
                <button id="defense-proceed-btn" class="px-10 py-5 bg-blue-600 hover:bg-blue-500 text-white rounded-full text-2xl font-bold transition transform hover:scale-105 shadow-xl border-4 border-blue-400">
                    ë‹¤ìŒìœ¼ë¡œ ì§„í–‰í•˜ê¸° â–¶
                </button>
            </div>
        </div>
    </div>

    <div class="text-xs text-stone-400 opacity-70 mt-2 font-sans select-none">
        ì—­ì‚¬ì˜ ì„ íƒ: ê´‘ë³µì„ í–¥í•´ì„œ made by gamtudyssam 0.021

    <script>
        // ì¹­í˜¸ ë°ì´í„°
        const titles = {
            'first_step': { name: 'ì—­ì‚¬ì˜ ì²«ê±¸ìŒ', desc: 'ê²Œì„ ì‹œì‘í•˜ê¸°' },
            // 'sea_king' ì œê±° (ì¥ë³´ê³  ì‚­ì œë¨)
            'great_scientist': { name: 'ê³¼í•™ êµ°ì£¼', desc: 'ì¥ì˜ì‹¤ì„ ë“±ìš©í•˜ì—¬ ì¡°ì„ ì˜ ê³¼í•™ì„ ê½ƒí”¼ìš°ë‹¤' },
            'reformer': { name: 'ê°œí˜ê°€', desc: 'ì •ì¡°ì˜ ê¿ˆì„ ì´ë£¨ë‹¤' },
            'patriot': { name: 'ì• êµ­ì§€ì‚¬', desc: 'êµ­ì±„ë³´ìƒìš´ë™ì— ì°¸ì—¬í•˜ë‹¤' },
            'traitor': { name: 'ë§¤êµ­ë…¸', desc: 'ë‚˜ë¼ë¥¼ íŒ”ì•„ë¨¹ë‹¤ (ë°°ë“œì—”ë”©)' },
            'tyrant': { name: 'í­êµ°', desc: 'ë°±ì„±ì„ ì–µì••í•˜ë‹¤ (ë°°ë“œì—”ë”©)' },
            // 'pirate_king' ì œê±° (ì¥ë³´ê³  ì‚­ì œë¨)
            'history_guardian': { name: 'ì—­ì‚¬ì˜ ìˆ˜í˜¸ì', desc: 'ê´‘ë³µì„ ë§ì´í•˜ë‹¤ (íŠ¸ë£¨ì—”ë”©)' }
        };

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ íšë“í•œ ì¹­í˜¸ ë¶ˆëŸ¬ì˜¤ê¸°
        let unlockedTitles = JSON.parse(localStorage.getItem('koreanHistoryTitles')) || [];

        function unlockTitle(id) {
            if (!titles[id]) return;
            if (!unlockedTitles.includes(id)) {
                unlockedTitles.push(id);
                localStorage.setItem('koreanHistoryTitles', JSON.stringify(unlockedTitles));
                showToast(`ğŸ† ì¹­í˜¸ íšë“: ${titles[id].name}`);
            }
        }

        function checkTrueEnding() {
             // íŠ¸ë£¨ì—”ë”© ê¸°ë¡ ì²´í¬
             if (localStorage.getItem('korean_history_true_ending') === 'true') {
                 const btn = document.getElementById('minigame-menu-btn');
                 if (btn) btn.classList.remove('hidden');
                 
                 const hofBtn = document.getElementById('hof-menu-btn');
                 if (hofBtn) hofBtn.classList.remove('hidden');
             }
        }

        function showToast(msg) {
            const toast = document.getElementById('toast');
            toast.textContent = msg;
            toast.style.opacity = 1;
            setTimeout(() => {
                toast.style.opacity = 0;
            }, 3000);
        }

        function showTitles() {
            const list = document.getElementById('title-list');
            list.innerHTML = '';
            
            Object.keys(titles).forEach(key => {
                const item = titles[key];
                const isUnlocked = unlockedTitles.includes(key);
                const div = document.createElement('div');
                div.className = `title-item ${isUnlocked ? '' : 'locked'}`;
                div.innerHTML = `
                    <div>
                        <div class="font-bold">${isUnlocked ? item.name : '???'}</div>
                        <div class="text-xs text-stone-500">${isUnlocked ? item.desc : 'ì•„ì§ íšë“í•˜ì§€ ëª»í•¨'}</div>
                    </div>
                    <div class="text-2xl">${isUnlocked ? 'ğŸ…' : 'ğŸ”’'}</div>
                `;
                list.appendChild(div);
            });

            document.getElementById('title-modal').style.display = 'flex';
        }

        function closeTitles(e) {
            if (e.target === document.getElementById('title-modal')) {
                document.getElementById('title-modal').style.display = 'none';
            }
        }

        // --- ì•„ì¼€ì´ë“œ ëª¨ë“œ / ë¯¸ë‹ˆê²Œì„ ê´€ë ¨ ---
        let arcadeMode = false;
        let arcadeGameType = '';
        let arcadeStartTime = 0;

        const MINIGAME_LIST = [
            { id: 'bear_game', title: "ì›…ë…€ì˜ ì¸ë‚´", icon: "ğŸ»", desc: "30ì´ˆ ë™ì•ˆ ì¸ë‚´ ì ìˆ˜ ìµœê³  ê¸°ë¡ ë„ì „", scoreType: 'score' },
            // river_gameëŠ” ìŠ¤í† ë¦¬ ì„ íƒì§€ì—ì„œë§Œ í”Œë ˆì´
            { id: 'defense_game', title: "ì‚¼ë³„ì´ˆ ë°©ì–´ì „", icon: "ğŸ¹", desc: "ëª½ê³¨êµ°ì„ ë§‰ì•„ë‚´ì„¸ìš” (ë¬´í•œ ì›¨ì´ë¸Œ)", scoreType: 'score' },
            { id: 'faction_balance_game', title: "íƒ•í‰ì±… ê· í˜•", icon: "âš–ï¸", desc: "ê· í˜•ì´ 3ì´ˆ ì´ìƒ ê¹¨ì§€ë©´ ì¢…ë£Œ (ë²„í‹´ ì‹œê°„ ê¸°ë¡)", scoreType: 'time_high' },
            { id: 'heung_game', title: "ì²™í™”ë¹„ ë•…ë”°ë¨¹ê¸°", icon: "ğŸ”’", desc: "ì´ì–‘ì„ ì„ í”¼í•´ ë•…ì„ í™•ë³´í•˜ì„¸ìš” (íƒ€ì„ ì–´íƒ)", scoreType: 'time_low' },
            { id: 'ahn_rhythm_game', title: "ì•ˆì¤‘ê·¼ì˜ ê±°ì‚¬", icon: "ğŸ”«", desc: "ì •í™•í•œ íƒ€ì´ë°ì— ì €ê²©í•˜ì„¸ìš” (ê³ ë“ì  ë„ì „)", scoreType: 'score' }
        ];

        
        // â˜… êµ¬ê¸€ Apps Script ë°°í¬ URLì„ ì—¬ê¸°ì— ì…ë ¥í•˜ì„¸ìš” â˜…
        // ì˜ˆ: const GAS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwZZla4aJaorZIg0Llj6VwVnx8sL8E758RAm4Hpm5W5ax0scr0tAb1TPl9KSRUSiPIN/exec";
        const GAS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyaYoAcgAs_4aALXFiJBXPV6Q6dCfvsW-Uzel1-wPixOLWCqdASXtlmXfucJrbzVW_b/exec"; 

        // --- ëª…ì˜ˆì˜ ì „ë‹¹ (íƒœê·¹ê¸° ì›Œë“œí´ë¼ìš°ë“œ) ---
        function openHofModal(canRegister = false) {
            const modal = document.getElementById('hof-modal');
            const inputArea = document.getElementById('hof-input-area');

            modal.classList.remove('hidden');
            lockBodyScroll(true);

            // íŠ¸ë£¨ì—”ë”© í´ë¦¬ì–´ íšŸìˆ˜ì™€ ë“±ë¡ íšŸìˆ˜ë¡œ ë‚¨ì€ ë“±ë¡ ê¸°íšŒ ê³„ì‚°
            const trueEndingCount = parseInt(localStorage.getItem('korean_history_true_ending_count') || '0');
            const registeredCount = parseInt(localStorage.getItem('korean_history_hof_registered_count') || '0');

            // í´ë¦¬ì–´ íšŸìˆ˜ë§Œí¼ ë“±ë¡ ê¸°íšŒê°€ ìˆê³ , ì•„ì§ ë“±ë¡í•˜ì§€ ì•Šì€ í´ë¦¬ì–´ë§Œ ê¸°íšŒë¡œ ì¸ì •
            const remainingRegistrations = trueEndingCount - registeredCount;

            if (canRegister && remainingRegistrations > 0) {
                inputArea.classList.remove('hidden');
                document.getElementById('hof-registration-info').textContent = `ë“±ë¡ ê°€ëŠ¥í•œ í´ë¦¬ì–´ ìˆ˜: ${remainingRegistrations}íšŒ`;
            } else {
                inputArea.classList.add('hidden');
                if (canRegister && remainingRegistrations <= 0) {
                    document.getElementById('hof-registration-info').textContent = 'ëª¨ë“  í´ë¦¬ì–´ì— ëŒ€í•œ ë“±ë¡ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤.';
                }
            }

            // ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸° ë° ê·¸ë¦¬ê¸°
            fetchAndDrawHof();
        }

        function closeHofModal() {
            document.getElementById('hof-modal').classList.add('hidden');
            lockBodyScroll(false);
        }

        let isSubmittingHof = false;

        function submitHofName() {
            if (!GAS_SCRIPT_URL) {
                alert("ê°œë°œì ì„¤ì •: Google Apps Script URLì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
                return;
            }

            // ë‚¨ì€ ë“±ë¡ ê¸°íšŒ í™•ì¸ (í•œë²ˆ í´ë¦¬ì–´ë‹¹ í•œë²ˆ ë“±ë¡)
            const trueEndingCount = parseInt(localStorage.getItem('korean_history_true_ending_count') || '0');
            const registeredCount = parseInt(localStorage.getItem('korean_history_hof_registered_count') || '0');
            const remainingRegistrations = trueEndingCount - registeredCount;

            console.log(`ë“±ë¡ í™•ì¸ - í´ë¦¬ì–´ íšŸìˆ˜: ${trueEndingCount}, ë“±ë¡ íšŸìˆ˜: ${registeredCount}, ë‚¨ì€ ê¸°íšŒ: ${remainingRegistrations}`);

            if (remainingRegistrations <= 0) {
                alert("ë“±ë¡ ê¸°íšŒë¥¼ ëª¨ë‘ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. ìƒˆë¡œìš´ íŠ¸ë£¨ì—”ë”©ì„ í´ë¦¬ì–´í•´ì•¼ ë“±ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
                return;
            }

            const input = document.getElementById('hof-nickname');
            const name = input.value.trim();

            if (!name) {
                alert("ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return;
            }
            if (name.length > 10) {
                alert("ë‹‰ë„¤ì„ì€ 10ê¸€ì ì´ë‚´ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return;
            }

            if (isSubmittingHof) return;
            isSubmittingHof = true;

            // ë“±ë¡ ìš”ì²­
            showToast("ì´ë¦„ì„ ë“±ë¡ ì¤‘ì…ë‹ˆë‹¤...");

            const url = `${GAS_SCRIPT_URL}?action=add&name=${encodeURIComponent(name)}`;

            fetch(url)
            .then(res => res.json())
            .then(data => {
                if (data.result === 'success') {
                    showToast("ëª…ì˜ˆì˜ ì „ë‹¹ì— ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!");
                    // ë“±ë¡ íšŸìˆ˜ ì¦ê°€
                    const newRegisteredCount = registeredCount + 1;
                    localStorage.setItem('korean_history_hof_registered_count', newRegisteredCount.toString());
                    input.value = ''; // ì…ë ¥ì°½ ì´ˆê¸°í™”
                    openHofModal(true); // ëª¨ë‹¬ ë‹¤ì‹œ ì—´ì–´ì„œ ë‚¨ì€ ê¸°íšŒ ì—…ë°ì´íŠ¸
                    fetchAndDrawHof(); // ë‹¤ì‹œ ê·¸ë¦¬ê¸°
                } else {
                    alert("ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
                }
            })
            .catch(err => {
                console.error(err);
                alert("ì„œë²„ ì—°ê²° ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            })
            .finally(() => {
                isSubmittingHof = false;
            });
        }

        let hofNames = [];

        function fetchAndDrawHof() {
            const loading = document.getElementById('hof-loading');
            loading.classList.remove('hidden');

            hofNames = []; // ì´ˆê¸°í™” (ê¸°ë³¸ ë…ë¦½ìš´ë™ê°€ ì´ë¦„ ì œê±°)

            if (!GAS_SCRIPT_URL) {
                // URLì´ ì—†ìœ¼ë©´ í…ŒìŠ¤íŠ¸ìš© ë”ë¯¸ ë°ì´í„° ì‚¬ìš©
                console.log('GAS URL ì—†ìŒ - í…ŒìŠ¤íŠ¸ ë°ì´í„° ì‚¬ìš©');
                hofNames = [
                    { name: 'í…ŒìŠ¤í„°1', date: new Date(Date.now() - 30 * 60 * 1000).toISOString() }, // 30ë¶„ ì „
                    { name: 'ã…ã…ã…', date: new Date(Date.now() - 2 * 60 * 60 * 1000).toISOString() }, // 2ì‹œê°„ ì „
                    { name: 'rrr', date: new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString() }, // 1ì¼ ì „
                    { name: 'digh', date: new Date().toISOString() } // ë°©ê¸ˆ ì „
                ];
                document.getElementById('hof-count').textContent = hofNames.length;
                drawTaegeukgiCloud();
                loading.classList.add('hidden');
                return;
            }

            fetch(`${GAS_SCRIPT_URL}`) // ê¸°ë³¸ GETì€ ì „ì²´ ëª©ë¡ ì¡°íšŒ
            .then(res => {
                if (!res.ok) {
                    throw new Error(`HTTP error! status: ${res.status}`);
                }
                return res.json();
            })
            .then(data => {
                console.log('GAS ë°ì´í„°:', data); // ë””ë²„ê¹…ìš©
                console.log('ë°ì´í„° íƒ€ì…:', typeof data, Array.isArray(data));

                // dataëŠ” ê°ì²´ ë°°ì—´ì´ì–´ì•¼ í•¨ [{date: "...", name: "..."}, ...]
                if (Array.isArray(data) && data.length > 0) {
                    // ì²« ë²ˆì§¸ ìš”ì†Œê°€ ê°ì²´ì¸ì§€ í™•ì¸
                    if (typeof data[0] === 'object' && data[0].date && data[0].name) {
                        console.log('ê°ì²´ ë°°ì—´ í˜•ì‹ìœ¼ë¡œ ë°ì´í„° ìˆ˜ì‹ ë¨');
                        hofNames = data;
                    } else if (typeof data[0] === 'string') {
                        console.log('ë¬¸ìì—´ ë°°ì—´ í˜•ì‹ìœ¼ë¡œ ë°ì´í„° ìˆ˜ì‹ ë¨ - ë ˆê±°ì‹œ ë°ì´í„°');
                        // ë ˆê±°ì‹œ ë°ì´í„°ì¸ ê²½ìš° ê°ì²´ë¡œ ë³€í™˜ (ë‚ ì§œ ì •ë³´ ì—†ìŒ)
                        hofNames = data.map(name => ({ name: name, date: null }));
                    } else {
                        console.error('ì•Œ ìˆ˜ ì—†ëŠ” ë°ì´í„° í˜•ì‹:', data[0]);
                        hofNames = [];
                    }
                } else {
                    console.log('ë°ì´í„°ê°€ ë¹„ì–´ìˆìŒ');
                    hofNames = [];
                }

                document.getElementById('hof-count').textContent = hofNames.length;
                drawTaegeukgiCloud();
                loading.classList.add('hidden');
            })
            .catch(err => {
                console.error('GAS ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', err);
                loading.classList.add('hidden');
                // ì—ëŸ¬ ë‚˜ë„ ì‹¤ë£¨ì—£ì€ ê·¸ë¦¼
                drawTaegeukgiCloud();
            });
        }

        function drawTaegeukgiCloud() {
            const container = document.getElementById('hof-canvas-container');
            const canvas = document.getElementById('hof-canvas');
            const ctx = canvas.getContext('2d');
            
            // ìº”ë²„ìŠ¤ í¬ê¸° ë§ì¶¤
            const rect = container.getBoundingClientRect();
            const w = rect.width;
            const h = rect.height; 
            
            // íƒœê·¹ê¸° í‘œì¤€ ë¹„ìœ¨ 3:2
            let flagW = w;
            let flagH = w * 2 / 3;
            if (flagH > h) {
                flagH = h;
                flagW = h * 3 / 2;
            }

            canvas.width = flagW;
            canvas.height = flagH;
            
            // 1. ìƒ‰ìƒ ë§¤í•‘ì„ ìœ„í•œ ê°€ìƒ ìº”ë²„ìŠ¤ ìƒì„±
            const mapCanvas = document.createElement('canvas');
            mapCanvas.width = flagW;
            mapCanvas.height = flagH;
            const mapCtx = mapCanvas.getContext('2d');
            
            drawFlagMap(mapCtx, flagW, flagH);
            
            // í”½ì…€ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            const mapData = mapCtx.getImageData(0, 0, flagW, flagH).data;

            // 2. ì‹¤ì œ ìº”ë²„ìŠ¤ ì´ˆê¸°í™”
            ctx.clearRect(0, 0, flagW, flagH);
            
            // ë°°ê²½
            ctx.fillStyle = '#FDFDFD';
            ctx.fillRect(0, 0, flagW, flagH);

            // 3. íƒœê·¹ê¸° ì‹¤ë£¨ì—£ (ì—°í•˜ê²Œ ë°‘ê·¸ë¦¼) ê·¸ë¦¬ê¸°
            ctx.globalAlpha = 0.15; // ì•„ì£¼ ì—°í•˜ê²Œ
            ctx.drawImage(mapCanvas, 0, 0);
            ctx.globalAlpha = 1.0; // ë³µêµ¬

            if (hofNames.length === 0) return;

            // 4. ì´ë¦„ ë°°ì¹˜
            // ì´ë¦„ì´ ì ì„ ë• í¬ê²Œ, ë§ì„ ë• ì‘ê²Œ
            const baseFontSize = Math.max(10, Math.min(32, Math.sqrt((flagW * flagH) / (hofNames.length * 20))));
            
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            
            // ì…”í”Œ
            const shuffled = [...hofNames].sort(() => Math.random() - 0.5);
            
            let placedCount = 0;
            const maxTries = 100; // ì‹œë„ íšŸìˆ˜ ì¦ê°€

            shuffled.forEach(entry => {
                // ë°ì´í„° í˜•ì‹ ëŒ€ì‘ (ë¬¸ìì—´ ë˜ëŠ” ê°ì²´)
                let name = typeof entry === 'object' ? entry.name : entry;
                let isRecent = false;

                if (typeof entry === 'object' && entry.date) {
                    try {
                        // UTC ì‹œê°„ì„ í•œêµ­ ì‹œê°„ìœ¼ë¡œ ë³€í™˜
                        const utcDate = new Date(entry.date);
                        const koreaDate = new Date(utcDate.getTime() + (9 * 60 * 60 * 1000)); // UTC+9
                        const now = new Date();
                        const koreaNow = new Date(now.getTime() + (9 * 60 * 60 * 1000)); // í˜„ì¬ ì‹œê°„ë„ í•œêµ­ ì‹œê°„ìœ¼ë¡œ

                        const diffMs = koreaNow - koreaDate;
                        const diffHours = diffMs / (1000 * 60 * 60);

                        console.log(`ì´ë¦„: ${name}`);
                        console.log(`  ë“±ë¡ì‹œê°„ (UTC): ${utcDate.toISOString()}`);
                        console.log(`  ë“±ë¡ì‹œê°„ (í•œêµ­): ${koreaDate.toLocaleString('ko-KR')}`);
                        console.log(`  í˜„ì¬ì‹œê°„ (í•œêµ­): ${koreaNow.toLocaleString('ko-KR')}`);
                        console.log(`  ê²½ê³¼ì‹œê°„: ${diffHours.toFixed(2)}ì‹œê°„`);

                        // 1ì‹œê°„ ì´ë‚´ (1ì‹œê°„ = 60ë¶„)
                        if (diffHours < 1 && diffHours >= 0) {
                            isRecent = true;
                            console.log(`âœ… ${name}ëŠ” ìµœê·¼ ë“±ë¡ìì…ë‹ˆë‹¤! (ë³„ í‘œì‹œ ì ìš©)`);
                        } else {
                            console.log(`âŒ ${name}ëŠ” 1ì‹œê°„ì´ ì§€ë‚¬ìŠµë‹ˆë‹¤. (ì¼ë°˜ í‘œì‹œ)`);
                        }
                    } catch (dateError) {
                        console.error('ë‚ ì§œ íŒŒì‹± ì˜¤ë¥˜:', dateError, entry.date);
                    }
                } else if (typeof entry === 'string') {
                    // ë ˆê±°ì‹œ ë°ì´í„° (ì´ë¦„ë§Œ ìˆëŠ” ê²½ìš°)
                    console.log(`ë ˆê±°ì‹œ ë°ì´í„°: ${name} (ë‚ ì§œ ì •ë³´ ì—†ìŒ)`);
                }

                let fontSize = baseFontSize * (0.8 + Math.random() * 0.6);
                ctx.font = `bold ${fontSize}px "Nanum Myeongjo", serif`; 
                
                let placed = false;
                for (let i = 0; i < maxTries; i++) {
                    const x = Math.floor(Math.random() * flagW);
                    const y = Math.floor(Math.random() * flagH);
                    
                    // ë§µì—ì„œ ìƒ‰ìƒ ìƒ˜í”Œë§
                    const index = (y * flagW + x) * 4;
                    const r = mapData[index];
                    const g = mapData[index + 1];
                    const b = mapData[index + 2];
                    const a = mapData[index + 3];

                    // í°ìƒ‰ ë°°ê²½ì´ ì•„ë‹Œ ìœ ìƒ‰ ì˜ì—­(íƒœê·¹/ê±´ê³¤ê°ë¦¬) ì°¾ê¸°
                    if (a > 100 && r + g + b < 760) { 
                        // ìƒ‰ìƒ ê²°ì •
                        let fillStyle = '#000';
                        if (r > 200 && b < 100) fillStyle = '#CD2E3A'; // Red
                        else if (b > 150 && r < 100) fillStyle = '#0047A0'; // Blue
                        else if (r < 50 && g < 50 && b < 50) fillStyle = '#111111'; // Black
                        
                        ctx.fillStyle = fillStyle;
                        ctx.save();
                        ctx.translate(x, y);
                        // ì•½ê°„ì˜ íšŒì „
                        ctx.rotate((Math.random() - 0.5) * 0.5);
                        
                        // ìµœê·¼ ë“±ë¡ì íš¨ê³¼: ê·¸ë¦¼ì(ê´‘ì±„) + ë³„
                        if (isRecent) {
                            ctx.shadowColor = "#FFD700"; // Gold color
                            ctx.shadowBlur = 10;
                            // ì´ë¦„ ë’¤ì— ë³„ ì¶”ê°€
                            ctx.fillText(name + "âœ¨", 0, 0);
                        } else {
                            ctx.fillText(name, 0, 0);
                        }
                        
                        ctx.restore();
                        placed = true;
                        placedCount++;
                        break;
                    }
                }
            });
        }

        function drawFlagMap(ctx, w, h) {
            // í° ë°°ê²½
            ctx.fillStyle = '#FFFFFF';
            ctx.fillRect(0, 0, w, h);
            
            const cx = w / 2;
            const cy = h / 2;
            const r = h / 2.5; // íƒœê·¹ ë°˜ì§€ë¦„

            // íƒœê·¹ (ë¹¨ê°•/íŒŒë‘)
            // 1. í•˜ë‹¨ ë°˜ì› (íŒŒë‘)
            ctx.fillStyle = '#0047A0'; 
            ctx.beginPath();
            ctx.arc(cx, cy, r, 0, Math.PI, false);
            ctx.fill();

            // 2. ìƒë‹¨ ë°˜ì› (ë¹¨ê°•)
            ctx.fillStyle = '#CD2E3A'; 
            ctx.beginPath();
            ctx.arc(cx, cy, r, Math.PI, 0, false);
            ctx.fill();

            // 3. ë¬¼ê²° (ê°„ë‹¨í™”ëœ íƒœê·¹ ë¬¸ì–‘: ì¢Œì¸¡í•˜ë‹¨ ë¹¨ê°• ì›, ìš°ì¸¡ìƒë‹¨ íŒŒë‘ ì›) -> ì´ êµ¬ì¡°ê°€ ë¬¼ê²°ì„ ë§Œë“¦
            // ë¹¨ê°•ì´ ì¢Œì¸¡ìœ¼ë¡œ íŒŒê³ ë“¦ (ì¤‘ì•™ ì™¼ìª½ ì›)
            ctx.fillStyle = '#CD2E3A';
            ctx.beginPath();
            ctx.arc(cx - r/2, cy, r/2, 0, Math.PI * 2);
            ctx.fill();

            // íŒŒë‘ì´ ìš°ì¸¡ìœ¼ë¡œ íŒŒê³ ë“¦ (ì¤‘ì•™ ì˜¤ë¥¸ìª½ ì›)
            ctx.fillStyle = '#0047A0';
            ctx.beginPath();
            ctx.arc(cx + r/2, cy, r/2, 0, Math.PI * 2);
            ctx.fill();

            // 4. ê±´ê³¤ê°ë¦¬ (ê²€ì •) - í…ìŠ¤íŠ¸ ë°°ì¹˜ë¥¼ ìœ„í•œ ë©ì–´ë¦¬ ì˜ì—­ìœ¼ë¡œ ê·¸ë¦¬ê¸°
            ctx.fillStyle = '#000000';
            const barW = r * 1.0; // ë„ˆë¹„
            const barH = r * 0.6; // ë†’ì´
            const dist = r * 1.6; // ì¤‘ì‹¬ ê±°ë¦¬

            // ê±´ (ì¢Œìƒë‹¨)
            drawRotatedRect(ctx, cx - dist, cy - dist/1.5, barW, barH, Math.PI/5.5);
            // ê³¤ (ìš°í•˜ë‹¨)
            drawRotatedRect(ctx, cx + dist, cy + dist/1.5, barW, barH, Math.PI/5.5);
            // ê° (ìš°ìƒë‹¨)
            drawRotatedRect(ctx, cx + dist, cy - dist/1.5, barW, barH, -Math.PI/5.5);
            // ë¦¬ (ì¢Œí•˜ë‹¨)
            drawRotatedRect(ctx, cx - dist, cy + dist/1.5, barW, barH, -Math.PI/5.5);
        }

        function drawRotatedRect(ctx, x, y, w, h, angle) {
            ctx.save();
            ctx.translate(x, y);
            ctx.rotate(angle);
            ctx.fillRect(-w/2, -h/2, w, h);
            ctx.restore();
        }

        function getMinigameScore(id) {
            return parseInt(localStorage.getItem(`mg_score_${id}`)) || 0;
        }

        function saveMinigameScore(id, score, type) {
            const current = getMinigameScore(id);
            let isBest = false;
            if (type === 'time_low') { // ì‹œê°„ì´ ë‚®ì„ìˆ˜ë¡ ì¢‹ìŒ (0ì´ë©´ ê¸°ë¡ ì—†ìŒ)
                if (current === 0 || (score > 0 && score < current)) {
                    localStorage.setItem(`mg_score_${id}`, score);
                    isBest = true;
                }
            } else { // ì ìˆ˜/ì‹œê°„ì´ ë†’ì„ìˆ˜ë¡ ì¢‹ìŒ
                if (score > current) {
                    localStorage.setItem(`mg_score_${id}`, score);
                    isBest = true;
                }
            }
            return isBest;
        }

        function formatScore(score, type) {
            if (type === 'time_low' || type === 'time_high') {
                return `${(score / 1000).toFixed(2)}ì´ˆ`;
            }
            return `${score}ì `;
        }

        function showMinigameMenu() {
            const listEl = document.getElementById('minigame-list');
            listEl.innerHTML = '';

            MINIGAME_LIST.forEach(game => {
                const score = getMinigameScore(game.id);
                const scoreText = score > 0 ? formatScore(score, game.scoreType) : "ê¸°ë¡ ì—†ìŒ";
                
                const btn = document.createElement('div');
                btn.className = "bg-stone-700 p-4 rounded-xl border border-stone-600 hover:bg-stone-600 transition-colors cursor-pointer flex flex-col items-center gap-2 group";
                btn.onclick = () => startArcadeGame(game.id);
                btn.innerHTML = `
                    <div class="text-4xl mb-2 group-hover:scale-110 transition-transform">${game.icon}</div>
                    <h3 class="font-bold text-lg text-amber-400">${game.title}</h3>
                    <p class="text-xs text-stone-400 text-center mb-2">${game.desc}</p>
                    <div class="mt-auto bg-black/30 px-3 py-1 rounded text-sm text-green-400 font-mono">
                        ğŸ† Best: ${scoreText}
                    </div>
                `;
                listEl.appendChild(btn);
            });

            document.getElementById('minigame-modal').classList.remove('hidden');
            lockBodyScroll(true);
        }

        function closeMinigameMenu() {
            document.getElementById('minigame-modal').classList.add('hidden');
            lockBodyScroll(false);
        }

        function startArcadeGame(gameId) {
            console.log('startArcadeGame í˜¸ì¶œë¨, ê²Œì„ ID:', gameId);
            closeMinigameMenu();
            arcadeMode = true;
            arcadeGameType = gameId;
            arcadeStartTime = Date.now();
            startMinigame(gameId, null); // nextScene null -> ì•„ì¼€ì´ë“œ ëª¨ë“œ ì¸ì‹
        }

        function showArcadeResult(score, isWin) {
            const game = MINIGAME_LIST.find(g => g.id === arcadeGameType);
            const isBest = saveMinigameScore(arcadeGameType, score, game.scoreType);
            
            const overlay = document.getElementById('arcade-result-overlay');
            const titleEl = document.getElementById('arcade-result-title');
            const iconEl = document.getElementById('arcade-result-icon');
            
            if (isWin) {
                 titleEl.textContent = "GAME End!";
                 titleEl.className = "text-3xl font-bold text-green-400 mb-2";
                 iconEl.textContent = "ğŸ†";
            } else {
                 titleEl.textContent = "GAME OVER";
                 titleEl.className = "text-3xl font-bold text-red-500 mb-2";
                 iconEl.textContent = "ğŸ’€";
            }
            
            document.getElementById('arcade-result-score').textContent = `Score: ${formatScore(score, game.scoreType)}`;
            
            const bestScore = getMinigameScore(arcadeGameType);
            document.getElementById('arcade-result-best').textContent = `Best: ${formatScore(bestScore, game.scoreType)} ${isBest ? "(New Record!)" : ""}`;

            // ë‹¤ì‹œ í•˜ê¸° ë²„íŠ¼ ì œê±°ë¨

            overlay.classList.remove('hidden');
        }

        function closeArcadeResult() {
            document.getElementById('arcade-result-overlay').classList.add('hidden');
            if (!arcadeMode) return; 
            
            arcadeMode = false;
            arcadeGameType = '';
            
            const overlays = [
                'minigame-overlay', 'river-game-overlay', 'defense-game-window', 
                'faction-game-overlay', 'heung-game-overlay', 'ahn-game-overlay'
            ];
            overlays.forEach(id => {
                const el = document.getElementById(id);
                if(el) {
                    el.classList.add('hidden');
                    el.style.display = 'none';
                }
            });
            showMinigameMenu();
        }

        // ê²Œì„ ë°ì´í„° ì •ì˜
        // ê²Œì„ ë°ì´í„° ì •ì˜
        const gameData = {
            // ==========================================
            // 1. ê³ ì¡°ì„  ë° ì´ˆê¸° êµ­ê°€
            // ==========================================
            start: {
                type: 'history', badge: 'badge-ancient', era: "ê³ ì¡°ì„ ", year: "BC 2333",
                title: "ê°œêµ­: í•˜ëŠ˜ì˜ ëœ»ì„ ì‡ë‹¤",
                desc: "í•˜ëŠ˜ì„ ë‹¤ìŠ¤ë¦¬ëŠ” í™˜ì›…ì´ ì‹ ì‹œë¥¼ ì—´ê³  ì¸ê°„ ì„¸ìƒì„ ë³´ì‚´í”¼ê³  ìˆìŠµë‹ˆë‹¤. ì–´ëŠ ë‚ , ê³°ê³¼ í˜¸ë‘ì´ê°€ ì°¾ì•„ì™€ ê°„ì ˆíˆ ì‚¬ëŒì´ ë˜ê¸°ë¥¼ ì²­í•©ë‹ˆë‹¤. ì¸ê°„ì´ ë˜ëŠ” ê¸¸ì€ í—˜ë‚œí•˜ì§€ë§Œ, ì´ë“¤ì„ ì˜ ì´ëˆë‹¤ë©´ í™ìµì¸ê°„ì˜ ëœ»ì„ ë„ë¦¬ í¼ì¹  ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤.",
                progress: 2, icon: "ğŸ»",
                unlock: 'first_step',
                choices: [
                    { text: "ì‘¥ê³¼ ë§ˆëŠ˜ì„ ì£¼ë©° 100ì¼ê°„ ë™êµ´ì—ì„œ ì¸ë‚´í•˜ë¼ê³  í•œë‹¤.", next: "gojoseon_law", minigame: 'bear_game' },
                    { text: "ê°•ë ¥í•œ ë§¹ìˆ˜ì˜ í˜ì´ í•„ìš”í•˜ë‹ˆ êµ°ì‚¬ë¡œ í‚¤ìš´ë‹¤.", next: "crisis_beast" },
                    { text: "ê°€ì—½ê²Œ ì—¬ê²¨ ë§ˆë²•ì„ ì¨ì„œ ë°”ë¡œ ì‚¬ëŒìœ¼ë¡œ ë§Œë“¤ì–´ ì¤€ë‹¤.", next: "crisis_easy_magic" }
                ]
            },
            crisis_beast: { 
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ì•¼ìˆ˜ì˜ ì™•êµ­", 
                desc: "ì§ìŠ¹ì˜ ë³¸ì„±ì„ ë²„ë¦¬ì§€ ëª»í•œ ê·¸ë“¤ì€ ì¸ê°„ì„ ë•ê¸°ëŠ” ì»¤ë…• ì¡ì•„ë¨¹ê¸° ì‹œì‘í–ˆìŠµë‹ˆë‹¤. ì‹ ì‹œê°€ í”¼ë¡œ ë¬¼ë“¤ê³  ì‚¬ëŒë“¤ì€ ê³µí¬ì— ë–¨ê³  ìˆìŠµë‹ˆë‹¤. í™˜ì›…ì˜ ê¶Œìœ„ê°€ ë•…ì— ë–¨ì–´ì¡ŒìŠµë‹ˆë‹¤.", 
                choices: [
                    { 
                        text: "ì‹ ì„±í•œ í˜(ì²œë¶€ì¸)ìœ¼ë¡œ ì§ìŠ¹ì„ ì œì••í•˜ê³  ëŠ¦ê²Œë‚˜ë§ˆ ë²•ê³¼ ì§ˆì„œë¥¼ ì„¸ìš´ë‹¤.", 
                        next: "gojoseon_law",
                        resultTitle: "ì„ íƒ ê²°ê³¼: ì²œë¶€ì¸ìœ¼ë¡œ ì§ˆì„œ íšŒë³µ",
                        resultDesc: "ì²œë¶€ì¸ì˜ í˜ìœ¼ë¡œ í­ì£¼í•œ ì§ìŠ¹ë“¤ì„ ì œì••í•˜ê³  ë²•ê³¼ ê¸ˆê¸°ë¥¼ ì„¸ì› ìŠµë‹ˆë‹¤. ì‹ ì‹œëŠ” ë‹¤ì‹œ ì•ˆì •ë˜ì—ˆê³ , ì‚¬ëŒë“¤ì€ í™˜ì›…ì˜ ê¶Œìœ„ë¥¼ ì¸ì •í–ˆìœ¼ë©°, ì´í›„ì— ë‹¨êµ°ì™•ê²€ì´ ê±´êµ­í•œ ê³ ì¡°ì„  ê±´êµ­ì˜ ì§ˆì„œë¥¼ ë°›ì•„ë“¤ì˜€ìŠµë‹ˆë‹¤."
                    }, // íšŒë³µ
                    { text: "ëª¨ë“  ê²ƒì„ í¬ê¸°í•˜ê³  ë‹¤ì‹œ í•˜ëŠ˜ë¡œ ëŒì•„ê°„ë‹¤.", next: "end_myth_fail" },
                    { text: "ë” ê°•ë ¥í•œ ì‚¬ì êµ°ë‹¨ì„ ë°ë ¤ì™€ ì„œë¡œ ì‹¸ìš°ê²Œ í•œë‹¤.", next: "end_savage" }
                ] 
            },
            crisis_easy_magic: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ëœ ëœ ì¸ê°„",
                desc: "ì¸ë‚´ì™€ ê³ ë‚œì˜ ê³¼ì • ì—†ì´ ê²‰ëª¨ìŠµë§Œ ì‚¬ëŒì´ ëœ ê·¸ë“¤ì€ ì¸ê°„ì˜ ë„ë¦¬ë¥¼ ëª¨ë¦…ë‹ˆë‹¤. ìš•ì‹¬ì„ ë¶€ë¦¬ê³  ë‚œí­í•˜ê²Œ ë‚ ë›°ë©° ì„¸ìƒì„ ì–´ì§€ëŸ½íˆê³  ìˆìŠµë‹ˆë‹¤.",
                choices: [
                    { 
                        text: "ì—„ê²©í•œ ê¸ˆê¸°ë¥¼ ë§Œë“¤ì–´ ê·¸ë“¤ì—ê²Œ ì¸ë‚´ì‹¬ê³¼ ë„ë•ì„ ë‹¤ì‹œ ê°€ë¥´ì¹œë‹¤.", 
                        next: "gojoseon_law",
                        resultTitle: "ì„ íƒ ê²°ê³¼: ê¸ˆê¸°ë¡œ ë‹¤ì‹œ íƒœì–´ë‚œ ë°±ì„±",
                        resultDesc: "ê¸ˆê¸°ì™€ ìˆ˜í–‰ì„ ê±°ì¹œ ëì— ê·¸ë“¤ì€ ë¹„ë¡œì†Œ ì‚¬ëŒë‹¤ìš´ ë„ë¦¬ë¥¼ ê¹¨ë‹«ê³ , ê³ ì¡°ì„  ê±´êµ­ì„ í•¨ê»˜í•  ë™ë°˜ìê°€ ë˜ì—ˆìŠµë‹ˆë‹¤. ì¸ë‚´ì™€ ê·œìœ¨ì´ í©ì–´ì§„ ë¬´ë¦¬ë¥¼ í•˜ë‚˜ì˜ ê³µë™ì²´ë¡œ ë¬¶ì—ˆê³ , ë‹¨êµ° ì™•ê²€ì´ ë‚˜íƒ€ë‚˜ ê³ ì¡°ì„ ì„ ê±´êµ­í•˜ì˜€ìŠµë‹ˆë‹¤."
                    }, // íšŒë³µ
                    { text: "ì‹¤íŒ¨ì‘ì´ë¼ ì—¬ê¸°ê³  ëª¨ë‘ ì£½ì—¬ ì—†ì•¤ë‹¤.", next: "end_savage" },
                    { text: "ê·¸ë“¤ì„ í’€ì–´ì£¼ì–´ ì„¸ìƒì— í˜¼ë€ì„ ì•¼ê¸°í•œë‹¤.", next: "end_myth_fail" }
                ]
            },
            
            gojoseon_law: {
                type: 'history', badge: 'badge-ancient', era: "ê³ ì¡°ì„ ", year: "ê¸°ì›ì „",
                title: "ê¸ˆë²•ì˜ ì œì •",
                desc: "ë†ê²½ì´ ë°œë‹¬í•˜ê³  ì²­ë™ê¸° ë¬¸í™”ë¥¼ ë°”íƒ•ìœ¼ë¡œ ê³ ì¡°ì„  ì‚¬íšŒëŠ” ì ì  ì»¤ì§€ê³  ë³µì¡í•´ì¡ŒìŠµë‹ˆë‹¤. ì‚¬ëŒë“¤ì˜ ì¬ì‚°ì„ ë³´í˜¸í•˜ê³  ì‚¬íšŒ ì§ˆì„œë¥¼ ë°”ë¡œì¡ê¸° ìœ„í•´ì„œëŠ” ê°•ë ¥í•œ ì‚¬íšŒì  í•©ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤.",
                progress: 5, icon: "âš–ï¸",
                choices: [
                    { 
                        text: "ìƒëª…ê³¼ ì‚¬ìœ  ì¬ì‚°ì„ ì¤‘ì‹œí•˜ëŠ” 8ê°œì˜ ë²•(8ì¡°ë²•)ì„ ë§Œë“ ë‹¤.", 
                        next: "jumong_chase",
                        resultTitle: "ì„ íƒ ê²°ê³¼: 8ì¡°ë²• ì œì •",
                        resultDesc: "ì‚´ì¸Â·ìƒí•´Â·ì ˆë„ë¥¼ ë¬´ê²ê²Œ ë‹¤ìŠ¤ë¦¬ê³ , ì‚¬ìœ  ì¬ì‚°ê³¼ ìƒëª…ì„ ë³´í˜¸í•˜ëŠ” 8ì¡°ë²•ì´ ì„ í¬ë˜ì—ˆìŠµë‹ˆë‹¤. ê³ ì¡°ì„ ì€ ì§ˆì„œì™€ ì¬ì‚°ê¶Œì„ ê°–ì¶˜ êµ­ê°€ë¡œ ìë¦¬ì¡ì•„ í›„ëŒ€ ë²• ì „í†µì˜ ê¸°í‹€ì„ ë‹¦ì•˜ìŠµë‹ˆë‹¤."
                    },
                    { text: "ëª¨ë“  ê²ƒì€ ê³µë™ ì†Œìœ ë¡œ í•˜ê³  ê°œì¸ì˜ ì¬ì‚°ì„ ê¸ˆì§€í•œë‹¤.", next: "crisis_commune" },
                    { text: "í˜ì„¼ ìê°€ ëª¨ë“  ê²ƒì„ ê°€ì§€ëŠ” ì•½ìœ¡ê°•ì‹ì˜ ë²•ì„ ë§Œë“ ë‹¤.", next: "end_savage" }
                ]
            },
            crisis_commune: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ë©ˆì¶°ë²„ë¦° ë°œì „",
                desc: "ë‚´ê°€ ì—´ì‹¬íˆ ì¼í•´ì„œ ì–»ì€ ê³¡ì‹ë„ ë‚´ ê²ƒì´ ì•„ë‹ˆë‹ˆ, ì•„ë¬´ë„ ë†ì‚¬ë¥¼ ì—´ì‹¬íˆ ì§“ì§€ ì•ŠìŠµë‹ˆë‹¤. ì‹ëŸ‰ì´ ë¶€ì¡±í•´ì§€ê³  ë¬¸ëª…ì˜ ë°œì „ì´ ë©ˆì·„ìŠµë‹ˆë‹¤. ì‚¬ëŒë“¤ì€ ë°°ê³ í””ì— ì‹œë‹¬ë¦½ë‹ˆë‹¤.",
                choices: [
                    { 
                        text: "ì§€ê¸ˆì´ë¼ë„ ì‚¬ìœ  ì¬ì‚°ì„ ì¸ì •í•˜ê³  ì—´ì‹¬íˆ ì¼í•œ ìì—ê²Œ ë³´ìƒì„ ì¤€ë‹¤.", 
                        next: "jumong_chase",
                        resultTitle: "ì„ íƒ ê²°ê³¼: ê·¼ë©´ ë³´ìƒ, ìƒì‚° íšŒë³µ",
                        resultDesc: "ì‚¬ìœ  ì¬ì‚°ì„ ì¸ì •í•˜ê³  ë…¸ë ¥í•œ ë§Œí¼ ë³´ìƒí•˜ì ë°±ì„±ë“¤ì€ ë‹¤ì‹œ ë°­ì„ ê°ˆê³  ë¬¼ê±´ì„ ë§Œë“¤ê¸° ì‹œì‘í–ˆìŠµë‹ˆë‹¤. ìƒì‚°ì´ ì‚´ì•„ë‚˜ê³  ì‚¬íšŒëŠ” ì„±ì¥ ê¶¤ë„ë¡œ ë“¤ì–´ê°”ìŠµë‹ˆë‹¤."
                    }, // íšŒë³µ
                    { text: "ê²Œìœ¼ë¥¸ ìë“¤ì„ ë³¸ë³´ê¸°ë¡œ ëª¨ë‘ ì²˜í˜•í•œë‹¤.", next: "end_tyrant" },
                    { text: "ë¶€ì¡±í•œ ì‹ëŸ‰ì„ ì±„ìš°ê¸° ìœ„í•´ ì˜† ë¶€ì¡±ì„ ì•½íƒˆí•œë‹¤.", next: "end_savage" }
                ]
            },

            // ==========================================
            // 2. ì‚¼êµ­ ì‹œëŒ€ - ê³ êµ¬ë ¤
            // ==========================================
            jumong_chase: {
                type: 'history', badge: 'badge-goguryeo', era: "ë¶€ì—¬", year: "BC 37",
                title: "ì£¼ëª½ì˜ íƒˆì¶œ",
                desc: "ë¶€ì—¬ì˜ ì™•ì ëŒ€ì†Œì™€ ê·¸ í˜•ì œë“¤ì´ ì£¼ëª½ì˜ ë›°ì–´ë‚œ ì¬ì£¼ë¥¼ ì‹œê¸°í•˜ì—¬ ì£½ì´ë ¤ í•©ë‹ˆë‹¤. ì‚´ê¸° ì–´ë¦° ì¶”ê²©ëŒ€ê°€ ë°”ë¡œ ë’¤ê¹Œì§€ ì«“ì•„ì™”ìŠµë‹ˆë‹¤. ì–´ë–»ê²Œ ë„ë§ì¹˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                progress: 7, icon: "ğŸ",
                choices: [
                    { text: "ì•ì„ ê°€ë¡œë§‰ëŠ” ê°•(ì—„ë¦¬ëŒ€ìˆ˜)ìœ¼ë¡œ ë‹¬ë ¤ê°€ í•˜ëŠ˜ì— ê¸°ë„ë¥¼ ì˜¬ë¦°ë‹¤.", next: "goguryeo_jumong", minigame: 'river_game' },
                    { text: "ì‚¬ëŒë“¤ì´ ë§ì€ ë§ˆì„ë¡œ ìˆ¨ì–´ë“¤ì–´ ëª¸ì„ í”¼í•œë‹¤.", next: "crisis_village_hide" },
                    { text: "ì¶”ê²©ëŒ€ë¥¼ í”¼í•´ í—˜ì¤€í•œ ì‚°ì† ê¹Šì€ ê³³ìœ¼ë¡œ ë„ë§ì¹œë‹¤.", next: "crisis_mountain_lost" }
                ]
            },
            crisis_village_hide: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: í¬ìœ„ë§",
                desc: "ë§ˆì„ì— ìˆ¨ì—ˆì§€ë§Œ ë¶€ì—¬êµ°ì˜ ìˆ˜ìƒ‰ë§ì´ ì¢í˜€ì˜¤ê³  ìˆìŠµë‹ˆë‹¤. í˜„ìƒê¸ˆì´ ê±¸ë ¤ ìˆì–´ ë§ˆì„ ì‚¬ëŒë“¤ì˜ ëˆˆì´ˆë¦¬ë„ ì‹¬ìƒì¹˜ ì•ŠìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "ìœ„í—˜ì„ ë¬´ë¦…ì“°ê³  í¬ìœ„ë§ì„ ëš«ê³  ê°•ìœ¼ë¡œ ë‹¬ë¦°ë‹¤.", next: "goguryeo_jumong" }, // íšŒë³µ
                    { text: "ë§ˆì„ ì‚¬ëŒì—ê²Œ ëˆì„ ì£¼ê³  ìˆ¨ê²¨ë‹¬ë¼ê³  ë¶€íƒí•œë‹¤.", next: "end_captured_buyeo" },
                    { text: "ìˆœìˆœíˆ ì¡í˜€ê°€ ì˜¤í•´ë¥¼ í’€ë ¤ í•œë‹¤.", next: "end_buyeo_sub" }
                ]
            },
            crisis_mountain_lost: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ë§‰ë‹¤ë¥¸ ê¸¸",
                desc: "ì‚°ì† ê¹Šì´ ë“¤ì–´ì™”ì§€ë§Œ ê¸¸ì€ ëŠê¸°ê³  ì ˆë²½ì´ ì•ì„ ê°€ë¡œë§‰ì•˜ìŠµë‹ˆë‹¤. ë§ë„ ì§€ì³ ì“°ëŸ¬ì§€ê¸° ì§ì „ì…ë‹ˆë‹¤.",
                choices: [
                    { text: "ë§ì„ ë²„ë¦¬ê³  ì•”ë²½ì„ íƒ€ê³  ë‚´ë ¤ê°€ ê°• ìª½ìœ¼ë¡œ í–¥í•œë‹¤.", next: "goguryeo_jumong" }, // íšŒë³µ
                    { text: "ë™êµ´ì„ ì°¾ì•„ ìˆ¨ì–´ì„œ êµ¬ì¡°ë¥¼ ê¸°ë‹¤ë¦°ë‹¤.", next: "end_mountain_lost" },
                    { text: "ì¶”ê²©ëŒ€ì™€ ë§ì„œ ì‹¸ìš´ë‹¤.", next: "end_bad_tactic" }
                ]
            },

            goguryeo_jumong: {
                type: 'history', badge: 'badge-goguryeo', era: "ê³ êµ¬ë ¤", year: "BC 37",
                title: "ìƒˆë¡œìš´ ë‚˜ë¼ì˜ ê±´êµ­",
                desc: "ë¶€ì—¬ì˜ ì™•ìë“¤ì—ê²Œ ì‹œê¸°ë¥¼ ë°›ì•„ ì«“ê²¨ë‚œ ì£¼ëª½ì€ ì••ë¡ê°• ìœ ì—­ì˜ ì¡¸ë³¸ì— ë„ì°©í–ˆìŠµë‹ˆë‹¤. ì´ê³³ì€ ì‚°ì„¸ê°€ í—˜í•˜ì§€ë§Œ ë°©ì–´í•˜ê¸° ì¢‹ìŠµë‹ˆë‹¤. ì´ì œ ìƒˆë¡œìš´ ë‚˜ë¼ë¥¼ ì„¸ì›Œì•¼ í•©ë‹ˆë‹¤. ì–´ë–¤ ê¸°ìƒì„ í’ˆìœ¼ì‹œê² ìŠµë‹ˆê¹Œ?",
                progress: 8, icon: "ğŸ¹",
                choices: [
                    { text: "í™œ ì˜ê¸°ì™€ ê¸°ë§ˆìˆ ì„ ì¤‘ì‹œí•˜ëŠ” ìƒë¬´ ì •ì‹ ìœ¼ë¡œ 'ê³ êµ¬ë ¤'ë¥¼ ì„¸ìš´ë‹¤.", next: "baekje_geunchogo" },
                    { text: "ë¶€ì—¬ì— í•­ë³µí•˜ê³  ë‹¤ì‹œ ëŒì•„ê°€ ì™•ì ìë¦¬ë¥¼ ë…¸ë¦°ë‹¤.", next: "end_buyeo_sub" },
                    { text: "ì‹¸ì›€ì´ ì‹«ìœ¼ë‹ˆ ë†ì‚¬ë§Œ ì§“ëŠ” í‰í™”ë¡œìš´ ì†Œêµ­ì„ ì„¸ìš´ë‹¤.", next: "crisis_weak_state" },
                    { text: "ì‹ ë¼ì˜ ë°•í˜ê±°ì„¸, ë°±ì œì˜ ì˜¨ì¡°ì™€ í•¨ê»˜ ì•Œì—ì„œ íƒœì–´ë‚œ ì‹ ì„±í•¨ì„ ê°•ì¡°í•œë‹¤.", next: "baekje_geunchogo" }
                ]
            },
            crisis_weak_state: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ì•½ì†Œêµ­ì˜ ë¹„ì• ",
                desc: "ë¬´ë ¥ì„ í¬ê¸°í•˜ê³  í‰í™”ë§Œ ì™¸ì¹˜ì, ì£¼ë³€ì˜ í•œë‚˜ë¼ êµ°í˜„ê³¼ ì„ ë¹„ì¡±ì´ ìš°ë¦¬ë¥¼ ë§Œë§Œí•˜ê²Œ ë³´ê³  ë§¤ì¼ê°™ì´ ì•½íƒˆí•´ ê°‘ë‹ˆë‹¤. ë°±ì„±ë“¤ì€ ì§‘ê³¼ ê°€ì¡±ì„ ìƒê³  ìš¸ë¶€ì§–ê³  ìˆìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "ë¹¼ì•—ê¸´ ê²ƒì„ ë˜ì°¾ê¸° ìœ„í•´ êµ°ì‚¬ë¥¼ ê¸°ë¥´ê³  êµ­ë°©ì„ ê°•í™”í•œë‹¤.", next: "baekje_geunchogo" }, // íšŒë³µ
                    { text: "ê·¸ë“¤ì—ê²Œ ì¡°ê³µì„ ë°”ì¹˜ê³  ì œë°œ ë´ë‹¬ë¼ê³  ë¹ˆë‹¤.", next: "end_vassal_generic" },
                    { text: "ë‚˜ë¼ë¥¼ ë²„ë¦¬ê³  ë” ê¹Šì€ ì‚°ì†ìœ¼ë¡œ ìˆ¨ëŠ”ë‹¤.", next: "end_fail_founding" }
                ]
            },
            
            baekje_geunchogo: {
                type: 'history', badge: 'badge-ancient', era: "ë°±ì œ", year: "4ì„¸ê¸°",
                title: "í•´ìƒ ì™•êµ­ ë°±ì œ",
                desc: "í•œê°• ìœ ì—­ì—ì„œ ì‹œì‘í•œ ë°±ì œê°€ ê·¼ì´ˆê³ ì™• ë•Œì— ì´ë¥´ëŸ¬ ì „ì„±ê¸°ë¥¼ ë§ì´í–ˆìŠµë‹ˆë‹¤. ë„“ì€ í‰ì•¼ì™€ ë°”ë‹¤ê°€ ìš°ë¦¬ ì•ì— ìˆìŠµë‹ˆë‹¤. ë°±ì œì˜ ë°°ê°€ ì–´ë””ë¡œ í–¥í•´ì•¼ êµ­ë ¥ì„ ë”ìš± ë–¨ì¹  ìˆ˜ ìˆì„ê¹Œìš”?",
                progress: 12, icon: "â›µ",
                choices: [
                    { text: "ë¶ìœ¼ë¡œ ê³ êµ¬ë ¤ë¥¼ ê²¬ì œí•˜ê³ , ë°”ë‹¤ ê±´ë„ˆ ì¤‘êµ­(ìš”ì„œ)ê³¼ ì¼ë³¸(ê·œìŠˆ)ìœ¼ë¡œ ì§„ì¶œí•œë‹¤.", next: "goguryeo_gwanggaeto" },
                    { text: "ì•ˆì „ì´ ìµœìš°ì„ ì´ë‹¤. ì„± ë¬¸ì„ ë‹«ê³  ì™¸êµ­ê³¼ì˜ êµë¥˜ë¥¼ ëŠëŠ”ë‹¤.", next: "crisis_baekje_isolation" },
                    { text: "ì‹ ë¼ë¥¼ ê³µê²©í•˜ì—¬ ê²½ì£¼ë¥¼ ë¶ˆë°”ë‹¤ë¡œ ë§Œë“ ë‹¤.", next: "crisis_early_war" }
                ]
            },
            crisis_baekje_isolation: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ê³ ë¦½ëœ ë°±ì œ",
                desc: "ë¬´ì—­ì´ ëŠê¸°ì ë°±ì œì˜ ê²½ì œê°€ ë§ˆë¹„ë˜ì—ˆìŠµë‹ˆë‹¤. ì„ ì§„ ë¬¸ë¬¼ì„ ë°›ì•„ë“¤ì´ì§€ ëª»í•´ ê¸°ìˆ ì´ ë’¤ì³ì§€ê³ , ê·€ì¡±ë“¤ì€ ì™•ì˜ ì†Œì‹¬í•œ ì •ì±…ì— ë¶ˆë§Œì„ í’ˆê³  ìˆìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "ë‹¤ì‹œ ë°”ë‹·ê¸¸ì„ ì—´ê³  í™œë°œí•œ ì •ë³µ í™œë™ì„ ì‹œì‘í•˜ì—¬ ê·€ì¡±ë“¤ì˜ ë¶ˆë§Œì„ ì ì¬ìš´ë‹¤.", next: "goguryeo_gwanggaeto" }, // íšŒë³µ
                    { text: "ë°˜ëŒ€í•˜ëŠ” ê·€ì¡±ë“¤ì„ ëª¨ë‘ ì£½ì—¬ ê³µí¬ ì •ì¹˜ë¥¼ í•œë‹¤.", next: "end_tyrant" },
                    { text: "ê°•ë ¥í•œ ê³ êµ¬ë ¤ì— ë„ì›€ì„ ìš”ì²­í•˜ê³  ë•…ì„ ë–¼ì–´ì¤€ë‹¤.", next: "end_vassal_goguryeo" }
                ]
            },
            crisis_early_war: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ë¹ˆì§‘í„¸ì´",
                desc: "ì‹ ë¼ë¥¼ ê³µê²©í•˜ëŸ¬ ì£¼ë ¥êµ°ì´ ë¹ ì ¸ë‚˜ê°„ ì‚¬ì´, ë¶ìª½ì—ì„œ ê³ êµ¬ë ¤ê°€ í…… ë¹ˆ ìš°ë¦¬ êµ­ê²½ì„ ë„˜ì–´ ì³ë“¤ì–´ì™”ìŠµë‹ˆë‹¤. ìˆ˜ë„ê°€ í•¨ë½ë  ìœ„ê¸°ì…ë‹ˆë‹¤!",
                choices: [
                    { text: "êµ°ëŒ€ë¥¼ ê¸‰íˆ ëŒë ¤ ê³ êµ¬ë ¤êµ°ì„ ë§‰ì•„ë‚´ê³  ì „ì„ ì„ ì¬ì •ë¹„í•œë‹¤.", next: "goguryeo_gwanggaeto" }, // íšŒë³µ
                    { text: "ì‹ ë¼ ê³µê²©ì— ëª¨ë“  ê²ƒì„ ê±´ë‹¤. ë’¤ëŠ” ìƒê°í•˜ì§€ ì•ŠëŠ”ë‹¤.", next: "end_savage" },
                    { text: "ë°°ë¥¼ íƒ€ê³  ì¼ë³¸ìœ¼ë¡œ ë„ë§ì¹œë‹¤.", next: "end_exile_ancient" }
                ]
            },
            
            goguryeo_gwanggaeto: {
                type: 'history', badge: 'badge-goguryeo', era: "ê³ êµ¬ë ¤", year: "391ë…„~",
                title: "ê´‘ê°œí† ëŒ€ì™•ì˜ ì›…ë¹„",
                desc: "ê³ êµ¬ë ¤ì˜ ê´‘ê°œí† ëŒ€ì™•ì€ 'ì˜ë½'ì´ë¼ëŠ” ë…ìì ì¸ ì—°í˜¸ë¥¼ ì‚¬ìš©í•˜ë©° ëŒ€ì œêµ­ì„ ê±´ì„¤í•˜ê³ ì í•©ë‹ˆë‹¤. ì‚¬ë°©ì— ì ë“¤ì´ ìˆì§€ë§Œ, ìš°ë¦¬ ê¸°ë³‘ì˜ ë§ë°œêµ½ ì†Œë¦¬ëŠ” ê·¼ë°©ì˜ êµ­ê°€ë¥¼ ë‘ë µê²Œ í•©ë‹ˆë‹¤. ì–´ë””ë¥¼ ë¨¼ì € ê³µëµí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                progress: 15, icon: "ğŸ",
                choices: [
                    { text: "ë¶ìœ¼ë¡œ ë§Œì£¼ë¥¼ í˜¸ë ¹í•˜ê³ , ë‚¨ìœ¼ë¡œ ë‚´ë ¤ê°€ ì‹ ë¼ë¥¼ ê´´ë¡­íˆëŠ” ì™œêµ¬ë¥¼ ê²©í‡´í•œë‹¤.", next: "shilla_growth" },
                    { text: "ë°±ì œì™€ ì†ì¡ê³  ì‹ ë¼ë¥¼ í˜‘ê³µí•˜ì—¬ í•œë°˜ë„ ë‚¨ë¶€ë¥¼ ë‚˜ëˆ  ê°€ì§„ë‹¤.", next: "crisis_shilla_fall" },
                    { text: "ì¤‘êµ­ ë³¸í†  ê¹Šìˆ™ì´ ì³ë“¤ì–´ê°€ ì¤‘ì›ì˜ í™©ì œê°€ ë˜ë ¤ í•œë‹¤.", next: "crisis_over_extension" }
                ]
            },
            crisis_shilla_fall: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ê¹¨ì§„ ê· í˜•",
                desc: "ì‹ ë¼ë¥¼ ê³µê²©í•˜ì—¬ í° ìŠ¹ë¦¬ë¥¼ ê±°ë’€ì§€ë§Œ, ë°±ì œê°€ ì•½ì†ì„ ì–´ê¸°ê³  ì‹ ë¼ ë•…ì„ ë…ì°¨ì§€í•œ ë’¤ ê³ êµ¬ë ¤ì˜ ë°°í›„ë¥¼ ìœ„í˜‘í•©ë‹ˆë‹¤. ë¯¿ì—ˆë˜ ë„ë¼ì— ë°œë“± ì°íŒ ê¼´ì´ ë˜ì—ˆìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "ë°°ì‹ ì ë°±ì œë¥¼ ì‘ì§•í•˜ê³  í•œê°• ì´ë¶ì˜ íŒ¨ê¶Œì„ í™•ê³ íˆ í•œë‹¤.", next: "shilla_growth" }, // íšŒë³µ
                    { text: "ë°±ì œì˜ ì„¸ë ¥ì´ ë„ˆë¬´ ì»¤ì¡Œë‹¤. í•­ë³µí•œë‹¤.", next: "end_vassal_baekje" },
                    { text: "ë‚¨ìª½ ë•…ì„ ëª¨ë‘ í¬ê¸°í•˜ê³  ë§Œì£¼ë¡œë§Œ ë‚˜ì•„ê°„ë‹¤.", next: "crisis_weak_state" }
                ]
            },
            crisis_over_extension: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ë³´ê¸‰ë¡œ ì°¨ë‹¨",
                desc: "ë„ˆë¬´ ê¹Šì´ ë“¤ì–´ê°”ìŠµë‹ˆë‹¤. ë³´ê¸‰ë¡œê°€ ëŠê¸°ê³  ë³‘ì‚¬ë“¤ì€ ì§€ì³ ì“°ëŸ¬ì§‘ë‹ˆë‹¤. ì¤‘êµ­ì˜ ëŒ€êµ°ì´ í¬ìœ„ë§ì„ ì¢í˜€ì˜¤ê³  ìˆìŠµë‹ˆë‹¤. ê³ êµ¬ë ¤ ë³¸í† ê°€ ìœ„í—˜í•©ë‹ˆë‹¤.",
                choices: [
                    { text: "ìš•ì‹¬ì„ ë²„ë¦¬ê³  ì‹ ì†íˆ ì² êµ°í•˜ì—¬ ìš”ë™ ë°©ì–´ì„ ì„ êµ³ê±´íˆ í•œë‹¤.", next: "shilla_growth" }, // íšŒë³µ
                    { text: "ëª©ìˆ¨ì„ ê±¸ê³  ì•ìœ¼ë¡œ ëŒê²©í•œë‹¤.", next: "end_bad_tactic" },
                    { text: "ì ì¥ì—ê²Œ í•­ë³µí•˜ê³  ê·¸ì˜ ë¶€í•˜ê°€ ëœë‹¤.", next: "end_vassal_generic" }
                ]
            },

            shilla_growth: {
                type: 'history', badge: 'badge-ancient', era: "ì‹ ë¼", year: "6ì„¸ê¸°",
                title: "ì‹ ë¼ì˜ ë„ì•½ê³¼ ì§„í¥ì™•",
                desc: "ì‹ ë¼ëŠ” ì‚¼êµ­ ì¤‘ ê°€ì¥ ëŠ¦ê²Œ ë°œì „í–ˆì§€ë§Œ, ë²•í¥ì™•ì´ ë¶ˆêµë¥¼ ê³µì¸í•˜ê³  ì§„í¥ì™•ì´ í™”ë‘ë„ë¥¼ ì •ë¹„í•˜ë©° ì „ì„±ê¸°ë¥¼ ë§ì´í–ˆìŠµë‹ˆë‹¤. ì§„í¥ì™•ì€ í•œê°• ìœ ì—­ì„ ì°¨ì§€í•˜ê³  ë¶í•œì‚°ì— ìˆœìˆ˜ë¹„ë¥¼ ì„¸ì› ìŠµë‹ˆë‹¤.",
                progress: 17, icon: "ğŸ‘‘",
                choices: [
                    { text: "í™”ë‘ë„ë¥¼ êµ­ê°€ì  ì¡°ì§ìœ¼ë¡œ í‚¤ìš°ê³ , ì¤‘êµ­ê³¼ ì§ì ‘ êµë¥˜í•˜ì—¬ ì‚¼êµ­ í†µì¼ì˜ ê¸°ë°˜ì„ ë‹¦ëŠ”ë‹¤.", next: "goguryeo_salsu" },
                    { text: "ë°±ì œì™€ì˜ ë™ë§¹ì„ ëê¹Œì§€ ë¯¿ê³  í•œê°•ì„ í¬ê¸°í•œë‹¤.", next: "crisis_stagnant_shilla" },
                    { text: "ê³ êµ¬ë ¤ì˜ í˜ì´ ê°•ë ¥í•˜ë‹ˆ ì¡°ê³µì„ ë°”ì¹˜ë©° ë‚˜ì¤‘ì— ì—­ì „ì„ ë…¸ë¦°ë‹¤.", next: "end_weakness" }
                ]
            },
            crisis_stagnant_shilla: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ê°‡í˜€ë²„ë¦° ì‹ ë¼",
                desc: "í•œê°•ì„ ì°¨ì§€í•˜ì§€ ëª»í•œ ì‹ ë¼ëŠ” ì¤‘êµ­ìœ¼ë¡œ ê°€ëŠ” ë±ƒê¸¸ì´ ë§‰í˜”ìŠµë‹ˆë‹¤. ë°±ì œëŠ” ë”ìš± ê°•ì„±í•´ì ¸ ê²°êµ­ ì‹ ë¼ë¥¼ ìœ„í˜‘í•˜ê³ , ì‹ ë¼ëŠ” ì˜ì›íˆ ë³€ë°©ì˜ ì‘ì€ ë‚˜ë¼ë¡œ ë‚¨ì„ ìœ„ê¸°ì…ë‹ˆë‹¤.",
                choices: [
                    { text: "ëŠ¦ê²Œë‚˜ë§ˆ ë™ë§¹ì„ ê¹¨ê³  í•œê°• ìœ ì—­ì„ ê³µê²©í•œë‹¤.", next: "goguryeo_salsu" }, // íšŒë³µ
                    { text: "ë°±ì œì— ë¨¸ë¦¬ë¥¼ ìˆ™ì´ê³  ë‚˜ì¤‘ì— ì—­ì „ì„ ë…¸ë¦°ë‹¤.", next: "end_vassal_baekje" },
                    { text: "ì‚°ì†ìœ¼ë¡œ ë“¤ì–´ê°€ ìˆ¨ëŠ”ë‹¤.", next: "end_coward" }
                ]
            },

            goguryeo_salsu: {
                type: 'history', badge: 'badge-goguryeo', era: "ê³ êµ¬ë ¤", year: "612ë…„",
                title: "ì‚´ìˆ˜ëŒ€ì²©",
                desc: "ì¤‘êµ­ì„ í†µì¼í•œ ìˆ˜ë‚˜ë¼ê°€ 113ë§Œì´ë¼ëŠ” ì–´ë§ˆì–´ë§ˆí•œ ëŒ€êµ°ì„ ì´ëŒê³  ê³ êµ¬ë ¤ë¥¼ ì¹¨ê³µí–ˆìŠµë‹ˆë‹¤. ì •ë©´ ìŠ¹ë¶€ë¡œëŠ” ìŠ¹ì‚°ì´ ì—†ìŠµë‹ˆë‹¤. ì„ì§€ë¬¸ë• ì¥êµ°, ë‚˜ë¼ì˜ ìš´ëª…ì´ ë‹¹ì‹ ì˜ ì†ì— ë‹¬ë ¸ìŠµë‹ˆë‹¤.",
                progress: 18, icon: "ğŸŒŠ",
                choices: [
                    { text: "ê±°ì§“ íŒ¨ë°°ë¡œ ì ì„ ê¹Šìˆ™ì´ ìœ ì¸í•˜ì—¬ ì§€ì¹˜ê²Œ í•œ ë’¤, ì‚´ìˆ˜(ê°•)ë¥¼ ê±´ë„ ë•Œ ìˆ˜ì¥ì‹œí‚¨ë‹¤.", next: "shilla_unification" },
                    { text: "í‰ì–‘ì„± ì•ì— ì „ ë³‘ë ¥ì„ ëª¨ì•„ ì •ë©´ ìŠ¹ë¶€ë¥¼ ê±´ë‹¤.", next: "crisis_pyongyang_siege" },
                    { text: "ìŠ¹ì‚°ì´ ì—†ë‹¤. í•­ë³µí•˜ì—¬ ë‚˜ë¼ë¥¼ ë³´ì¡´í•˜ëŠ” ê²ƒì´ ë‚«ë‹¤.", next: "end_sui_colony" }
                ]
            },
            crisis_pyongyang_siege: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: í‰ì–‘ì„± í¬ìœ„",
                desc: "ìˆ˜ë‚˜ë¼ ë³„ë™ëŒ€ 30ë§Œì—ê²Œ í‰ì–‘ì„±ì´ ì™„ì „íˆ í¬ìœ„ë˜ì—ˆìŠµë‹ˆë‹¤. ì„±ì•ˆì˜ ì‹ëŸ‰ì€ ë°”ë‹¥ë‚˜ê³ , ë°±ì„±ë“¤ì€ êµ¶ì£¼ë¦¼ê³¼ ê³µí¬ì— ë–¨ê³  ìˆìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "ì ì¥ ìš°ì¤‘ë¬¸ì—ê²Œ ê±°ì§“ í•­ë³µ í¸ì§€ë¥¼ ë³´ë‚´ ë°©ì‹¬ì‹œí‚¨ í‹ˆì„ íƒ€ ê¸°ìŠµí•œë‹¤.", next: "shilla_unification" }, // íšŒë³µ
                    { text: "ì„±ë¬¸ì„ ì—´ê³  ë¬´ì¡°ê±´ í•­ë³µí•œë‹¤.", next: "end_sui_colony" },
                    { text: "ë°±ì„±ë“¤ì˜ ì‹ëŸ‰ì„ ëºì–´ êµ°ëŒ€ë§Œ ë¨¹ì´ê³  ë²„í‹´ë‹¤.", next: "end_tyrant" }
                ]
            },

            // ==========================================
            // 3. ë‚¨ë¶êµ­ ì‹œëŒ€
            // ==========================================
            shilla_unification: {
                type: 'history', badge: 'badge-ancient', era: "ì‹ ë¼", year: "676ë…„",
                title: "ë‚˜ë‹¹ì „ìŸê³¼ ì‚¼êµ­í†µì¼",
                desc: "ì‹ ë¼ê°€ ë‹¹ë‚˜ë¼ì™€ ì—°í•©í•˜ì—¬ ë°±ì œì™€ ê³ êµ¬ë ¤ë¥¼ ë¬´ë„ˆëœ¨ë ¸ìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ë™ë§¹ì´ì—ˆë˜ ë‹¹ë‚˜ë¼ê°€ ë³¸ìƒ‰ì„ ë“œëŸ¬ëƒˆìŠµë‹ˆë‹¤. ê·¸ë“¤ì€ ì•½ì†ì„ ì–´ê¸°ê³  í•œë°˜ë„ ì „ì²´ë¥¼ ìì‹ ë“¤ì˜ ì§€ë°°í•˜ì— ë‘ë ¤ í•©ë‹ˆë‹¤. ì–´ì œì˜ ë™ì§€ê°€ ì˜¤ëŠ˜ì˜ ì ì´ ë˜ì—ˆìŠµë‹ˆë‹¤.",
                progress: 22, icon: "ğŸ‘‘",
                choices: [
                    { text: "ì™¸ì„¸ì˜ ì§€ë°°ë¥¼ ë°›ì„ ìˆœ ì—†ë‹¤. ë‹¹ë‚˜ë¼ì™€ ì „ìŸì„ ë²Œì—¬ ê·¸ë“¤ì„ ëª°ì•„ë‚¸ë‹¤.", next: "balhae_founding" },
                    { text: "ëŒ€êµ­ì¸ ë‹¹ë‚˜ë¼ì™€ ì‹¸ì›Œ ì´ê¸¸ ìˆ˜ ì—†ë‹¤. ì§€ë°°ë¥¼ ì¸ì •í•˜ê³  ìŠ¤ìŠ¤ë¡œ ë‚˜ë¼ë¥¼ ë‹¤ìŠ¤ë¦´ ê¶Œë¦¬ë§Œ ì–»ëŠ”ë‹¤.", next: "end_tang_vassal" },
                    { text: "ê³ êµ¬ë ¤ ìœ ë¯¼ë“¤ì´ ìš°ë¦¬ì—ê²Œ ë³µìˆ˜í•˜ê¸° ìœ„í•´ ë‹¹ë‚˜ë¼ì™€ ì†ì¡ì„ì§€ ëª¨ë¥¸ë‹¤. ì•„ì§ êµ°ëŒ€ë¥¼ ë§Œë“¤ì§€ ëª»í•œ ê·¸ë“¤ì„ ë¨¼ì € ê³µê²©í•œë‹¤.", next: "crisis_internal_war" }
                ]
            },
            crisis_internal_war: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ë‚´ì „ì˜ ëŠª",
                desc: "ê°™ì€ ë¯¼ì¡±ì¸ ê³ êµ¬ë ¤ ìœ ë¯¼ì„ ì ìœ¼ë¡œ ëŒë¦¬ì, ê·¸ë“¤ì€ ì‚´ê¸° ìœ„í•´ ë‹¹ë‚˜ë¼ì™€ ì†ì¡ê³  ì‹ ë¼ë¥¼ ê³µê²©í•´ì˜µë‹ˆë‹¤. ë‹¹ë‚˜ë¼ë¥¼ ëª°ì•„ë‚´ê¸°ë„ ë²…ì°¬ë° ë‚´ë¶€ì˜ ì ê¹Œì§€ ìƒê²¼ìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "ìœ ë¯¼ë“¤ì„ í¬ìš©í•˜ê³  í˜ì„ í•©ì³ ë‹¹ë‚˜ë¼ë¥¼ ëª°ì•„ë‚´ìê³  ì„¤ë“í•œë‹¤.", next: "balhae_founding" }, // íšŒë³µ
                    { text: "ëê¹Œì§€ ë™ì¡±ë¼ë¦¬ ì‹¸ìš°ëŠ” ë¹„ê·¹ì„ ë²Œì¸ë‹¤.", next: "end_savage" },
                    { text: "ë‹¹ë‚˜ë¼ì— ë‡Œë¬¼ì„ ì£¼ê³  í‰í™”ë¥¼ ì‚°ë‹¤.", next: "end_tang_vassal" }
                ]
            },

            balhae_founding: {
                type: 'history', badge: 'badge-goguryeo', era: "ë°œí•´", year: "698ë…„",
                title: "í•´ë™ì„±êµ­ ë°œí•´",
                desc: "ê³ êµ¬ë ¤ê°€ ë©¸ë§í•œ ì§€ 30ë…„, ê³ êµ¬ë ¤ ìœ ë¯¼ ëŒ€ì¡°ì˜ì€ ë‹¹ë‚˜ë¼ì˜ ì¶”ê²©ì„ ë”°ëŒë¦¬ê³  ë™ëª¨ì‚°ì— í„°ë¥¼ ì¡ì•˜ìŠµë‹ˆë‹¤. ì´ì œ ìƒˆë¡œìš´ ë‚˜ë¼ë¥¼ ì„ í¬í•˜ë ¤ í•©ë‹ˆë‹¤. ìš°ë¦¬ëŠ” ëˆ„êµ¬ì˜ ì—­ì‚¬ë¥¼ ì‡ëŠ” ë‚˜ë¼ì…ë‹ˆê¹Œ?",
                progress: 25, icon: "ğŸ°",
                choices: [
                    { text: "ë‚˜ë¼ ì´ë¦„ì„ 'ë°œí•´'ë¼ í•˜ê³ , ë‹¹ë‹¹íˆ ê³ êµ¬ë ¤ ê³„ìŠ¹ì„ ì²œëª…í•œë‹¤.", next: "later_three_kingdoms" },
                    { text: "ë§ê°ˆì¡±ì´ ë§ìœ¼ë‹ˆ ë§ê°ˆì˜ ë‚˜ë¼ì„ì„ ì„ í¬í•˜ê³  ê³ êµ¬ë ¤ì™€ ì„ ì„ ê¸‹ëŠ”ë‹¤.", next: "crisis_identity" },
                    { text: "ë‹¹ë‚˜ë¼ì— í•­ë³µí•˜ì—¬ ì¥êµ°ìœ¼ë¡œ í¸í•˜ê²Œ ì—¬ìƒì„ ë³´ë‚¸ë‹¤.", next: "end_no_balhae" }
                ]
            },
            crisis_identity: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ìª¼ê°œì§„ ë§ˆìŒ",
                desc: "ê³ êµ¬ë ¤ ìœ ë¯¼ë“¤ì´ 'ìš°ë¦¬ì˜ ë‚˜ë¼ê°€ ì•„ë‹ˆë‹¤'ë¼ë©° ë°˜ë°œí•˜ì—¬ ë– ë‚˜ë ¤ í•©ë‹ˆë‹¤. ë‚˜ë¼ê°€ ì„¸ì›Œì§€ê¸°ë„ ì „ì— ë‘˜ë¡œ ìª¼ê°œì§ˆ ìœ„ê¸°ì…ë‹ˆë‹¤. êµ­ë ¥ì´ ëª¨ì´ì§€ ì•ŠìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "ê³ êµ¬ë ¤ì™€ ë§ê°ˆì„ ì•„ìš°ë¥´ëŠ” ìœµí•© ì •ì±…ì„ í´ì„œ ëª¨ë‘ë¥¼ í¬ìš©í•œë‹¤.", next: "later_three_kingdoms" }, // íšŒë³µ
                    { text: "ë°˜ë°œí•˜ëŠ” ê³ êµ¬ë ¤ ìœ ë¯¼ì„ ëª¨ë‘ ì¶”ë°©í•œë‹¤.", next: "end_weakness" },
                    { text: "ë‚˜ë¼ë¥¼ í•´ì²´í•˜ê³  ê°ì ë¶€ì¡± ë‹¨ìœ„ë¡œ ëŒì•„ê°„ë‹¤.", next: "end_no_balhae" }
                ]
            },

            later_three_kingdoms: {
                type: 'history', badge: 'badge-ancient', era: "í›„ì‚¼êµ­", year: "900ë…„ê²½",
                title: "í›„ì‚¼êµ­ì˜ í˜¼ë€",
                desc: "ì‹ ë¼ì˜ êµ­ìš´ì´ ê¸°ìš¸ì, ê²¬í›¤ì€ í›„ë°±ì œë¥¼, ê¶ì˜ˆëŠ” í›„ê³ êµ¬ë ¤ë¥¼ ì„¸ì›Œ ì²œí•˜ëŠ” ë‹¤ì‹œ ì…‹ìœ¼ë¡œ ë‚˜ë‰˜ì—ˆìŠµë‹ˆë‹¤. ì˜ì›…ë“¤ì´ íŒ¨ê¶Œì„ ë‹¤íˆ¬ëŠ” í˜¼ë€ì˜ ì‹œê¸°, ë°±ì„±ë“¤ì€ í‰í™”ë¡œìš´ ì„¸ìƒì„ ê°ˆë§í•©ë‹ˆë‹¤.",
                progress: 28, icon: "âš”ï¸",
                choices: [
                    { text: "í­ì •ì„ ì¼ì‚¼ëŠ” ê¶ì˜ˆë¥¼ ëª°ì•„ë‚´ê³ , ë•ë§ ë†’ì€ ì™•ê±´ì„ ìƒˆ ì™•ìœ¼ë¡œ ì¶”ëŒ€í•œë‹¤.", next: "goryeo_wanggeon" },
                    { text: "ê²¬í›¤ê³¼ ì†ì¡ê³  ì‹ ë¼ë¥¼ ë©¸ë§ì‹œí‚¨ë‹¤.", next: "crisis_ally_gyeonhwon" },
                    { text: "ì‹ ë¼ì˜ ë§ˆì§€ë§‰ ì¶©ì‹ ìœ¼ë¡œ ë‚¨ì•„ ëê¹Œì§€ ì €í•­í•œë‹¤.", next: "end_weakness" }
                ]
            },
            crisis_ally_gyeonhwon: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ì”í˜¹í•œ ì ë ¹êµ°",
                desc: "ê²¬í›¤ê³¼ ì†ì¡ê³  ì‹ ë¼ì˜ ìˆ˜ë„ ê¸ˆì„±(ì§€ê¸ˆì˜ ê²½ì£¼)ì„ í•¨ë½ì‹œì¼°ìœ¼ë‚˜, ê²¬í›¤ì€ ì•½ì†ì„ ì–´ê¸°ê³  ì™•ì„ ì‚´í•´í•˜ë©° ë°±ì„±ë“¤ì„ ì”í˜¹í•˜ê²Œ ìœ ë¦°í–ˆìŠµë‹ˆë‹¤. ì‹ ë¼ì˜ ë¯¼ì‹¬ì€ ë‹¹ì‹ ì„ ì¹¨ëµìë¡œ ì—¬ê¸°ë©° ë“±ì„ ëŒë ¸ê³ , ê²¬í›¤ì€ ì´ì œ ë‹¹ì‹ ê¹Œì§€ ìœ„í˜‘í•©ë‹ˆë‹¤.",
                choices: [
                    { text: "ê²¬í›¤ì˜ ë§Œí–‰ì„ ê·œíƒ„í•˜ê³ , ì‹ ë¼ì˜ ìœ ë¯¼ë“¤ì„ ë³´í˜¸í•˜ë©° ë¯¼ì‹¬ì„ ë˜ëŒë¦°ë‹¤.", next: "goryeo_wanggeon" }, // íšŒë³µ
                    { text: "ê²¬í›¤ì˜ í˜ì´ ê°•í•˜ë‹ˆ ê·¸ì˜ ì‹ í•˜ê°€ ë˜ì–´ ë¯¼ì¡±ì˜ í˜ì„ ê¸°ë¥´ëŠ”ë° ë‚˜ì˜ ëŠ¥ë ¥ì„ ë°”ì¹œë‹¤.", next: "end_traitor" },
                    { text: "ëª¨ë“  ê²ƒì„ ë²„ë¦¬ê³  ì‚°ì†ìœ¼ë¡œ ë„ë§ì¹œë‹¤.", next: "end_coward" }
                ]
            },

            // ==========================================
            // 4. ê³ ë ¤ ì‹œëŒ€
            // ==========================================
            goryeo_wanggeon: {
                type: 'history', badge: 'badge-goryeo', era: "ê³ ë ¤", year: "918ë…„",
                title: "ê³ ë ¤ ê±´êµ­",
                desc: "í›„ì‚¼êµ­ì˜ í˜¼ë€ì„ ì ì¬ìš°ê³  ì™•ê±´ì´ ê³ ë ¤ë¥¼ ì„¸ì› ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì§€ë°©ì—ëŠ” ì—¬ì „íˆ ê°•ë ¥í•œ ì‚¬ë³‘ì„ ê±°ëŠë¦° í˜¸ì¡±ë“¤ì´ ë²„í‹°ê³  ìˆìŠµë‹ˆë‹¤. ì´ë“¤ì„ ì–´ë–»ê²Œ ë‹¤ìŠ¤ë ¤ì•¼ ì§„ì •í•œ í†µì¼ì„ ì´ë£° ìˆ˜ ìˆì„ê¹Œìš”?",
                progress: 30, icon: "ğŸ’",
                choices: [
                    { text: "ì •ëµ ê²°í˜¼ìœ¼ë¡œ í˜¸ì¡±ë“¤ì„ ê°€ì¡±ìœ¼ë¡œ ë§Œë“¤ê³ , ë¶ì§„ ì •ì±…ìœ¼ë¡œ ë¹„ì „ì„ ì œì‹œí•œë‹¤.", next: "goryeo_seohee" },
                    { text: "í˜¸ì¡±ë“¤ì„ ëª¨ë‘ ë°˜ì—­ìë¡œ ëª°ì•„ ì²˜í˜•í•˜ì—¬ ê°•ë ¥í•œ ì™•ê¶Œì„ ì„¸ìš´ë‹¤.", next: "crisis_rebellion" },
                    { text: "ì‹ ë¼ì˜ ê³¨í’ˆì œë¥¼ ê·¸ëŒ€ë¡œ ë°›ì•„ë“¤ì—¬ ê·€ì¡± ì¤‘ì‹¬ ì‚¬íšŒë¥¼ ë§Œë“ ë‹¤.", next: "crisis_stagnation" }
                ]
            },
            crisis_rebellion: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: í˜¸ì¡±ë“¤ì˜ ë°˜ë€",
                desc: "ë¬´ë¦¬í•œ ìˆ™ì²­ì— ìœ„ê¸°ê°ì„ ëŠë‚€ í˜¸ì¡±ë“¤ì´ ì—°í•©í•˜ì—¬ ë°˜ë€ì„ ì¼ìœ¼ì¼°ìŠµë‹ˆë‹¤. ê°“ ì„¸ìš´ ì™•ì¡°ê°€ ë¬´ë„ˆì§ˆ ìœ„ê¸°ì…ë‹ˆë‹¤.",
                choices: [
                    { text: "ìœ í™”ì±…(ì‚¬ì‹¬ê´€, ê¸°ì¸ ì œë„)ì„ í†µí•´ ê·¸ë“¤ì—ê²Œ ì±…ì„ì„ ì£¼ê³  ë‹¬ëœë‹¤.", next: "goryeo_seohee" }, // íšŒë³µ
                    { text: "ë°˜ë€êµ°ê³¼ ëê¹Œì§€ ì‹¸ìš°ë‹¤ ì¥ë ¬íˆ ì „ì‚¬í•œë‹¤.", next: "end_bad_tactic" },
                    { text: "ì™•ìœ„ë¥¼ ë²„ë¦¬ê³  ì ˆë¡œ ë“¤ì–´ê°„ë‹¤.", next: "end_weakness" }
                ]
            },
            crisis_stagnation: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ê³ ì¸ ë¬¼",
                desc: "ì‹ ë¶„ì œë¥¼ ê·¸ëŒ€ë¡œ ìœ ì§€í•˜ì ëŠ¥ë ¥ ìˆëŠ” ì¸ì¬ë“¤ì´ ë“±ìš©ë˜ì§€ ëª»í•˜ê³  ë¶ˆë§Œì´ ìŒ“ì…ë‹ˆë‹¤. ìƒˆ ë‚˜ë¼ë¥¼ ì„¸ìš´ ì˜ë¯¸ê°€ í‡´ìƒ‰ë˜ì—ˆìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "ê³¼ê±°ì œë¥¼ ë„ì…í•˜ì—¬ ì‹ ë¶„ì— ìƒê´€ì—†ì´ ëŠ¥ë ¥ ìˆëŠ” ì¸ì¬ë¥¼ ë½‘ëŠ”ë‹¤.", next: "goryeo_seohee" }, // íšŒë³µ (ê´‘ì¢… ìƒëµ í›„ ì„œí¬ë¡œ ì—°ê²°)
                    { text: "ë¶ˆë§Œì„ ê°€ì§„ ìë“¤ì„ ë¬´ë ¥ìœ¼ë¡œ íƒ„ì••í•œë‹¤.", next: "end_tyrant" },
                    { text: "ë‚˜ë¼ë¥¼ ë‹¤ì‹œ 3ê°œë¡œ ìª¼ê° ë‹¤.", next: "end_savage" }
                ]
            },

            goryeo_seohee: {
                type: 'history', badge: 'badge-goryeo', era: "ê³ ë ¤", year: "993ë…„",
                title: "ì„œí¬ì˜ ì™¸êµ ë‹´íŒ",
                desc: "ê±°ë€(ìš”)ì˜ ì¥ìˆ˜ ì†Œì†ë…•ì´ 80ë§Œ ëŒ€êµ°ì„ ì´ëŒê³  ì¹¨ê³µí–ˆìŠµë‹ˆë‹¤. ì¡°ì • ëŒ€ì‹ ë“¤ì€ ê²ì— ì§ˆë ¤ í•­ë³µí•˜ê±°ë‚˜ ë•…ì„ ë–¼ì–´ì£¼ìê³  í•©ë‹ˆë‹¤. ì ì˜ ì˜ë„ë¥¼ íŒŒì•…í•œ ì„œí¬ê°€ ë‚˜ì„­ë‹ˆë‹¤.",
                progress: 36, icon: "ğŸ—£ï¸",
                choices: [
                    { text: "ê±°ë€ì´ ì†¡ë‚˜ë¼ì™€ì˜ ê´€ê³„ë¥¼ ëŠê¸¸ ì›í•¨ì„ ê°„íŒŒí•˜ê³ , ë‹´íŒì„ í†µí•´ ê°•ë™ 6ì£¼ë¥¼ ì–»ì–´ë‚¸ë‹¤.", next: "goryeo_ganggamchan" },
                    { text: "ì‹¸ìš¸ í˜ì´ ì—†ë‹¤. ìš”êµ¬ëŒ€ë¡œ ì„œê²½ ì´ë¶ì˜ ë•…ì„ ë–¼ì–´ì£¼ê³  í™”ì¹œí•œë‹¤.", next: "crisis_land_loss" },
                    { text: "ë¬´ì¡°ê±´ í•­ë³µí•˜ì—¬ ëª©ìˆ¨ì´ë¼ë„ ë¶€ì§€í•œë‹¤.", next: "end_colony_khitan" }
                ]
            },
            crisis_land_loss: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ëì—†ëŠ” ìš”êµ¬",
                desc: "ë•…ì„ ë–¼ì–´ì£¼ì ê±°ë€ì€ ê³ ë ¤ë¥¼ ê²ìŸì´ë¼ ì—¬ê²¨ ë” ë§ì€ ë•…ê³¼ ê³µë¬¼ì„ ìš”êµ¬í•´ì˜µë‹ˆë‹¤. í•œ ë²ˆì˜ ì–‘ë³´ê°€ í˜¸ë‘ì´ë¥¼ ë¶ˆëŸ¬ë“¤ì˜€ìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "ì§€ê¸ˆì´ë¼ë„ ê°•ê²½í•˜ê²Œ ë§ì„œ ì‹¸ìš°ê³  ì™¸êµì  ì‹¤ë¦¬ë¥¼ ì°¾ëŠ”ë‹¤.", next: "goryeo_ganggamchan" }, // íšŒë³µ
                    { text: "í•œ ë²ˆì— ë‚˜ë¼ê°€ ë©¸ë§í•˜ëŠ” ì¼ì´ ì—†ë„ë¡ ì¡°ê¸ˆì”© ë•…ì„ ë” ë–¼ì–´ì¤€ë‹¤.", next: "end_colony_khitan" },
                    { text: "ì†¡ë‚˜ë¼(ê³ ë ¤ì‹œëŒ€ ì¤‘êµ­ì— ìˆë˜ êµ­ê°€)ë¡œ ë„ë§ì¹œë‹¤.", next: "end_coward" }
                ]
            },

            goryeo_ganggamchan: {
                type: 'history', badge: 'badge-goryeo', era: "ê³ ë ¤", year: "1019ë…„",
                title: "ê·€ì£¼ ëŒ€ì²©",
                desc: "ê±°ë€ì´ ì•½ì†ì„ ì–´ê¸°ê³  3ì°¨ ì¹¨ì…ì„ ê°í–‰í–ˆìŠµë‹ˆë‹¤. ì†Œë°°ì••ì˜ 10ë§Œ ì •ì˜ˆêµ°ì´ ê°œê²½ì„ ë…¸ë¦¬ê³  ë‹¬ë ¤ì˜µë‹ˆë‹¤. ê°•ê°ì°¬ ì¥êµ°ì€ ê·€ì£¼ ë²ŒíŒì—ì„œ ì ì„ ë§ì´í•  ì¤€ë¹„ë¥¼ ë§ˆì³¤ìŠµë‹ˆë‹¤.",
                progress: 40, icon: "âš”ï¸",
                choices: [
                    { text: "ê°•ë¬¼ì„ ë§‰ì•„ ì ì„ í˜¼ë€ì‹œí‚¨ ë’¤, ë§¤ë³µí•œ êµ°ì‚¬ë¡œ ê¶¤ë©¸ì‹œí‚¨ë‹¤.", next: "goryeo_yoongwan" },
                    { text: "ê³µê²©í•˜ì§€ ì•Šê³  ê°€ë§Œíˆ ë‘ë©´ ëŒì•„ê°ˆ ì ì´ë‹ˆ ê³±ê²Œ ë³´ë‚´ì£¼ì–´ í‰í™”ë¥¼ ì–»ëŠ” ê¸¸ì„ íƒí•œë‹¤.", next: "crisis_khitan_return" },
                    { text: "ìˆ˜ë„ë¥¼ ë²„ë¦¬ê³  ë‚¨ìª½ìœ¼ë¡œ ë„ë§ê°„ë‹¤.", next: "crisis_capital_lost" }
                ]
            },
            crisis_khitan_return: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ê±°ë€ì˜ ì¬ì¹¨ì…",
                desc: "ì ì„ ì‚´ë ¤ ë³´ë‚´ì ê·¸ë“¤ì€ ì •ë¹„ í›„ ë‹¤ì‹œ ì³ë“¤ì–´ì™€ êµ­í† ë¥¼ ìœ ë¦°í•©ë‹ˆë‹¤. ìë¹„ê°€ í™”ë¥¼ ë¶ˆë €ìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "ë‚˜ì„±ì„ ìŒ“ê³  ì²œë¦¬ì¥ì„±ì„ ì¶•ì¡°í•˜ì—¬ ì² í†µ ë°©ì–´ íƒœì„¸ë¥¼ ê°–ì¶˜ë‹¤.", next: "goryeo_yoongwan" }, // íšŒë³µ
                    { text: "í•­ë³µí•œë‹¤.", next: "end_colony_khitan" },
                    { text: "ì êµ°ì„ ì˜ ë‹¬ë˜ ì—°í•©í•œë‹¤.", next: "end_traitor" }
                ]
            },
            crisis_capital_lost: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ë¶ˆíƒ€ëŠ” ê°œê²½",
                desc: "ìˆ˜ë„ë¥¼ ë²„ë¦¬ì ë°±ì„±ë“¤ì˜ ì‹ ë§ì„ ìƒì—ˆê³ , ê±°ë€êµ°ì€ í…… ë¹ˆ ê°œê²½ì„ ë¶ˆíƒœì› ìŠµë‹ˆë‹¤. ì™•ì˜ ê¶Œìœ„ê°€ ë°”ë‹¥ì— ë–¨ì–´ì¡ŒìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "ê°ì§€ì—ì„œ ì˜ë³‘ì„ ëª¨ì•„ ì ì˜ ë³´ê¸‰ë¡œë¥¼ ëŠê³  ëˆì§ˆê¸°ê²Œ ë°˜ê²©í•œë‹¤.", next: "goryeo_yoongwan" }, // íšŒë³µ
                    { text: "ì„¬ìœ¼ë¡œ ìˆ¨ì–´ í‰ìƒ ë‚˜ì˜¤ì§€ ì•ŠëŠ”ë‹¤.", next: "end_coward" },
                    { text: "ê±°ë€ì˜ ì‹ í•˜ê°€ ë˜ê² ë‹¤ê³  ë§¹ì„¸í•œë‹¤.", next: "end_colony_khitan" }
                ]
            },

            goryeo_yoongwan: {
                type: 'history', badge: 'badge-goryeo', era: "ê³ ë ¤", year: "1107ë…„",
                title: "ìœ¤ê´€ê³¼ ë³„ë¬´ë°˜",
                desc: "ë¶ë°©ì˜ ì—¬ì§„ì¡±ì´ ì„±ì¥í•˜ì—¬ ê³ ë ¤ì˜ êµ­ê²½ì„ ìœ„í˜‘í•˜ê³  ìˆìŠµë‹ˆë‹¤. ê¸°ë³‘ ìœ„ì£¼ì˜ ì—¬ì§„ì¡±ì„ ìƒëŒ€í•˜ê¸° ìœ„í•´ ìœ¤ê´€ ì¥êµ°ì€ ë³´ë³‘ ì¤‘ì‹¬ì˜ ê³ ë ¤êµ°ì„ ê°œí¸í•´ì•¼ í•œë‹¤ê³  ì£¼ì¥í•©ë‹ˆë‹¤.",
                progress: 43, icon: "ğŸ›¡ï¸",
                choices: [
                    { text: "ì‹ ê¸°êµ°(ê¸°ë³‘), ì‹ ë³´êµ°(ë³´ë³‘), í•­ë§ˆêµ°(ìŠ¹ë³‘)ìœ¼ë¡œ êµ¬ì„±ëœ íŠ¹ìˆ˜ ë¶€ëŒ€ 'ë³„ë¬´ë°˜'ì„ ì¡°ì§í•˜ì—¬ ì—¬ì§„ì„ ì •ë²Œí•˜ê³  9ì„±ì„ ìŒ“ëŠ”ë‹¤.", next: "goryeo_sambyeolcho" },
                    { text: "í‰í™”ê°€ ìµœìš°ì„ ì´ë‹¤. ì—¬ì§„ì¡±ì—ê²Œ ê³¡ì‹ì„ ë°”ì¹˜ê³  ë‹¬ëœë‹¤.", next: "end_vassal_jurchen" },
                    { text: "ê³µê²©í•  ëŠ¥ë ¥ì´ ë¶€ì¡±í•˜ë‹ˆ ë°©ì–´ë§Œ í•œë‹¤.", next: "crisis_jurchen_plunder" }
                ]
            },
            crisis_jurchen_plunder: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ì—¬ì§„ì˜ ìœ ë¦°",
                desc: "ë°©ì–´ë§Œ í•˜ëŠ” ì†Œê·¹ì ì¸ íƒœë„ë¥¼ ë³´ì´ì ì—¬ì§„ì¡±ì€ ê³ ë ¤ë¥¼ ì–•ì¡ì•„ë³´ê³  êµ­ê²½ì„ ë„˜ì–´ì™€ ë§ˆì„ì„ ë¶ˆíƒœìš°ê³  ì•½íƒˆí•©ë‹ˆë‹¤. ë°±ì„±ë“¤ì˜ ì›ì„±ì´ í•˜ëŠ˜ì„ ì°Œë¦…ë‹ˆë‹¤.",
                choices: [
                    { text: "ì§€ê¸ˆì´ë¼ë„ ë³„ë¬´ë°˜ì„ ì¡°ì§í•˜ì—¬ ê°•ë ¥í•œ í† ë²Œì— ë‚˜ì„ ë‹¤.", next: "goryeo_sambyeolcho" }, // íšŒë³µ
                    { text: "ì—¬ì§„ì¡±ì—ê²Œ ë•…ì„ ë–¼ì–´ì£¼ê³  í‰í™”ë¥¼ ìš”êµ¬í•œë‹¤.", next: "end_vassal_jurchen" },
                    { text: "ë„ë§ì¹œë‹¤.", next: "end_coward" }
                ]
            },

            goryeo_sambyeolcho: {
                type: 'history', badge: 'badge-goryeo', era: "ê³ ë ¤", year: "1231ë…„~",
                title: "ëŒ€ëª½ í•­ìŸ",
                desc: "ì„¸ê³„ ìµœê°•ì˜ ëª½ê³¨ ì œêµ­ì´ ì¹¨ëµí–ˆìŠµë‹ˆë‹¤. ìœ¡ì§€ì—ì„œëŠ” ìŠ¹ì‚°ì´ ì—†ì–´ ì¡°ì •ì€ ê°•í™”ë„ë¡œ ì²œë„í–ˆìŠµë‹ˆë‹¤. ë°±ì„±ë“¤ì€ ìœ ë¦°ë‹¹í•˜ê³  ìˆìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” ì–´ë–»ê²Œ ì €í•­í•´ì•¼ í•©ë‹ˆê¹Œ?",
                progress: 46, icon: "â˜¸ï¸",
                choices: [
                    { text: "ë¶€ì²˜ì˜ í˜ìœ¼ë¡œ êµ­ë‚œì„ ê·¹ë³µí•˜ê³ ì íŒ”ë§ŒëŒ€ì¥ê²½ì„ ë§Œë“¤ê³ , ì‚¼ë³„ì´ˆëŠ” ëê¹Œì§€ í•­ì „í•œë‹¤.", next: "goryeo_gongmin", minigame: 'defense_game' },
                    { text: "ëª½ê³¨ì— ì¦‰ì‹œ í•­ë³µí•˜ê³  ê·¸ë“¤ì˜ í’ìŠµ(ë³€ë°œ, í˜¸ë³µ)ì„ ëª¨ë‘ ë°›ì•„ë“¤ì¸ë‹¤.", next: "crisis_mongol_culture" },
                    { text: "ëª½ê³¨êµ°ì´ ê³ ë ¤ì—ê²Œ ëª½ê³¨ì„ ìœ„í•´ ì¼ë³¸ì„ ì •ë²Œí•˜ì—¬ ë°”ì¹  ê²ƒì„ ìš”êµ¬í•œë‹¤. ëª½ê³¨ì´ ì›í•˜ëŠ” ê²ƒì„ ë“¤ì–´ì£¼ê¸° ìœ„í•´ ì¼ë³¸ì„ ì •ë²Œí•˜ëŸ¬ ë– ë‚œë‹¤.", next: "crisis_japan_invasion" }
                ]
            },
            crisis_mongol_culture: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ì •ì²´ì„± ìƒì‹¤",
                desc: "ëª¨ë‘ê°€ ëª½ê³¨ì‹ ë¨¸ë¦¬ë¥¼ í•˜ê³  ëª½ê³¨ ì˜·ì„ ì…ìœ¼ë©° ê³ ë ¤ì˜ ê³ ìœ í•œ ë¬¸í™”ê°€ ì‚¬ë¼ì§ˆ ìœ„ê¸°ì…ë‹ˆë‹¤. ë‚˜ë¼ëŠ” ë‚¨ì•˜ìœ¼ë‚˜ ì •ì‹ ì€ ì‹ë¯¼ì§€ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "ìì£¼ì„±ì„ ë˜ì°¾ê¸° ìœ„í•œ ì›€ì§ì„(ì‚¼ë³„ì´ˆ ë“±)ì„ ì§€ì›í•˜ê³  ì „í†µì„ ì§€í‚¨ë‹¤.", next: "goryeo_gongmin" }, // íšŒë³µ
                    { text: "ëª½ê³¨ì€ ê°•í•œë‚˜ë¼ì´ë‹ˆ ë¶€ë„ëŸ¬ìš¸ ê²ƒ ì—†ë‹¤. ì™„ì „íˆ ëª½ê³¨ì¸ì´ ëœë‹¤.", next: "end_culture_lost" },
                    { text: "ì›ë‚˜ë¼ í™©ì œì˜ ëˆˆì— ë“¤ì–´ ì¶œì„¸í•˜ëŠ” ë°ë§Œ ì‹ ê²½ ì“´ë‹¤.", next: "end_traitor" }
                ]
            },
            crisis_japan_invasion: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: íƒœí’ê³¼ ì¹¨ëª°",
                desc: "ëª½ê³¨ì—ê²Œ ìˆœì¢…í•˜ë©° ë¬´ë¦¬í•˜ê²Œ ì¼ë³¸ ì›ì •ì— ë‚˜ì„°ë‹¤ê°€ íƒœí’(ê°€ë¯¸ì¹´ì œ)ì„ ë§Œë‚˜ ë°°ê°€ ëª¨ë‘ ì¹¨ëª°í–ˆìŠµë‹ˆë‹¤. ê³ ë ¤ì˜ êµ­ë ¥ë§Œ ì†Œì§„ë˜ì—ˆìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "ì‚´ì•„ë‚¨ì€ ë³‘ë ¥ì„ ìˆ˜ìŠµí•˜ì—¬ ë³¸êµ­ìœ¼ë¡œ ëŒì•„ì™€ ë‚´ì‹¤ì„ ë‹¤ì§„ë‹¤.", next: "goryeo_gongmin" }, // íšŒë³µ
                    { text: "ì¼ë³¸ì— ìƒë¥™í•˜ì—¬ ì£½ì„ ë•Œê¹Œì§€ ì‹¸ìš´ë‹¤.", next: "end_bad_tactic" },
                    { text: "ë°”ë‹¤ì— ëª¸ì„ ë˜ì§„ë‹¤.", next: "end_leaderless" }
                ]
            },

            goryeo_gongmin: {
                type: 'history', badge: 'badge-goryeo', era: "ê³ ë ¤ ë§", year: "1351ë…„",
                title: "ê³µë¯¼ì™•ì˜ ìì£¼ ê°œí˜",
                desc: "ì›ë‚˜ë¼(ëª½ê³¨)ì˜ ì„¸ë ¥ì´ ì•½í•´ì§„ í‹ˆì„ íƒ€ ê³µë¯¼ì™•ì€ ê³ ë ¤ì˜ ìì£¼ì„±ì„ ë˜ì°¾ìœ¼ë ¤ í•©ë‹ˆë‹¤. ì¹œì›íŒŒ(ì›ë‚˜ë¼ë‘ ì¹œí•˜ê²Œ ì§€ë‚´ê³ ì í•˜ëŠ” ì‹ í•˜ë“¤) ê¶Œë¬¸ì„¸ì¡±ë“¤ì´ ë°˜ë°œí•˜ê³  ìˆìŠµë‹ˆë‹¤.",
                progress: 50, icon: "ğŸ‘‘",
                choices: [
                    { text: "ì¹œì› ì„¸ë ¥(ì›ë‚˜ë¼ë‘ ì¹œí•˜ê²Œ ì§€ë‚´ìê³  ì£¼ì¥í•˜ëŠ” ì„¸ë ¥)ì„ ìˆ™ì²­í•˜ê³ , ë¹¼ì•—ê¸´ ì˜í† ë¥¼ ë˜ì°¾ëŠ”ë‹¤.", next: "joseon_wihwado" },
                    { text: "ì•„ì§ ì›ë‚˜ë¼ê°€ ë¬´ì„­ë‹¤. ì˜ë¦¬ë¥¼ ì§€í‚¤ë©° ê³„ì† ê³µë…€ë¥¼ ë°”ì¹œë‹¤.", next: "end_yuan_province" },
                    { text: "ìŠ¹ë ¤ ì‹ ëˆì—ê²Œ ì™•ìœ„ë¥¼ ë¬¼ë ¤ì£¼ê³  ì¡°ì •ì„ ë– ë‚œë‹¤.", next: "crisis_monk_power" }
                ]
            },
            crisis_monk_power: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ìš”ìŠ¹ì˜ ì „íš¡",
                desc: "ì‹ ëˆì´ ì´ˆê¸°ì—ëŠ” ê°œí˜ì„ ì˜í•˜ëŠ”ê°€ ì‹¶ë”ë‹ˆ, ì ì  ê¶Œë ¥ì„ í•¨ë¶€ë¡œ ì‚¬ìš©í•˜ì—¬ ì¡°ì •ì´ í˜¼ë€ì— ë¹ ì¡ŒìŠµë‹ˆë‹¤. ë°±ì„±ë“¤ì˜ ë°˜ë°œì´ ê·¹ì‹¬í•©ë‹ˆë‹¤.",
                choices: [
                    { text: "ì‹ ëˆì„ ì œê±°í•˜ê³  ë‹¤ì‹œ ì™•ì´ ë˜ì–´ ì§ì ‘ ê°œí˜ì„ ì£¼ë„í•œë‹¤.", next: "joseon_wihwado" }, // íšŒë³µ
                    { text: "ê°œí˜ì„ ëª¨ë‘ ì·¨ì†Œí•˜ê³  ë‹¤ì‹œ ì›ë‚˜ë¼ì— ê¸°ëŒ„ë‹¤.", next: "end_yuan_province" },
                    { text: "ì •ì¹˜ë¥¼ í¬ê¸°í•˜ê³  ê·¸ë¦¼(ì²œì‚°ëŒ€ë µë„)ë§Œ ê·¸ë¦°ë‹¤.", next: "end_weakness" }
                ]
            },

            // ==========================================
            // 5. ì¡°ì„  ì‹œëŒ€
            // ==========================================
            joseon_wihwado: {
                type: 'history', badge: 'badge-joseon', era: "ì—¬ë§ì„ ì´ˆ", year: "1388ë…„",
                title: "ìœ„í™”ë„ íšŒêµ°",
                desc: "ëª…ë‚˜ë¼ê°€ ìš”ë™ ì •ë²Œì„ ìš”êµ¬í•˜ì ìµœì˜ ì¥êµ°ì€ ì´ì„±ê³„ë¥¼ ë³´ëƒˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì¥ë§ˆì² ì´ë¼ í™œì˜ ì•„êµê°€ ë…¹ê³  ë³‘ì‚¬ë“¤ì´ ì§€ì³¤ìŠµë‹ˆë‹¤. ì••ë¡ê°• ìœ„í™”ë„ì—ì„œ ì´ì„±ê³„ëŠ” ìš´ëª…ì ì¸ ê²°ì •ì„ ë‚´ë ¤ì•¼ í•©ë‹ˆë‹¤.",
                progress: 55, icon: "ğŸ´",
                choices: [
                    { text: "4ê°€ì§€ ë¶ˆê°€ë¡ ì„ ë‚´ì„¸ì›Œ êµ°ëŒ€ë¥¼ ëŒë ¤(íšŒêµ°) ì •ê¶Œì„ ì¡ëŠ”ë‹¤.", next: "joseon_sejong_science" },
                    { text: "ì™•ëª…ì— ë”°ë¼ì•¼ í•˜ë¯€ë¡œ êµ°ì‚¬ë“¤ì„ ì˜ ë‹¬ë˜ ìš”ë™ì„ ê³µê²©í•˜ê³  ëª…ë‚˜ë¼ì™€ ì „ë©´ì „ì„ ë²Œì¸ë‹¤.", next: "end_ming_war" },
                    { text: "êµ°ëŒ€ë¥¼ í•´ì‚°í•˜ê³  ê³ í–¥ìœ¼ë¡œ ëŒì•„ê°€ ì¡°ìš©íˆ ë†ì‚¬ë¥¼ ì§“ëŠ”ë‹¤.", next: "end_farmer" }
                ]
            },

            // [ì¶”ê°€] ì„¸ì¢…ëŒ€ì™• ê³¼í•™ ê¸°ìˆ  (ì¥ì˜ì‹¤)
            joseon_sejong_science: {
                type: 'history', badge: 'badge-joseon', era: "ì¡°ì„  ì´ˆê¸°", year: "1434ë…„",
                title: "ì„¸ì¢…ëŒ€ì™•ê³¼ ê³¼í•™ ê¸°ìˆ ",
                desc: "ì„¸ì¢…ëŒ€ì™•ì€ ë°±ì„±ë“¤ì˜ ì‚¶ì„ ìœ¤íƒí•˜ê²Œ í•˜ê¸° ìœ„í•´ ê³¼í•™ ê¸°ìˆ ì—ë„ í° ê´€ì‹¬ì„ ê¸°ìš¸ì…ë‹ˆë‹¤. ë…¸ë¹„ ì¶œì‹ ì¸ ì¥ì˜ì‹¤ì˜ ë›°ì–´ë‚œ ì¬ì£¼ë¥¼ ì•Œì•„ë³¸ ì™•ì€ ì‹ í•˜ë“¤ì˜ ë°˜ëŒ€ë¥¼ ë¬´ë¦…ì“°ê³  ê·¸ë¥¼ ë“±ìš©í•˜ë ¤ í•©ë‹ˆë‹¤.",
                progress: 58, icon: "ğŸ”­",
                choices: [
                    { text: "ì‹ ë¶„ë³´ë‹¤ ëŠ¥ë ¥ì´ ìš°ì„ ì´ë‹¤. ì¥ì˜ì‹¤ì„ ë“±ìš©í•˜ì—¬ ìê²©ë£¨, ì¸¡ìš°ê¸° ë“±ì„ ë§Œë“¤ê²Œ í•œë‹¤.", next: "joseon_sejong", unlock: 'great_scientist' },
                    { text: "ë²•ë„ëŠ” ì§€ì¼œì ¸ì•¼ í•œë‹¤. ì²œë¯¼ì„ ê´€ì§ì— ì•‰í ìˆ˜ ì—†ë‹¤.", next: "crisis_no_science" },
                    { text: "ì§ì ‘ ê³¼í•™ ê¸°ìˆ ì„ ê°œë°œí•˜ê¸°ëŠ” ì–´ë ¤ìš°ë‹ˆ ëª…ë‚˜ë¼ì˜ ê³¼í•™ ê¸°ìˆ ì„ ì˜ ë°›ì•„ë“¤ì´ê¸°ë¡œ í•œë‹¤.", next: "end_culture_lost" }
                ]
            },
            crisis_no_science: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ì •ì²´ëœ ê¸°ìˆ ",
                desc: "ê³¼í•™ ê¸°ìˆ  ë°œì „ì´ ë”ëŒì ¸ ë†ì—… ìƒì‚°ëŸ‰ì´ ëŠ˜ì§€ ì•Šê³ , ê°€ë­„ê³¼ í™ìˆ˜ì— ëŒ€ë¹„í•˜ì§€ ëª»í•´ ë°±ì„±ë“¤ì´ ê³ í†µë°›ìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "ì§€ê¸ˆì´ë¼ë„ ì¸ì¬ë¥¼ ë„ë¦¬ ì°¾ì•„ ê³¼í•™ ê¸°êµ¬ë¥¼ ê°œë°œí•œë‹¤.", next: "joseon_sejong" }, // íšŒë³µ
                    { text: "í•˜ëŠ˜ì˜ ëœ»ì´ë¼ ì—¬ê¸°ê³  ìƒí™©ì„ ë‚˜ì•„ì§€ê²Œ í•˜ê¸° ìœ„í•´ ë¹„ë¥¼ ë‚´ë¦¬ê²Œ í•´ë‹¬ë¼ê³  ìš”êµ¬í•˜ëŠ” ì œì‚¬ì¸ ê¸°ìš°ì œë¥¼ ì§€ë‚¸ë‹¤.", next: "end_weakness" },
                    { text: "ê³¼í•™ ê¸°ìˆ  ë°œì „ì´ ì‹œê¸‰í•˜ë‹ˆ ë” ì„¸ê¸ˆì„ ê±·ëŠ”ë‹¤.", next: "end_tyrant" }
                ]
            },

            joseon_sejong: {
                type: 'history', badge: 'badge-joseon', era: "ì¡°ì„  ì´ˆê¸°", year: "1443ë…„",
                title: "ì„¸ì¢…ëŒ€ì™•ì˜ ì• ë¯¼ì •ì‹ ",
                desc: "ì¡°ì„ ì˜ í™©ê¸ˆê¸°ì…ë‹ˆë‹¤. í•˜ì§€ë§Œ ë°±ì„±ë“¤ì€ ì–´ë ¤ìš´ í•œìë¥¼ ëª°ë¼ ì–µìš¸í•œ ì¼ì„ ë‹¹í•´ë„ í˜¸ì†Œí•˜ì§€ ëª»í•©ë‹ˆë‹¤. ì„¸ì¢…ì€ ëˆ„êµ¬ë‚˜ ì‰½ê²Œ ë°°ìš°ëŠ” ê¸€ìë¥¼ ë§Œë“¤ê³  ì‹¶ì§€ë§Œ, ìµœë§Œë¦¬ ë“± ì‹ í•˜ë“¤ì€ ì¤‘êµ­ì„ ê±°ìŠ¤ë¥´ëŠ” ì¼ì´ë¼ë©° ë°˜ëŒ€í•©ë‹ˆë‹¤.",
                progress: 60, icon: "ğŸ“–",
                choices: [
                    { text: "ë°±ì„±ì„ ê°€ë¥´ì¹˜ëŠ” ë°”ë¥¸ ì†Œë¦¬, 'í›ˆë¯¼ì •ìŒ'ì„ ì°½ì œí•˜ê³  ë°˜í¬í•œë‹¤.", next: "joseon_imjin" },
                    { text: "ì¤‘êµ­ì„ ì„¬ê¸°ëŠ” ì‚¬ëŒ€ì£¼ì˜ì— ì…ê°í•´ í•œê¸€ ì°½ì œë¥¼ í¬ê¸°í•œë‹¤.", next: "crisis_no_hangul" },
                    { text: "í•œìë¥¼ ë” ì–´ë µê²Œ ë§Œë“¤ì–´ ì–‘ë°˜ë“¤ë§Œì˜ ì§€ì‹ì„ ê°•í™”í•œë‹¤.", next: "end_elite_society" }
                ]
            },
            crisis_no_hangul: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ê¹Œë§‰ëˆˆ ë°±ì„±",
                desc: "ì‰¬ìš´ ê¸€ìê°€ ì—†ì–´ ë°±ì„±ë“¤ì€ ì „ì—¼ë³‘ ì˜ˆë°©ë²•ë„, ë†ì‚¬ë²•ë„ ì½ì§€ ëª»í•´ ì£½ì–´ê°‘ë‹ˆë‹¤. ì§€ì‹ì€ ì–‘ë°˜ë“¤ì˜ ì „ìœ ë¬¼ì´ ë˜ì–´ ì‚¬íšŒ ë°œì „ì´ ì •ì²´ë˜ì—ˆìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "ì§€ê¸ˆì´ë¼ë„ í•œê¸€ì„ ë§Œë“¤ê³  ë³´ê¸‰í•œë‹¤.", next: "joseon_imjin" }, // íšŒë³µ
                    { text: "ë°±ì„±ì´ ë˜‘ë˜‘í•´ì§€ë©´ ë‹¤ë£¨ê¸° í˜ë“¤ë‹¤. ë” ì‰½ê²Œ ë‚˜ë¼ë¥¼ ë‹¤ìŠ¤ë¦¬ê¸° ìœ„í•´ ê·¸ëŒ€ë¡œ ë‘”ë‹¤", next: "end_elite_society" },
                    { text: "ì¤‘êµ­ì–´ë¥¼ ê³µìš©ì–´ë¡œ ì§€ì •í•œë‹¤.", next: "end_culture_lost" }
                ]
            },

            joseon_imjin: {
                type: 'history', badge: 'badge-joseon', era: "ì¡°ì„  ì¤‘ê¸°", year: "1592ë…„",
                title: "ì„ì§„ì™œë€",
                desc: "ì¼ë³¸ì´ ëŒ€ê·œëª¨ë¡œ ì¹¨ëµí–ˆìŠµë‹ˆë‹¤. ë¶€ì‚°ì§„ê³¼ ë™ë˜ì„±ì´ ìˆœì‹ê°„ì— í•¨ë½ë˜ê³  ì¡°ì„ ì˜ ì™•, ì„ ì¡°ëŠ” í•œì–‘ì„ ë²„ë¦¬ê³  í”¼ë€ì„ ë– ë‚¬ìŠµë‹ˆë‹¤. ë‚˜ë¼ê°€ ë§í•˜ê¸° ì§ì „, ë°”ë‹¤ë¥¼ ì§€í‚¤ëŠ” ì´ìˆœì‹  ì¥êµ°ì€ ê²°ë‹¨ì„ ë‚´ë ¤ì•¼ í•©ë‹ˆë‹¤.",
                progress: 65, icon: "ğŸ¢",
                choices: [
                    { text: "í•œì‚°ë„ ì•ë°”ë‹¤ë¡œ ì ì„ ìœ ì¸í•´ í•™ìµì§„ì„ í¼ì³ ê¶¤ë©¸ì‹œí‚¤ê³  ë³´ê¸‰ë¡œë¥¼ ëŠëŠ”ë‹¤.", next: "joseon_gwanghae" },
                    { text: "ë°”ë‹¤ë¥¼ ë²„ë¦¬ê³  ìœ¡ì§€ë¡œ ì˜¬ë¼ê°€ ì™•ì„ í˜¸ìœ„í•œë‹¤.", next: "crisis_lost_sea" },
                    { text: "ì¼ë³¸ ìˆ˜êµ°ê³¼ ì •ë©´ ìŠ¹ë¶€í•˜ì—¬ì•¼ ê¸°ì„¸ë¥¼ êº¾ì„ ìˆ˜ ìˆë‹¤ ë¬´ì¡°ê±´ ëŒê²©í•˜ì—¬ ê³µê²©í•œë‹¤.", next: "end_bad_tactic" }
                ]
            },
            crisis_lost_sea: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ë°”ë‹¤ë¥¼ ë‚´ì£¼ë‹¤",
                desc: "ë°”ë‹¤ì—ì„œ í˜ì„ ìƒì ì¼ë³¸êµ°ì€ ì„œí•´ë¥¼ í†µí•´ í•œì–‘ìœ¼ë¡œ ì‹ëŸ‰ê³¼ ë¬´ê¸°ë¥¼ í‘í‘ ì‹¤ì–´ ë‚˜ë¦…ë‹ˆë‹¤. ì¡°ì„ êµ°ì€ êµ¶ì£¼ë¦¬ê³  ì¼ë³¸êµ°ì€ ë°°ë¶ˆë¦¬ ë¨¹ìœ¼ë©° ì§„ê²©í•©ë‹ˆë‹¤.",
                choices: [
                    { text: "ìˆ˜êµ°ì„ ì¬ê±´í•˜ì—¬ ë°”ë‹¤ì—ì„œ ë‹¤ì‹œ ìŠ¹ë¦¬ë¥¼ ê±°ë‘ì–´ ì „ì„¸ë¥¼ ë’¤ì§‘ëŠ”ë‹¤.", next: "joseon_gwanghae" }, // íšŒë³µ
                    { text: "ì‚°ì†ìœ¼ë¡œ ìˆ¨ì–´ ì†Œê·œëª¨ ì˜ë³‘ í™œë™ë§Œ í•œë‹¤.", next: "end_bad_tactic" },
                    { text: "ì¼ë³¸ì— í•­ë³µí•œë‹¤.", next: "end_traitor" }
                ]
            },

            joseon_gwanghae: {
                type: 'history', badge: 'badge-joseon', era: "ì¡°ì„  ì¤‘ê¸°", year: "1610ë…„",
                title: "ê´‘í•´êµ°ì˜ ì¤‘ë¦½ ì™¸êµ",
                desc: "ì„ì§„ì™œë€ìœ¼ë¡œ í”¼íí•´ì§„ ì¡°ì„ . ë¶ìª½ì—ì„œëŠ” ì—¬ì§„ì¡±ì´ ì„¸ìš´ í›„ê¸ˆ(ì²­)ì´ ê°•ì„±í•´ì§€ê³ , ì‡ í‡´í•˜ëŠ” ëª…ë‚˜ë¼ëŠ” ì¡°ì„ ì— êµ°ëŒ€ë¥¼ ë³´ë‚´ë‹¬ë¼ê³  ìš”êµ¬í•©ë‹ˆë‹¤. ëª…ë¶„ê³¼ ì‹¤ë¦¬ ì‚¬ì´ì—ì„œ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤.",
                progress: 68, icon: "âš–ï¸",
                choices: [
                    { text: "ëª…ì— êµ°ëŒ€ë¥¼ ë³´ë‚´ë˜, í›„ê¸ˆì—ëŠ” ì‹¸ìš¸ ëœ»ì´ ì—†ìŒì„ ì•Œë¦¬ëŠ” ì¤‘ë¦½ ì™¸êµë¥¼ í¼ì¹œë‹¤.", next: "joseon_manchu" },
                    { text: "ì„ì§„ì™œë€ ë•Œ ë„ì™€ì¤€ ëª…ë‚˜ë¼ë¥¼ ìœ„í•´ ì „ë ¥ì„ ë‹¤í•´ í›„ê¸ˆê³¼ ì‹¸ìš´ë‹¤.", next: "crisis_manchu_invasion_early" },
                    { text: "ë– ì˜¤ë¥´ëŠ” íƒœì–‘ì¸ í›„ê¸ˆê³¼ ì†ì¡ê³  ëª…ë‚˜ë¼ë¥¼ ê³µê²©í•œë‹¤.", next: "crisis_ming_revenge" }
                ]
            },
            crisis_manchu_invasion_early: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: í›„ê¸ˆì˜ ë¶„ë…¸",
                desc: "í›„ê¸ˆì´ ì¡°ì„ ì„ ì ìœ¼ë¡œ ê°„ì£¼í•˜ê³  ëŒ€êµ°ì„ ì´ëŒê³  ì³ë“¤ì–´ì™”ìŠµë‹ˆë‹¤. ì „ìŸì˜ ìƒì²˜ê°€ ì•„ë¬¼ê¸°ë„ ì „ì— ë˜ ì „ìŸì…ë‹ˆë‹¤. ì¤€ë¹„ê°€ ì•ˆ ëœ ì¡°ì„ êµ°ì€ ì†ìˆ˜ë¬´ì±…ì…ë‹ˆë‹¤.",
                choices: [
                    { text: "ê°•í™”ë„ë¡œ í”¼ì‹ í•˜ì—¬ í•­ì „í•˜ë©° í›—ë‚ ì„ ë„ëª¨í•œë‹¤.", next: "joseon_manchu" }, // íšŒë³µ
                    { text: "ë¬´ì¡°ê±´ í•­ë³µí•œë‹¤.", next: "end_joseon_fall" },
                    { text: "ëª…ë‚˜ë¼ë¡œ ë„ë§ì¹œë‹¤.", next: "end_coward" }
                ]
            },
            crisis_ming_revenge: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ëª…ì˜ ë³´ë³µ",
                desc: "ë¶€ëª¨ì˜ ë‚˜ë¼ë¼ ì„¬ê¸°ë˜ ëª…ì´ ë°°ì‹ ê°ì„ ëŠë¼ê³  ê²½ì œ ì œì¬ë¥¼ ê°€í•©ë‹ˆë‹¤. ì‚¬ëŒ€ë¶€ë“¤ì€ 'íŒ¨ë¥œ'ì´ë¼ë©° ì™•ì„ ë¹„ë‚œí•˜ê³  ë°˜ë€ì„ ê¾€í•©ë‹ˆë‹¤.",
                choices: [
                    { text: "ì•ìœ¼ë¡œ ëª…ë‚˜ë¼ë¥¼ ì¡´ì¤‘í•  ê²ƒì´ë¼ í•´ëª…í•˜ê³  ì‹¤ë¦¬ë¥¼ ì±™ê¸´ë‹¤.", next: "joseon_manchu" }, // íšŒë³µ
                    { text: "í›„ê¸ˆ í¸ì„ ë“œëŠ” ê²ƒì´ ë‚«ë‹¤ê³  ê³„ì† ì£¼ì¥í•˜ë©° ë‚˜ì˜ ì˜ê²¬ì„ êµ½íˆì§€ ì•ŠëŠ”ë‹¤.", next: "joseon_manchu" }, // ì—­ì‚¬ì  íë¦„ìœ¼ë¡œ í•©ë¥˜
                    { text: "í›„ê¸ˆì˜ ì†êµ­ì´ ë˜ì–´ í›„ê¸ˆì˜ ë³´í˜¸ë¥¼ ë°›ëŠ”ë‹¤.", next: "end_traitor" }
                ]
            },

            joseon_manchu: {
                type: 'history', badge: 'badge-joseon', era: "ì¡°ì„  ì¤‘ê¸°", year: "1636ë…„",
                title: "ë³‘ìí˜¸ë€",
                desc: "ì¸ì¡°ë°˜ì •ìœ¼ë¡œ ê´‘í•´êµ°ì´ ì«“ê²¨ë‚˜ê³ , ì¹œëª…ë°°ê¸ˆ(ëª…ë‚˜ë¼ì™€ ì¹œí•˜ê²Œ ì§€ë‚´ê³  í›„ê¸ˆê³¼ ê°€ê¹Œì´ í•˜ì§€ ì•ŠëŠ”) ì •ì±…ì„ ì“°ì ì²­ë‚˜ë¼(í›„ê¸ˆ)ê°€ ì³ë“¤ì–´ì™”ìŠµë‹ˆë‹¤. ì¡°ì„ ì˜ ì™•, ì¸ì¡°ëŠ” ë‚¨í•œì‚°ì„±ì— ê³ ë¦½ë˜ì–´ ì¶¥ê³  ë°°ê³ í”ˆ ê²¨ìš¸ì„ ë³´ë‚´ê³  ìˆìŠµë‹ˆë‹¤. ê°•í™”ë„ë§ˆì € í•¨ë½ë˜ì—ˆìŠµë‹ˆë‹¤.",
                progress: 70, icon: "â„ï¸",
                choices: [
                    { text: "ì¹˜ìš•ìŠ¤ëŸ½ì§€ë§Œ í•­ë³µí•˜ì—¬ ì™•ì¡°ì™€ ë°±ì„±ì„ ë³´ì¡´í•œë‹¤.", next: "joseon_yeongjo" },
                    { text: "ì˜¤ë‘ìºì—ê²Œ ë¬´ë¦ ê¿‡ì„ ìˆ˜ ì—†ë‹¤. ëê¹Œì§€ ì‹¸ìš´ë‹¤.", next: "end_joseon_fall" },
                    { text: "ì‹¸ìš°ë‹¤ ì£½ëŠ” ê²ƒì€ ë‘ë ¤ìš°ë‹ˆ ìê²°í•œë‹¤.", next: "end_leaderless" }
                ]
            },

            joseon_yeongjo: {
                type: 'history', badge: 'badge-joseon', era: "ì¡°ì„  í›„ê¸°", year: "18ì„¸ê¸°",
                title: "íƒ•í‰ì±…ê³¼ ì¡°ì„ ì˜ ë¥´ë„¤ìƒìŠ¤",
                desc: "ì‹ í•˜ë“¤ì´ ë™ì¸, ì„œì¸, ë…¸ë¡ , ì†Œë¡ ìœ¼ë¡œ ë‚˜ë‰˜ì–´ ê¶Œë ¥ ë‹¤íˆ¼(ë¶•ë‹¹ ì •ì¹˜)ì„ í•˜ëŠë¼ ë¯¼ìƒì€ ë’·ì „ì…ë‹ˆë‹¤. ì˜ì¡°ì™€ ì •ì¡°ëŠ” ì´ ê³ ì§ˆì ì¸ ë¬¸ì œë¥¼ ê³ ì¹˜ë ¤ í•©ë‹ˆë‹¤.",
                progress: 75, icon: "ğŸ›ï¸",
                choices: [
                    { text: "ì–´ëŠ í•œ ìª½ì— ì¹˜ìš°ì¹˜ì§€ ì•Šê³  ì¸ì¬ë¥¼ ê³ ë£¨ ë“±ìš©í•˜ëŠ” íƒ•í‰ì±…ì„ ì“´ë‹¤.", next: "joseon_jeongjo", minigame: 'faction_balance_game' },
                    { text: "ë‚˜ë¥¼ ì§€ì§€í•˜ëŠ” íŠ¹ì • ë¶•ë‹¹ì˜ í¸ë§Œ ë“ ë‹¤.", next: "crisis_faction" },
                    { text: "ê³¨ì¹˜ ì•„í”ˆ ì •ì¹˜ëŠ” ì‹ í•˜ë“¤ì—ê²Œ ë§¡ê¸°ê³  í¬ê¸°í•œë‹¤.", next: "crisis_weak_governance" }
                ]
            },
            crisis_faction: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ì„¸ë„ ì •ì¹˜ì˜ ì„œë§‰",
                desc: "í•œ ì •íŒŒê°€ ê¶Œë ¥ì„ ë…ì í•˜ì ê²¬ì œ ì¥ì¹˜ê°€ ì‚¬ë¼ì¡ŒìŠµë‹ˆë‹¤. ë§¤ê´€ë§¤ì§ì´ ì„±í–‰í•˜ê³  ì§€ë°© ê´€ë¦¬ë“¤ì´ ë§ˆìŒëŒ€ë¡œ í–‰ë™í•˜ì—¬ ë°±ì„±ë“¤ì˜ ìƒí™œì´ í¬ê²Œ ì–´ë ¤ì›Œì§‘ë‹ˆë‹¤.",
                choices: [
                    { text: "ê·œì¥ê°ì„ ì„¤ì¹˜í•˜ì—¬ ì Šì€ ì¸ì¬ë¥¼ í‚¤ìš°ê³  ë¶•ë‹¹ì˜ ê· í˜•ì„ ë§ì¶˜ë‹¤.", next: "joseon_jeongjo" }, // íšŒë³µ
                    { text: "ë°±ì„±ë“¤ì˜ ê³ í˜ˆì„ ì§œë‚´ì–´ ì‚¬ì¹˜í–¥ë½ì„ ì¦ê¸´ë‹¤.", next: "end_tyrant" },
                    { text: "ë°˜ëŒ€íŒŒë¥¼ ëª¨ë‘ ê·€ì–‘ ë³´ë‚¸ë‹¤.", next: "crisis_faction" } // ë£¨í”„ì§€ë§Œ ì„ íƒì§€ ì œê³µ
                ]
            },
            crisis_weak_governance: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ë¯¼ë€ì˜ ì‹œëŒ€",
                desc: "ë‚˜ë¼ê°€ ê¸°ëŠ¥ì„ ë©ˆì¶”ì ì°¸ë‹¤ëª»í•œ ë†ë¯¼ë“¤ì´ ì£½ì°½ì„ ë“¤ê³  ì¼ì–´ë‚¬ìŠµë‹ˆë‹¤. ì—¬ëŸ¬ ë†ë¯¼ë“¤ì´ ë“¤ê³  ì¼ì–´ë‚˜ ì „êµ­ì´ ë¶ˆíƒ€ì˜¤ë¦…ë‹ˆë‹¤.",
                choices: [
                    { text: "ë‚˜ë¼ì˜ í˜¼ë€ì„ ë°”ë¡œì¡ê³  ì•”í–‰ì–´ì‚¬ë¥¼ íŒŒê²¬í•´ ë¯¼ìƒì„ ì±™ê¸´ë‹¤.", next: "joseon_jeongjo" }, // íšŒë³µ
                    { text: "êµ°ëŒ€ë¥¼ ë³´ë‚´ ë¬´ìë¹„í•˜ê²Œ ì§„ì••í•˜ì—¬ ë‚˜ë¼ë¥¼ ì•ˆì •ì‹œí‚¨ë‹¤.", next: "end_tyrant" },
                    { text: "ì™•ê¶ ë¬¸ì„ ê±¸ì–´ ì ê·¸ê³  ëª¨ë¥¸ ì²™í•œë‹¤.", next: "end_joseon_fall" }
                ]
            },

            // [ì¶”ê°€ ì‹œë‚˜ë¦¬ì˜¤ 3: ì •ì¡°]
            joseon_jeongjo: {
                type: 'history', badge: 'badge-joseon', era: "ì¡°ì„  í›„ê¸°", year: "1794ë…„",
                title: "ì •ì¡°ì˜ ê°œí˜ê³¼ ìˆ˜ì› í™”ì„±",
                desc: "ì •ì¡° ëŒ€ì™•ì€ ì•„ë²„ì§€ ì‚¬ë„ì„¸ìì˜ ë¬˜ë¥¼ ì˜®ê¸°ê³ , ê°•ë ¥í•œ ì™•ê¶Œì„ ìƒì§•í•˜ëŠ” ì‹ ë„ì‹œ 'ìˆ˜ì› í™”ì„±'ì„ ê±´ì„¤í•˜ë ¤ í•©ë‹ˆë‹¤. ì •ì•½ìš©ì´ ê±°ì¤‘ê¸°ë¥¼ ë°œëª…í•˜ì—¬ ê³µì‚¬ë¥¼ ë•ê³  ìˆìŠµë‹ˆë‹¤.",
                progress: 77, icon: "ğŸ°",
                choices: [
                    { text: "í™”ì„±ì„ ì™„ê³µí•˜ì—¬ ìƒì—…ê³¼ êµ­ë°©ì˜ ì¤‘ì‹¬ì§€ë¡œ ì‚¼ê³  ê°œí˜ì„ ì™„ì„±í•œë‹¤.", next: "joseon_silhak", unlock: 'reformer' },
                    { text: "ëˆì´ ë„ˆë¬´ ë§ì´ ë“œë‹ˆ ê³µì‚¬ë¥¼ ì¤‘ë‹¨í•œë‹¤.", next: "crisis_weak_king" },
                    { text: "ìˆ˜ì› í™”ì„± ê±´ì„¤ì— ë°˜ëŒ€í•˜ëŠ” ì‹ í•˜ë“¤ì„ ëª¨ë‘ ì²˜í˜•í•˜ê³  ê³µí¬ ì •ì¹˜ë¥¼ í•œë‹¤.", next: "end_tyrant" }
                ]
            },
            crisis_weak_king: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ë©ˆì¶˜ ê°œí˜",
                desc: "ê°œí˜ì´ ì¤‘ë‹¨ë˜ì ê¸°ë“ê¶Œ ì„¸ë ¥ì´ ë‹¤ì‹œ í˜ì„ ì–»ìœ¼ë©° ì™•ê¶Œ(ì™•ì˜ í˜)ì´ ì•½í™”ë˜ì—ˆìŠµë‹ˆë‹¤. ë°±ì„±ë“¤ì˜ ì‚¶ì€ ë‚˜ì•„ì§€ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "ê·œì¥ê°ì„ í†µí•´ ì Šì€ ì¸ì¬ë¥¼ ë“±ìš©í•˜ì—¬ ë‹¤ì‹œ ê°œí˜ì˜ ë¶ˆì”¨ë¥¼ ì‚´ë¦°ë‹¤.", next: "joseon_silhak" }, // íšŒë³µ
                    { text: "ì™•ìœ„ë¥¼ ë‚´ë†“ê³  ë¬¼ëŸ¬ë‚œë‹¤.", next: "end_weakness" },
                    { text: "í˜ ì„¼ ì‹ í•˜ë“¤ì—ê²Œ ë‚˜ë¼ë¥¼ ë§¡ê¸´ë‹¤.", next: "crisis_faction" }
                ]
            },

            joseon_silhak: {
                type: 'history', badge: 'badge-joseon', era: "ì¡°ì„  í›„ê¸°", year: "19ì„¸ê¸° ì´ˆ",
                title: "ì‹¤í•™ì˜ ëŒ€ë‘",
                desc: "ê³µì ì™ˆ ë§¹ì ì™ˆ í•˜ëŠ” ë°±ì„±ë“¤ì˜ ìƒí™©ê³¼ëŠ” ì§ì ‘ì  ê´€ë ¨ì´ ì—†ëŠ” í•™ë¬¸ ëŒ€ì‹ , ë†ì—…ê³¼ ìƒê³µì—… ë“± ì‹¤ìƒí™œì— ë„ì›€ì´ ë˜ëŠ” 'ì‹¤í•™'ì´ ë“±ì¥í–ˆìŠµë‹ˆë‹¤. ê¹€ì •í˜¸ëŠ” ì „êµ­ì„ ëŒë©° ìƒˆë¡œìš´ ë„ì „ì„ ì‹œì‘í•©ë‹ˆë‹¤.",
                progress: 78, icon: "ğŸ—ºï¸",
                choices: [
                    { text: "ë‚˜ë¼ë¥¼ ìœ„í•´ ì •í™•í•œ ì§€ë„ì¸ 'ëŒ€ë™ì—¬ì§€ë„'ë¥¼ ì œì‘í•œë‹¤.", next: "modern_daewon" },
                    { text: "ì§€ë„ëŠ” ì ì—ê²Œ ì´ìš©ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë§Œë“¤ì§€ ì•ŠëŠ”ë‹¤.", next: "crisis_ignorance" },
                    { text: "ì„œì–‘ ê¸°ìˆ ì€ ì˜¤ë‘ìºì˜ ê²ƒì´ë‹ˆ ì ˆëŒ€ ë°°ìš°ì§€ ì•ŠëŠ”ë‹¤.", next: "crisis_tech_lag" }
                ]
            },
            crisis_ignorance: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ê¹œê¹œì´ ë‚˜ë¼",
                desc: "êµ­í† ì— ëŒ€í•œ ì •ë³´ê°€ ì—†ì–´ ë¬¼ë¥˜ ìœ í†µì´ ë§‰íˆê³ , ì ì´ ì³ë“¤ì–´ì™€ë„ ê¸¸ì„ ëª°ë¼ ë§‰ì„ ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "ì‹¤í•™ìë“¤ì˜ ì—°êµ¬ë¥¼ ì§€ì›í•˜ì—¬ ë‚˜ë¼ì˜ ëˆˆê³¼ ê·€ë¥¼ ë°íŒë‹¤.", next: "modern_daewon" }, // íšŒë³µ
                    { text: "ì˜›ë‚  ì§€ë„ê°€ ì •í™•í•˜ë‹ˆ ì˜› ë¬¸í—Œì„ ì¡°ì‚¬í•œë‹¤.", next: "crisis_tech_lag" },
                    { text: "ì™¸êµ­ ì§€ë„ë¥¼ ëª°ë˜ ë¹„ì‹¼ ê°’ì— ì‚¬ì˜¨ë‹¤.", next: "end_culture_lost" }
                ]
            },
            crisis_tech_lag: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ê¸°ìˆ  ê²©ì°¨",
                desc: "ì„œì–‘ì€ ì¦ê¸°ì„ ì„ ë§Œë“¤ê³  ì‚°ì—…í˜ëª…ì„ ì¼ìœ¼í‚¤ëŠ”ë°, ìš°ë¦¬ëŠ” ì•„ì§ë„ ë‚¡ì€ ë†ê¸°êµ¬ì— ì˜ì¡´í•˜ê³  ìˆìŠµë‹ˆë‹¤. êµ­ë ¥ ì°¨ì´ê°€ ë²Œì–´ì§‘ë‹ˆë‹¤.",
                choices: [
                    { text: "ë¶í•™íŒŒì˜ ì£¼ì¥ì„ ë°›ì•„ë“¤ì—¬ ì²­ë‚˜ë¼ì™€ ì„œì–‘ì˜ ë¬¸ë¬¼ì„ ì ê·¹ ë°°ìš´ë‹¤.", next: "modern_daewon" }, // íšŒë³µ
                    { text: "ì„±ë¦¬í•™ë§Œì´ ì‚´ê¸¸ì´ë¼ë©° ê¸°ìˆ ì„ ì²œì‹œ(ë¬´ì‹œ)í•œë‹¤.", next: "end_elite_society" },
                    { text: "ëª¨ë“  ê¸°ìˆ ìë¥¼ ì²œë¯¼ ì·¨ê¸‰í•œë‹¤.", next: "end_weakness" }
                ]
            },

            // ==========================================
            // 6. ê·¼ëŒ€ ë° ì¼ì œ ê°•ì ê¸°
            // ==========================================
            modern_daewon: {
                type: 'history', badge: 'badge-modern', era: "êµ¬í•œë§", year: "1866ë…„",
                title: "í¥ì„ ëŒ€ì›êµ°ê³¼ ì²™í™”ë¹„",
                desc: "ëª¨ì–‘ë„ ì´ìƒí•œ ì„œì–‘ ë°°(ì´ì–‘ì„ )ê°€ í•´ì•ˆê°€ì— ë‚˜íƒ€ë‚˜ í†µìƒì„ ìš”êµ¬í•©ë‹ˆë‹¤. ê·¸ë“¤ì€ ë¬´ë ¥ì„ ì•ì„¸ì›Œ ìœ„í˜‘í•˜ê³  ìˆìŠµë‹ˆë‹¤. í¥ì„ ëŒ€ì›êµ°ì€ ì„ íƒì˜ ê¸°ë¡œì— ì„°ìŠµë‹ˆë‹¤.",
                progress: 80, icon: "ğŸ”’",
                choices: [
                    { text: "ì„œì–‘ ì˜¤ë‘ìºì™€ í™”ì¹œí•˜ëŠ” ê²ƒì€ ë§¤êµ­ì´ë‹¤. ì²™í™”ë¹„ë¥¼ ì„¸ìš°ê³  ê±°ë¶€í•œë‹¤.", next: "modern_gapsin", minigame: 'heung_game' },
                    { text: "ëŒ€ì„¸ëŠ” ê°œí•­ì´ë‹¤. ì¦‰ì‹œ ë¬¸í˜¸ë¥¼ ê°œë°©í•œë‹¤.", next: "crisis_early_colonization" },
                    { text: "ì²­ë‚˜ë¼ì— ë‚˜ë¼ë¥¼ ë°”ì¹˜ê³  ë³´í˜¸ë¥¼ ìš”ì²­í•œë‹¤.", next: "end_qing_province" }
                ]
            },
            crisis_early_colonization: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ì¤€ë¹„ ì—†ëŠ” ê°œí•­",
                desc: "ì•„ë¬´ ì¤€ë¹„ ì—†ì´ ë¬¸ì„ ì—´ì ì„œì–‘ ìƒì¸ë“¤ì´ ê²½ì œë¥¼ ì ì‹í•˜ê³ , ë¶ˆí‰ë“± ì¡°ì•½ì„ ê°•ìš”í•˜ì—¬ ê´€ì„¸ ìì£¼ê¶Œë§ˆì € ìƒì—ˆìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "ì§€ê¸ˆì´ë¼ë„ ìì£¼ì  ê°œí˜ì„ ì‹œë„í•˜ê³  êµ°ëŒ€ë¥¼ ê¸°ë¥¸ë‹¤.", next: "modern_gapsin" }, // íšŒë³µ
                    { text: "ë‚˜ë¼ë¥¼ íŒ”ì•„ë¨¹ê³  ë‚˜ë§Œ ë¶€ìê°€ ëœë‹¤.", next: "end_traitor" },
                    { text: "ë‹¤ì‹œ ë¬¸ì„ ë‹«ìœ¼ë ¤ í•œë‹¤.", next: "end_colony_imperial" } // ì‹ë¯¼ì§€ ì—”ë”© ì¬í™œìš©
                ]
            },

            modern_gapsin: {
                type: 'history', badge: 'badge-modern', era: "ê°œí•­ê¸°", year: "1884ë…„",
                title: "ê°‘ì‹ ì •ë³€",
                desc: "ì²­ë‚˜ë¼ì˜ ë‚´ì • ê°„ì„­ì´ ì‹¬í•´ì§€ì, ê¹€ì˜¥ê·  ë“± ê¸‰ì§„ ê°œí™”íŒŒëŠ” ìš°ì •ì´êµ­ ê°œêµ­ ì¶•í•˜ì—°ì„ í‹ˆíƒ€ ì •ë³€ì„ ì¼ìœ¼ì¼°ìŠµë‹ˆë‹¤. ê·¼ëŒ€ êµ­ê°€ë¥¼ í–¥í•œ ì§§ê³  ê°•ë ¬í•œ ì‹œë„ì…ë‹ˆë‹¤.",
                progress: 83, icon: "ğŸ“®",
                choices: [
                    { text: "í‰ë“±ê³¼ ê·¼ëŒ€ êµ­ê°€ ìˆ˜ë¦½ì˜ ì˜ì§€ë¥¼ ë³´ì—¬ì£¼ê¸° ìœ„í•´ ê°œí˜ë°©ë²•ì„ ì œì‹œí•œë‹¤.", next: "modern_donghak" },
                    { text: "ì¼ë³¸êµ°ì„ ë¯¿ê³  ê°œí˜ì„ ë§‰ëŠ” êµ°ëŒ€ì™€ ëê¹Œì§€ ì „íˆ¬ë¥¼ ë²Œì¸ë‹¤.", next: "crisis_civil_war" },
                    { text: "ì •ë³€ì„ í¬ê¸°í•˜ê³  ì •ë³€ì„ ë§‰ìœ¼ëŸ¬ ì˜¨ ì²­ë‚˜ë¼ ì¥êµ° ì•ì— ë¬´ë¦ ê¿‡ê³  ì‚¬ì£„í•œë‹¤.", next: "crisis_subservience" }
                ]
            },
            crisis_civil_war: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: í•œì–‘ì˜ í™”ì—¼",
                desc: "ì •ë³€ì„ ë§‰ìœ¼ëŸ¬ ì˜¨ ì²­ë‚˜ë¼ êµ°ëŒ€ì™€ ì „íˆ¬ê°€ ë²Œì–´ì ¸ì„œ ë„ì„±ì´ ë¶ˆë°”ë‹¤ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤. ë°±ì„±ë“¤ì´ ì£½ì–´ë‚˜ê°‘ë‹ˆë‹¤.",
                choices: [
                    { text: "ì •ë³€ì´ ì‹¤íŒ¨í–ˆìŒì„ ì¸ì •í•˜ê³  ë‹¤ë¥¸ ë‚˜ë¼ë¡œ ë„í”¼í•œë‹¤.", next: "modern_donghak" }, // íšŒë³µ
                    { text: "ì¼ë³¸ í¸ì— ì„œì„œ ì²­ë‚˜ë¼ì™€ ì‹¸ìš´ë‹¤.", next: "end_traitor" },
                    { text: "ë„ë§ì¹œë‹¤.", next: "end_coward" }
                ]
            },
            crisis_subservience: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ì‚¬ëŒ€ì£¼ì˜ì˜ ë¶€í™œ",
                desc: "ì²­ë‚˜ë¼ì˜ ë‚´ì • ê°„ì„­ì´ ê·¹ì— ë‹¬í•´ ì¡°ì„ ì˜ ìì£¼ê¶Œì´ ì‚¬ì‹¤ìƒ ì‚¬ë¼ì¡ŒìŠµë‹ˆë‹¤. ì¡°ì„  ì™•ì€ ì²­ë‚˜ë¼ ê´€ë¦¬ì˜ ëˆˆì¹˜ë§Œ ë´…ë‹ˆë‹¤.",
                choices: [
                    { text: "ì²­ë‚˜ë¼ë¥¼ ëª°ì•„ë‚´ê¸° ìœ„í•´ ì¡°ì„ ì˜ í˜ì„ ê¸°ë¥´ê³  ì™¸ì„¸ë¥¼ ëª°ì•„ë‚´ë ¤ ë…¸ë ¥í•œë‹¤.", next: "modern_donghak" }, // íšŒë³µ
                    { text: "ì²­ë‚˜ë¼ì˜ ì†êµ­ì´ ëœë‹¤.", next: "end_qing_province" },
                    { text: "ì¼ë³¸ì„ ëŒì–´ë“¤ì—¬ ì²­ì„ ê²¬ì œí•œë‹¤ (ì´ì´ì œì´).", next: "crisis_civil_war" }
                ]
            },

            modern_donghak: {
                type: 'history', badge: 'badge-modern', era: "ê°œí•­ê¸°", year: "1894ë…„",
                title: "ë™í•™ ë†ë¯¼ ìš´ë™",
                desc: "íƒê´€ì˜¤ë¦¬ì˜ íš¡í¬ì— ì°¸ë‹¤ëª»í•œ ë†ë¯¼ë“¤ì´ ì „ë´‰ì¤€ì„ ì¤‘ì‹¬ìœ¼ë¡œ ì¼ì–´ë‚¬ìŠµë‹ˆë‹¤. 'ì‚¬ëŒì´ ê³§ í•˜ëŠ˜ì´ë‹¤(ì¸ë‚´ì²œ)'ë¼ëŠ” ê¸°ì¹˜ ì•„ë˜, ë‚¡ì€ ì„¸ìƒì„ ë’¤ì—ìœ¼ë ¤ í•©ë‹ˆë‹¤.",
                progress: 85, icon: "ğŸŒ¾",
                choices: [
                    { text: "ì™¸êµ­êµ°ì´ ì¡°ì„ ì— ë“¤ì–´ì˜¬ ìˆ˜ ìˆìœ¼ë‹ˆ ì •ë¶€ì˜ ë§ì„ ë°›ì•„ë“¤ì—¬ ì¼ë‹¨ í•´ì‚°í–ˆë‹¤ê°€ í˜¹ì‹œ ëª¨ë¥¼ ì™¸êµ­êµ°ì˜ ì¹¨ëµì— ëŒ€ë¹„í•œë‹¤.", next: "modern_eulsa" },
                    { text: "ë‚˜ë¼ê°€ í˜¼ë€ìŠ¤ëŸ¬ìš°ë‹ˆ ê³§ë°”ë¡œ ë¬´ê¸°ë¥¼ ë²„ë¦¬ê³  í•´ì‚°í•˜ê³  ì•ìœ¼ë¡œ ë¨¹ê³  ì‚´ ì¼ì´ ê±±ì •ì´ë‹ˆ ë†ì‚¬ë¥¼ ì§“ëŠ”ë‹¤.", next: "crisis_peasant_fail" },
                    { text: "ì™• ì¤‘ì‹¬ì˜ êµ­ê°€ë¥¼ ì¸ì •í•˜ì§€ ì•Šê³  ë†ë¯¼ë“¤ë§Œì˜ ë‚˜ë¼ë¥¼ ì„ í¬í•œë‹¤.", next: "crisis_republic_fail" }
                ]
            },
            crisis_peasant_fail: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ë¯¸ì™„ì˜ í˜ëª…",
                desc: "ë†ë¯¼êµ°ì´ íì§€ë¶€ì§€ í•´ì‚°í•˜ì íƒê´€ì˜¤ë¦¬ì˜ íš¡í¬ê°€ ë‹¤ì‹œ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤. ê°œí˜ì˜ ë¶ˆì”¨ê°€ êº¼ì¡ŒìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "2ì°¨ ë´‰ê¸°ë¥¼ ì¼ìœ¼ì¼œ í•­ì¼ êµ¬êµ­(ë‚˜ë¼ë¥¼ êµ¬í•˜ê¸° ìœ„í•œ) íˆ¬ìŸì„ í•œë‹¤.", next: "modern_eulsa" }, // íšŒë³µ
                    { text: "ì‚°ì†ì— ìˆ¨ì–´ ì§€ë‚¸ë‹¤.", next: "end_coward" },
                    { text: "ì¼ë³¸êµ°ì— íˆ¬í•­í•œë‹¤.", next: "end_traitor" }
                ]
            },
            crisis_republic_fail: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ê³ ë¦½ëœ ì´ìƒ",
                desc: "ë„ˆë¬´ ê¸‰ì§„ì ì¸ ì£¼ì¥ì— ì–‘ë°˜ê³¼ ì¼ë°˜ ë°±ì„±ë“¤ì´ ë“±ì„ ëŒë ¸ìŠµë‹ˆë‹¤. ê³ ë¦½ëœ ë†ë¯¼êµ°ì€ í† ë²ŒëŒ€ì— ì˜í•´ ì§„ì••ë˜ì—ˆìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "ì™¸êµ­êµ°ì— ì €í•­í•˜ê¸° ìœ„í•´ ë¯¼ì¡±ì˜ ë‹¨ê²°ì„ í˜¸ì†Œí•œë‹¤.", next: "modern_eulsa" }, // íšŒë³µ
                    { text: "ìš°ë¦¬ë¼ë¦¬ë§Œ ì˜ ì‚¬ëŠ” ë§ˆì„ì„ ë§Œë“ ë‹¤.", next: "end_weakness" },
                    { text: "ì•½íƒˆì„ ì¼ì‚¼ì•„ ë„ì ë–¼ê°€ ëœë‹¤.", next: "end_savage" }
                ]
            },

            modern_eulsa: {
                type: 'history', badge: 'badge-modern', era: "ëŒ€í•œì œêµ­", year: "1905ë…„",
                title: "ì„ì‚¬ëŠ‘ì•½ì˜ ë¹„ê·¹",
                desc: "ì¼ë³¸ì´ êµ°ëŒ€ë¥¼ ì•ì„¸ì›Œ ê¶ê¶ì„ í¬ìœ„í•˜ê³ , ëŒ€í•œì œêµ­ì˜ ì™¸êµê¶Œì„ ë°•íƒˆí•˜ëŠ” ì¡°ì•½ì— ê°•ì œë¡œ ì„œëª…í•˜ê²Œ í–ˆìŠµë‹ˆë‹¤. ì„ì‚¬ëŠ‘ì•½ì´ ì²´ê²°ë˜ì—ˆìŠµë‹ˆë‹¤. ë‚˜ë¼ê°€ ë§í•˜ê¸° ì¼ë³´ ì§ì „ì…ë‹ˆë‹¤.",
                progress: 88, icon: "ğŸ¥€",
                choices: [
                    { text: "í—¤ì´ê·¸ì— íŠ¹ì‚¬ë¥¼ íŒŒê²¬í•´ ë¶€ë‹¹í•¨ì„ ì•Œë¦¬ê³ , ì „êµ­ì—ì„œ ì˜ë³‘ì„ ì¼ìœ¼ì¼œ ì €í•­í•œë‹¤.", next: "modern_gukchae" },
                    { text: "ì–´ì©” ìˆ˜ ì—†ë‹¤. ë„ì¥ì„ ì°ê³  ì¼ë³¸ì˜ ë³´í˜¸ë¥¼ ë°›ëŠ”ë‹¤.", next: "end_traitor" },
                    { text: "ëŸ¬ì‹œì•„ í™©ì œì—ê²Œ ë„ì›€ì„ ìš”ì²­í•˜ì—¬ ëŸ¬ì‹œì•„ë¡œ ë„ë§ì¹œë‹¤.", next: "crisis_exile" }
                ]
            },
            crisis_exile: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ë§ëª… ì •ë¶€",
                desc: "í™©ì œê°€ ë‚˜ë¼ë¥¼ ë²„ë¦¬ê³  ë– ë‚˜ì êµ¬ì‹¬ì ì„ ìƒì€ êµ­ë‚´ëŠ” ë¹ ë¥´ê²Œ ì¼ë³¸ì— ì ì‹ë‹¹í–ˆìŠµë‹ˆë‹¤. ë°±ì„±ë“¤ì€ ë²„ë ¤ì¡Œë‹¤ëŠ” ì ˆë§ê°ì— ë¹ ì¡ŒìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "ìµœëŒ€í•œ ë¹¨ë¦¬ ë‹¤ì‹œ ëŒ€í•œì œêµ­ìœ¼ë¡œ ëŒì•„ê°€ ë‚˜ë¼ë¥¼ ì •ìƒí™” ì‹œí‚¤ê¸° ìœ„í•´ ë…¸ë ¥í•œë‹¤.", next: "modern_gukchae" }, // íšŒë³µ
                    { text: "ëŸ¬ì‹œì•„ ì‹œë¯¼ì´ ë˜ì–´ í¸í•˜ê²Œ ì‚°ë‹¤.", next: "end_coward" },
                    { text: "ì¼ë³¸ì— í•­ë³µí•œë‹¤.", next: "end_traitor" }
                ]
            },

            // [ì¶”ê°€ ì‹œë‚˜ë¦¬ì˜¤ 4: êµ­ì±„ë³´ìƒìš´ë™]
            modern_gukchae: {
                type: 'history', badge: 'badge-modern', era: "ëŒ€í•œì œêµ­", year: "1907ë…„",
                title: "êµ­ì±„ë³´ìƒìš´ë™",
                desc: "ì¼ë³¸ì€ ëŒ€í•œì œêµ­ì— ê°•ì œë¡œ ëˆì„ ë¹Œë ¤ì£¼ì–´ ê²½ì œì ìœ¼ë¡œ ê¼¼ì§ëª»í•˜ê²Œ í•˜ë ¤ê³  í•©ë‹ˆë‹¤. ë‚˜ëë¹šì´ 1,300ë§Œ ì›(ê·¸ ë‹¹ì‹œ ë‚˜ë¼ì˜ 1ë…„ì¹˜ ì˜ˆì‚°ë³´ë‹¤ ë§ì€ ëˆ)ì— ë‹¬í•´ ë‚˜ë¼ê°€ ë§í•  ìœ„ê¸°ì— ì²˜í–ˆìŠµë‹ˆë‹¤. ëŒ€êµ¬ì—ì„œ ì‹œì‘ëœ ìš´ë™ì´ ì „êµ­ìœ¼ë¡œ í¼ì§‘ë‹ˆë‹¤.",
                progress: 89, icon: "ğŸ’°",
                choices: [
                    { text: "ë‚¨ìëŠ” ë‹´ë°°ë¥¼ ëŠê³  ì—¬ìëŠ” ë¹„ë…€ë¥¼ íŒ”ì•„ ë‚˜ëë¹šì„ ê°šìê³  í˜¸ì†Œí•œë‹¤.", next: "colonial_an", unlock: 'patriot' },
                    { text: "ë‹¤ë¥¸ ë‚˜ë¼(ì˜êµ­, ë¯¸êµ­)ì— ëˆì„ ë¹Œë ¤ ì¼ë³¸ ë¹šì„ ê°šëŠ”ë‹¤.", next: "end_colony_debt" },
                    { text: "ê°šì„ ëŠ¥ë ¥ì´ ì—†ìœ¼ë‹ˆ íŒŒì‚° ì„ ì–¸ì„ í•œë‹¤.", next: "crisis_economic_collapse" }
                ]
            },
            end_colony_debt: { type: 'ending', title: "BAD END: ë¹šë”ë¯¸ ì‹ë¯¼ì§€", desc: "ë¹šì„ ë¹šìœ¼ë¡œ ë§‰ìœ¼ë ¤ë‹¤ ì„œêµ¬ ì—´ê°•ì˜ ì´ê¶Œ ì¹¨íƒˆ ëŒ€ìƒì´ ë˜ì–´ ì°¢ê²¨ì¡ŒìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            crisis_economic_collapse: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ê²½ì œ íŒŒíƒ„",
                desc: "êµ­ê°€ ì‹ ìš©ë„ê°€ ë°”ë‹¥ì„ ì¹˜ê³  í™”í ê°€ì¹˜ê°€ í­ë½í–ˆìŠµë‹ˆë‹¤. ì¡°ì„  ëˆìœ¼ë¡œ ì‚´ ìˆ˜ ìˆëŠ” ë¬¼ê±´ì´ ì—†ì–´ì¡ŒìŠµë‹ˆë‹¤. ë°±ì„±ë“¤ì€ êµ¶ì£¼ë¦¬ê³  ì¼ë³¸ ìƒì¸ë“¤ì´ í—ê°’ì— ë•…ì„ ì‚¬ë“¤ì…ë‹ˆë‹¤.",
                choices: [
                    { text: "ê²½ì œë¥¼ íšŒë³µí•˜ê¸° ìœ„í•´ êµ­ë¯¼ë“¤ì˜ ë„ì›€ì˜ ë°›ì•„ ë¹šì„ ê°šê³  ì¡°ì„ ì˜ í™”í ê°€ì¹˜ë¥¼ íšŒë³µì‹œí‚¨ë‹¤.", next: "colonial_an" }, // íšŒë³µ
                    { text: "ì¼ë³¸ í™”íë¥¼ ì“°ë©° ê²½ì œê¶Œì— í¸ì…ëœë‹¤.", next: "end_assimilation" },
                    { text: "ì‚°ìœ¼ë¡œ ë“¤ì–´ê°€ ìê¸‰ìì¡±í•œë‹¤.", next: "end_weakness" }
                ]
            },


            colonial_an: {
                type: 'history', badge: 'badge-modern', era: "ì¼ì œê°•ì ê¸° ì§ì „", year: "1909ë…„",
                title: "ì•ˆì¤‘ê·¼ì˜ ì˜ê±°",
                desc: "ì¡°ì„  ì¹¨ëµì˜ ì›í‰ ì´í†  íˆë¡œë¶€ë¯¸ê°€ í•˜ì–¼ë¹ˆ ì—­ì— ë„ì°©í–ˆìŠµë‹ˆë‹¤. ì•ˆì¤‘ê·¼ ì˜ì‚¬ì˜ í’ˆì†ì—ëŠ” ê¶Œì´ì´ ìˆìŠµë‹ˆë‹¤. ë°©ì•„ì‡ ë¥¼ ë‹¹ê¸°ì‹œê² ìŠµë‹ˆê¹Œ?",
                progress: 90, icon: "ğŸ”«",
                choices: [
                    { text: "íƒ•! íƒ•! íƒ•! ì´í† ë¥¼ ì‚¬ì‚´í•˜ê³  'ì½”ë ˆì•„ ìš°ë¼(ëŒ€í•œ ë§Œì„¸)'ë¥¼ ì™¸ì¹œë‹¤.", next: "colonial_march", minigame: 'ahn_rhythm_game' },
                    { text: "ê¶Œì´ì„ ë²„ë¦¬ê³  í‰í™”ì ìœ¼ë¡œ ëŒ€í™”í•˜ì—¬ ì„¤ë“ì„ ì‹œë„í•œë‹¤.", next: "crisis_naive" },
                    { text: "ë‘ë ¤ì›€ì— ë–¨ë©° ê±°ì‚¬ë¥¼ í¬ê¸°í•˜ê³  ìˆ¨ëŠ”ë‹¤.", next: "end_coward" }
                ]
            },
            crisis_naive: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ìˆœì§„í•œ ìƒê°",
                desc: "ëŒ€í™”ë¥¼ ì‹œë„í•˜ë ¤ë‹¤ ì¼ë³¸ ê²½í˜¸ì›ë“¤ì—ê²Œ ì²´í¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì´í† ëŠ” ì‚´ì•„ë‚¨ì•„ ì¡°ì„  ì¹¨ëµì„ ë”ìš± ë…¸ê³¨ì ìœ¼ë¡œ ì‹œë„í–ˆìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "í‹ˆì„ ë³´ì•„ ê°ì˜¥ì—ì„œ íƒˆì˜¥í•˜ì—¬ ì´í† ë¥¼ ì‚¬ì‚´í•œë‹¤.", next: "colonial_march" }, // íšŒë³µ
                    { text: "ì˜ëª»í–ˆë‹¤ê³  ë¹Œê³  í’€ë ¤ë‚œë‹¤.", next: "end_traitor" },
                    { text: "ìê²°í•œë‹¤.", next: "end_leaderless" }
                ]
            },

            colonial_march: {
                type: 'history', badge: 'badge-modern', era: "ì¼ì œê°•ì ê¸°", year: "1919ë…„",
                title: "3.1 ìš´ë™",
                desc: "ê³ ì¢… í™©ì œì˜ ì¥ë¡€ì¼ì„ ë§ì•„ ë¯¼ì¡±ì˜ ì–µëˆŒë¦° ë¶„ë…¸ê°€ í­ë°œí–ˆìŠµë‹ˆë‹¤. í•™ìƒê³¼ ì¢…êµê³„ê°€ í˜ì„ í•©ì³ ë…ë¦½ ì„ ì–¸ì„œë¥¼ ë‚­ë…í•˜ë ¤ í•©ë‹ˆë‹¤.",
                progress: 92, icon: "ğŸ‡°ğŸ‡·",
                choices: [
                    { text: "ë¹„í­ë ¥ í‰í™” ì‹œìœ„ë¡œ ìš°ë¦¬ ë¯¼ì¡±ì˜ ë…ë¦½ ì˜ì§€ë¥¼ ì „ ì„¸ê³„ì— ì•Œë¦°ë‹¤.", next: "colonial_battle" },
                    { text: "ì´ì¹¼ì—ëŠ” ì´ì¹¼ë¡œ ë§ì„ ë‹¤. ë¬´ì¥ í­ë™ì„ ì¼ìœ¼í‚¨ë‹¤.", next: "crisis_violent_crackdown" },
                    { text: "ê³„ë€ìœ¼ë¡œ ë°”ìœ„ ì¹˜ê¸°ë‹¤. ë…ë¦½ ìš´ë™ì„ ê·¸ë§Œë‘”ë‹¤.", next: "end_assimilation" }
                ]
            },
            crisis_violent_crackdown: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ë¬´ìë¹„í•œ ì§„ì••",
                desc: "í­ë ¥ì„ ì“°ì ì¼ë³¸êµ°ì€ ê¸°ë‹¤ë ¸ë‹¤ëŠ” ë“¯ì´ ê¸°ê´€ì´ì„ ë™ì›í•´ í•™ì‚´ì„ ìí–‰í–ˆìŠµë‹ˆë‹¤. í‰í™” ì‹œìœ„ì˜ ì •ë‹¹ì„±ì„ ìƒê³  êµ­ì œ ì—¬ë¡ ë„ ë“±ì„ ëŒë¦½ë‹ˆë‹¤.",
                choices: [
                    { text: "ìƒí•˜ì´ë¡œ ê±´ë„ˆê°€ ëŒ€í•œë¯¼êµ­ ì„ì‹œì •ë¶€ë¥¼ ìˆ˜ë¦½í•˜ê³  ì²´ê³„ì ìœ¼ë¡œ ì €í•­í•œë‹¤.", next: "colonial_battle" }, // íšŒë³µ
                    { text: "ë” í° í…ŒëŸ¬ë¥¼ ê³„íší•œë‹¤.", next: "end_bad_tactic" },
                    { text: "ëª¨ë‘ í¬ê¸°í•œë‹¤.", next: "end_assimilation" }
                ]
            },

            colonial_battle: {
                type: 'history', badge: 'badge-modern', era: "ì¼ì œê°•ì ê¸°", year: "1920ë…„",
                title: "ì²­ì‚°ë¦¬ ëŒ€ì²©",
                desc: "ë§Œì£¼ë¡œ ê±´ë„ˆê°„ ë…ë¦½êµ°ë“¤ì´ ì¼ë³¸êµ° ì •ê·œ ë¶€ëŒ€ì™€ ë§ë¶™ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ê¹€ì¢Œì§„ ì¥êµ°ê³¼ í™ë²”ë„ ì¥êµ°ì€ ì§€í˜•ì„ ì´ìš©í•œ ì‘ì „ì„ ì¤€ë¹„í•©ë‹ˆë‹¤.",
                progress: 95, icon: "âš”ï¸",
                choices: [
                    { text: "ìœ ì¸ì±…ê³¼ ë§¤ë³µ ì‘ì „ìœ¼ë¡œ ì¼ë³¸êµ°ì„ ëŒ€íŒŒí•˜ì—¬ ë…ë¦½ ì „ìŸ ì‚¬ìƒ ìµœëŒ€ ìŠ¹ë¦¬ë¥¼ ê±°ë‘”ë‹¤.", next: "colonial_language" },
                    { text: "ì¼ë³¸êµ°ì˜ ì „ë ¥ì´ ë„ˆë¬´ ê°•í•˜ë‹ˆ ì „íˆ¬ë¥¼ í”¼í•˜ê³  í©ì–´ì§„ë‹¤.", next: "crisis_scattered" },
                    { text: "ì†Œë ¨ì˜ ì§€ì›ì„ ë¯¿ê³  ì†Œë ¨êµ° ì•„ë˜ë¡œ ë“¤ì–´ê°„ë‹¤.", next: "crisis_soviet_betrayal" }
                ]
            },
            crisis_scattered: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ê°ê°œê²©íŒŒ",
                desc: "í©ì–´ì§„ ë…ë¦½êµ° ë¶€ëŒ€ë“¤ì€ ì¼ë³¸êµ°ì˜ ëˆì§ˆê¸´ í† ë²Œ ì‘ì „ì— í•˜ë‚˜ë‘˜ì”© ë¬´ë„ˆì§‘ë‹ˆë‹¤. êµ¬ì‹¬ì ì„ ìƒì—ˆìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "ë‹¤ì‹œ 3ë¶€ê°€ í†µí•©í•˜ì—¬ êµ­ë¯¼ë¶€ë¥¼ ê²°ì„±í•˜ê³  ì „ì—´ì„ ì •ë¹„í•œë‹¤.", next: "colonial_language" }, // íšŒë³µ
                    { text: "ë„ì ë‹¨ì´ ë˜ì–´ ì•½íƒˆì„ ì¼ì‚¼ëŠ”ë‹¤.", next: "end_savage" },
                    { text: "ì¼ë³¸êµ°ì— íˆ¬í•­í•œë‹¤.", next: "end_traitor" }
                ]
            },
            crisis_soviet_betrayal: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ììœ ì‹œ ì°¸ë³€",
                desc: "ë¯¿ì—ˆë˜ ì†Œë ¨êµ°ì´ ë…ë¦½êµ°ì˜ ë¬´ì¥ í•´ì œë¥¼ ìš”êµ¬í•˜ë©° ê³µê²©í–ˆìŠµë‹ˆë‹¤. ìˆ˜ë§ì€ ë…ë¦½êµ°ì´ í¬ìƒë˜ê³  ì£¼ë ¥ì´ í©ì–´ì§€ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.",
                choices: [
                    { text: "ë§Œì£¼ë¡œ ëŒì•„ì™€ ìƒˆë¡œ êµ°ëŒ€ë¥¼ ì¡°ì§í•˜ì—¬ ì¼ë³¸ê³¼ ì‹¸ìš¸ ì¤€ë¹„ë¥¼ ë‹¤ì‹œ ì‹œì‘í•œë‹¤.", next: "colonial_language" }, // íšŒë³µ
                    { text: "ê³µì‚°ì£¼ì˜ìê°€ ë˜ì–´ ì†Œë ¨êµ°ì— ë“¤ì–´ê°„ë‹¤.", next: "end_soviet_red" },
                    { text: "ë…ë¦½ì˜ ê¿ˆì„ ì ‘ëŠ”ë‹¤.", next: "end_assimilation" }
                ]
            },

            colonial_language: {
                type: 'history', badge: 'badge-modern', era: "ì¼ì œê°•ì ê¸° ë§", year: "1940ë…„ëŒ€",
                title: "ìš°ë¦¬ë§ ì§€í‚¤ê¸° (ë§ëª¨ì´)",
                desc: "ì¼ë³¸ì´ ì°½ì”¨ê°œëª…ì„ ê°•ìš”í•˜ê³  í•™êµì—ì„œ í•œêµ­ì–´ ì‚¬ìš©ì„ ê¸ˆì§€í–ˆìŠµë‹ˆë‹¤. ìš°ë¦¬ë§ì´ ì‚¬ë¼ì§€ë©´ ë¯¼ì¡±ì˜ ì •ì‹ ë„ ì‚¬ë¼ì§‘ë‹ˆë‹¤. ì¡°ì„ ì–´í•™íšŒ í•™ìë“¤ì€ ë¹„ë°€ë¦¬ì— ìš°ë¦¬ë§ ì‚¬ì „ì„ ë§Œë“¤ê³  ìˆìŠµë‹ˆë‹¤.",
                progress: 97, icon: "ğŸ“™",
                choices: [
                    { text: "ëª¨ì§„ ê³ ë¬¸ê³¼ íƒ„ì••ì„ ë¬´ë¦…ì“°ê³  ìš°ë¦¬ë§ í°ì‚¬ì „ ì›ê³ ë¥¼ ì§€ì¼œë‚¸ë‹¤.", next: "liberation_day" },
                    { text: "ì¼ë³¸ì–´ê°€ êµ­ì–´ê°€ ë˜ì—ˆìœ¼ë‹ˆ ì–´ì©” ìˆ˜ ì—†ë‹¤. í•œê¸€ ì—°êµ¬ë¥¼ í¬ê¸°í•œë‹¤.", next: "end_culture_lost" },
                    { text: "ë“¤í‚¤ë©´ ì£½ëŠ”ë‹¤. ëª¨ë“  ì›ê³ ë¥¼ ë¶ˆíƒœìš°ê³  ì¦ê±°ë¥¼ ì—†ì•¤ë‹¤.", next: "crisis_history_erased" }
                ]
            },
            crisis_history_erased: {
                type: 'crisis', badge: 'badge-crisis', title: "ì‹¤ì œì™€ ë‹¤ë¥¸ ì—­ì‚¬: ì–¼ë¹ ì§„ ë¯¼ì¡±",
                desc: "ë§ê³¼ ê¸€ì´ ì‚¬ë¼ì§€ì ìš°ë¦¬ì˜ ì—­ì‚¬ì™€ ì •ì‹ ë„ í¬ë¯¸í•´ì ¸ ê°‘ë‹ˆë‹¤. ì‚¬ëŒë“¤ì€ ì°½ì”¨ê°œëª…í•œ ì´ë¦„(ì¼ë³¸ì–´ ì´ë¦„)ìœ¼ë¡œ ì„œë¡œë¥¼ ë¶€ë¥´ë©° ì¼ë³¸ì¸ìœ¼ë¡œ ë™í™”ë˜ê¸° ì§ì „ì…ë‹ˆë‹¤.",
                choices: [
                    { text: "í•´ë°© ì§ì „, ì„œìš¸ì—­ ì°½ê³ ì—ì„œ ê¸°ì ì ìœ¼ë¡œ ì›ê³ ë¥¼ ì°¾ì•„ ìš°ë¦¬ë§ í°ì‚¬ì „ í¸ì°¬í•˜ì—¬ ìš°ë¦¬ ê¸€ì„ ë³´ì¡´í•œë‹¤.", next: "liberation_day" }, // ê·¹ì  íšŒë³µ
                    { text: "ì¼ë³¸ì–´ë¥¼ ëª¨êµ­ì–´ë¡œ ë°›ì•„ë“¤ì¸ë‹¤.", next: "end_culture_lost" },
                    { text: "ë§Œì£¼ë¡œ ë– ë‚˜ ìš°ë¦¬ë§ì„ ì“°ëŠ” ë§ˆì„ì„ ë§Œë“ ë‹¤.", next: "end_coward" }
                ]
            },

            // ==========================================
            // 7. ì—”ë”© (ê´‘ë³µ)
            // ==========================================
            liberation_day: {
                type: 'ending', badge: 'badge-modern', era: "ëŒ€í•œë¯¼êµ­", year: "1945ë…„ 8ì›” 15ì¼",
                title: "ğŸ‰ ê´‘ë³µ, ê·¸ë¦¬ê³  ìƒˆë¡œìš´ ì‹œì‘",
                desc: "1945ë…„ 8ì›” 15ì¼, ë¼ë””ì˜¤ì—ì„œ ì¼ë³¸ ì²œí™©ì˜ í•­ë³µ ë°©ì†¡ì´ í˜ëŸ¬ë‚˜ì˜µë‹ˆë‹¤. ê±°ë¦¬ë¡œ ë›°ì³ë‚˜ì˜¨ ì‚¬ëŒë“¤ì€ íƒœê·¹ê¸°ë¥¼ í”ë“¤ë©° 'ëŒ€í•œ ë…ë¦½ ë§Œì„¸'ë¥¼ ì™¸ì¹©ë‹ˆë‹¤.<br><br>ë‹¹ì‹ ì˜ ëˆì§ˆê¸´ íˆ¬ìŸê³¼ ì˜¬ë°”ë¥¸ ì„ íƒ ë•ë¶„ì— ìš°ë¦¬ ë¯¼ì¡±ì€ ë¹›ì„ ë˜ì°¾ì•˜ìŠµë‹ˆë‹¤(å…‰å¾©). ìˆ˜ë§ì€ ì„ ì¡°ë“¤ì˜ í”¼ì™€ ë•€ì´ í—›ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì—­ì‚¬ì˜ ìˆ˜í˜¸ìì—¬, ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤!",
                progress: 100, icon: "ğŸŒ",
                unlock: 'history_guardian',
                choices: [
                    { text: "ğŸ‡°ğŸ‡· ëª…ì˜ˆì˜ ì „ë‹¹ì— ì´ë¦„ ë‚¨ê¸°ê¸°", onclick: "openHofModal(true)", style: "special" },
                    { text: "ìœ„ëŒ€í•œ ì—¬ì •ì„ ë‹¤ì‹œ ì‹œì‘í•˜ê¸°", next: "start", style: "restart" }
                ]
            },

            // === ë°°ë“œ ì—”ë”©ë“¤ (ì™„ì „ ì‹¤íŒ¨) ===
            end_captured_buyeo: { type: 'ending', title: "BAD END: ë¶€ì—¬ì˜ ì£„ì¸", desc: "ë§ˆì„ì— ìˆ¨ì—ˆë‹¤ê°€ ë°œê°ë˜ì–´ ë¶€ì—¬êµ°ì—ê²Œ ì¡í˜€ê°”ìŠµë‹ˆë‹¤. ê¿ˆì€ ì—¬ê¸°ì„œ ëë‚¬ìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_mountain_lost: { type: 'ending', title: "BAD END: ì‚°ì†ì˜ ë¯¸ì•„", desc: "í—˜í•œ ì‚°ì†ì—ì„œ ê¸¸ì„ ìƒê³  í—¤ë§¤ë‹¤ ì¶”ìœ„ì™€ êµ¶ì£¼ë¦¼ì— ì“°ëŸ¬ì¡ŒìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },

            end_fail_founding: { type: 'ending', title: "BAD END: ê±´êµ­ ì‹¤íŒ¨", desc: "ê³ ë‚œì„ ì´ê²¨ë‚´ì§€ ëª»í•˜ê³  ë‚˜ë¼ë¥¼ ì„¸ìš°ëŠ” ê²ƒì„ í¬ê¸°í–ˆìŠµë‹ˆë‹¤. ë‹¹ì‹ ì˜ ì´ë¦„ì€ ìŠí˜€ì¡ŒìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_vassal_goguryeo: { type: 'ending', title: "BAD END: ê³ êµ¬ë ¤ì˜ ì†êµ­", desc: "ìì£¼ì„±ì„ ë²„ë¦¬ê³  ê³ êµ¬ë ¤ì˜ ì§€ë°°ë¥¼ ë°›ëŠ” ì‹ ì„¸ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_vassal_baekje: { type: 'ending', title: "BAD END: ë°±ì œì˜ ê¹ƒë°œ ì•„ë˜", desc: "ë°±ì œì—ê²Œ íŒ¨ê¶Œì„ ë„˜ê²¨ì£¼ê³  ê·¸ë“¤ì˜ ì‹ í•˜ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_exile_ancient: { type: 'ending', title: "BAD END: ë°”ë‹¤ ê±´ë„ˆ ë„í”¼", desc: "í•œë°˜ë„ë¥¼ ë²„ë¦¬ê³  ì¼ë³¸ìœ¼ë¡œ ë„ë§ì³¤ìŠµë‹ˆë‹¤. ê³ í–¥ì˜ ì—­ì‚¬ëŠ” ë‹¹ì‹  ì—†ì´ í˜ëŸ¬ê°‘ë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_vassal_generic: { type: 'ending', title: "BAD END: ëŒ€êµ­ì˜ ê·¸ëŠ˜", desc: "ì¤‘êµ­ ì™•ì¡°ì˜ ì‹ í•˜ë¥¼ ìì²˜í•˜ì—¬ ë…ìì ì¸ êµ­ê°€ë¥¼ ìƒì—ˆìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_vassal_jurchen: { type: 'ending', title: "BAD END: ì—¬ì§„ì˜ í˜•ì œêµ­", desc: "ì—¬ì§„ì¡±ì—ê²Œ ë¨¸ë¦¬ë¥¼ ìˆ™ì´ê³  ë•…ì„ ë‚´ì£¼ì—ˆìŠµë‹ˆë‹¤. ë¶ë°©ì˜ í˜¸ë‘ì´ëŠ” ì´ì œ ê³ ë ¤ë¥¼ ì–•ì¡ì•„ ë´…ë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_colony_imperial: { type: 'ending', title: "BAD END: ì„œêµ¬ ì—´ê°•ì˜ ë¨¹ì‡ê°", desc: "ì¤€ë¹„ ì—†ì´ ë¬¸ì„ ì—´ì–´ ì„œì–‘ ì„¸ë ¥ì˜ ê²½ì œì , ì •ì¹˜ì  ì‹ë¯¼ì§€ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_soviet_red: { type: 'ending', title: "BAD END: ë¶‰ì€ êµ°ëŒ€", desc: "ì†Œë ¨êµ°ì— í¸ì…ë˜ì–´ ë¯¼ì¡±ì˜ ë…ë¦½ë³´ë‹¤ëŠ” ì´ë…ì„ ë”°ë¥´ëŠ” ì‚¶ì„ ì‚´ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            
            end_myth_fail: { type: 'ending', title: "BAD END: ì‹ í™”ì˜ ë", desc: "ë‹¨êµ° ì‹ í™”ëŠ” ì‹œì‘ë˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. í•œë°˜ë„ëŠ” ë¬¸ëª…í™”ë˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_savage: { type: 'ending', title: "BAD END: ì•¼ë§Œì˜ ì‹œëŒ€", desc: "ë²•ê³¼ ì§ˆì„œ ëŒ€ì‹  í­ë ¥ë§Œì´ ë‚¨ì€ ì„¸ìƒì´ ë˜ì—ˆìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_tyrant: { type: 'ending', title: "BAD END: í­êµ°ì˜ ë§ë¡œ", desc: "ë°±ì„±ì„ ì–µì••í•œ êµ­ê°€ëŠ” ì˜¤ë˜ê°€ì§€ ëª»í•˜ê³  ë¬´ë„ˆì¡ŒìŠµë‹ˆë‹¤.", unlock: 'tyrant', choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_buyeo_sub: { type: 'ending', title: "BAD END: ìŠí˜€ì§„ ë¶€ì—¬", desc: "ê³ êµ¬ë ¤ëŠ” ê±´êµ­ë˜ì§€ ëª»í–ˆê³  ë¶€ì—¬ì˜ ë³€ë°© ë¶€ì¡±ìœ¼ë¡œ ë‚¨ì•˜ìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_bad_tactic: { type: 'ending', title: "BAD END: ë¬´ëª¨í•œ íŒ¨ë°°", desc: "ìš©ê¸°ë§Œ ìˆê³  ì§€ëµì´ ì—†ëŠ” ì‹¸ì›€ì€ íŒ¨ë°°ë¡œ ëë‚¬ìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_sui_colony: { type: 'ending', title: "BAD END: ì¤‘ì›ì˜ ì‹ë¯¼ì§€", desc: "í•œë°˜ë„ëŠ” ì¤‘êµ­ ì™•ì¡°ì˜ ì¼ë¶€ë¶„ìœ¼ë¡œ ì „ë½í–ˆìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_tang_vassal: { type: 'ending', title: "BAD END: ë‹¹ì˜ ê³„ë¦¼ë„ë…ë¶€", desc: "ìì£¼ì ì¸ í†µì¼ì„ ì´ë£¨ì§€ ëª»í•˜ê³  ë‹¹ë‚˜ë¼ì˜ ì§€ë°°ë¥¼ ë°›ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_no_balhae: { type: 'ending', title: "BAD END: ìƒì–´ë²„ë¦° ë§Œì£¼", desc: "ë°œí•´ê°€ ì„¸ì›Œì§€ì§€ ì•Šì•„ ë§Œì£¼ ì§€ì—­ì˜ ìš°ë¦¬ ì—­ì‚¬ëŠ” ì‚¬ë¼ì¡ŒìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_weakness: { type: 'ending', title: "BAD END: ë‚˜ì•½í•œ êµ­ê°€", desc: "ìŠ¤ìŠ¤ë¡œë¥¼ ì§€í‚¬ í˜ì´ ì—†ëŠ” ë‚˜ë¼ëŠ” ê²°êµ­ ì¡ì•„ë¨¹í˜”ìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_coward: { type: 'ending', title: "BAD END: ë¹„ê²í•œ ë³€ëª…", desc: "ë„ë§ì¹œ ê³³ì— ë‚™ì›ì€ ì—†ìŠµë‹ˆë‹¤. ì—­ì‚¬ëŠ” ë‹¹ì‹ ì„ ê¸°ì–µí•˜ì§€ ì•Šì„ ê²ƒì…ë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_colony_khitan: { type: 'ending', title: "BAD END: ìœ ëª©ë¯¼ì˜ ëª©ì´ˆì§€", desc: "ê³ ë ¤ëŠ” ì‚¬ë¼ì§€ê³  ê±°ë€ì¡±ì˜ ë§ë“¤ì´ ë›°ë…¸ëŠ” ë•…ì´ ë˜ì—ˆìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_traitor: { type: 'ending', title: "BAD END: ì”»ì„ ìˆ˜ ì—†ëŠ” ì˜¤ëª…", desc: "ë§¤êµ­ë…¸ë¼ëŠ” ì´ë¦„ì€ ì˜ì›íˆ ì—­ì‚¬ì— ë‚¨ì„ ê²ƒì…ë‹ˆë‹¤.", unlock: 'traitor', choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_barbaric: { type: 'ending', title: "BAD END: ë¬¸ëª…ì˜ í‡´ë³´", desc: "ì§€ì‹ì„ ì²œì‹œí•œ ê²°ê³¼ êµ­ê°€ëŠ” ì•¼ë§Œ ìƒíƒœë¡œ ëŒì•„ê°”ìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_culture_lost: { type: 'ending', title: "BAD END: ì–¼ë¹ ì§„ ë¯¼ì¡±", desc: "ë§ê³¼ ê¸€, ì •ì‹ ì„ ìƒì–´ë²„ë¦° ë¯¼ì¡±ì—ê²Œ ë¯¸ë˜ëŠ” ì—†ìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_yuan_province: { type: 'ending', title: "BAD END: ì •ë™í–‰ì„±", desc: "ê³ ë ¤ëŠ” ì›ë‚˜ë¼ì˜ ì¼ê°œ í–‰ì •êµ¬ì—­ì´ ë˜ì–´ ì‚¬ë¼ì¡ŒìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_ming_war: { type: 'ending', title: "BAD END: ë¶ˆê°€ëŠ¥í•œ ì „ìŸ", desc: "ì‹ ìƒêµ­ ëª…ë‚˜ë¼ì™€ì˜ ì „ë©´ì „ìœ¼ë¡œ êµ­í† ê°€ í™©íí™”ë˜ê³  ë©¸ë§í–ˆìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_farmer: { type: 'ending', title: "BAD END: í‰ë²”í•œ ë†ë¶€", desc: "ì´ì„±ê³„ê°€ ë‚™í–¥í•˜ì ê³ ë ¤ëŠ” í˜¼ë€ ì†ì— ê¶Œë¬¸ì„¸ì¡±ì˜ ë‚˜ë¼ë¡œ ë‚¨ì•˜ìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_elite_society: { type: 'ending', title: "BAD END: ê·¸ë“¤ë§Œì˜ ë¦¬ê·¸", desc: "ì§€ì‹ì´ ë…ì ëœ ì‚¬íšŒëŠ” ë°œì „í•˜ì§€ ëª»í•˜ê³  ë‚´ë¶€ì—ì„œ ì©ì–´ ë¬¸ë“œëŸ¬ì¡ŒìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_leaderless: { type: 'ending', title: "BAD END: êµ¬ì‹¬ì  ìƒì‹¤", desc: "ì§€ë„ìê°€ ì‚¬ë¼ì§„ êµ­ê°€ëŠ” ëª¨ë˜ì•Œì²˜ëŸ¼ í©ì–´ì¡ŒìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_joseon_fall: { type: 'ending', title: "BAD END: ì¡°ì„ ì˜ ë©¸ë§", desc: "ì¡°ì„  ì™•ì¡°ëŠ” ì—­ì‚¬ ì†ìœ¼ë¡œ ì‚¬ë¼ì¡ŒìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_qing_province: { type: 'ending', title: "BAD END: ì²­ì˜ ì†ë°©", desc: "ì¡°ì„ ì€ ìì£¼êµ­ì´ ì•„ë‹Œ ì²­ë‚˜ë¼ì˜ ì§€ë°© ì •ê¶Œì´ ë˜ì—ˆìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] },
            end_assimilation: { type: 'ending', title: "BAD END: ë‚´ì„ ì¼ì²´", desc: "ë…ë¦½ ì˜ì§€ê°€ êº¾ì—¬ ì¼ë³¸ì¸ìœ¼ë¡œ ë™í™”ë˜ì—ˆìŠµë‹ˆë‹¤. í•œêµ­ì€ ì˜ì˜ ì‚¬ë¼ì¡ŒìŠµë‹ˆë‹¤.", choices: [{ text: "ë‹¤ì‹œ ë„ì „", next: "start", style: "restart" }] }
        };

        // ì˜¬ë°”ë¥¸ ì„ íƒì— ëŒ€í•œ ê²°ê³¼ ì„œìˆ ì„ ì¼ê´„ ê´€ë¦¬ (í…ìŠ¤íŠ¸ ê¸°ì¤€ ë§¤ì¹­)
        const choiceResultOverrides = {
            "ì‘¥ê³¼ ë§ˆëŠ˜ì„ ì£¼ë©° 100ì¼ê°„ ë™êµ´ì—ì„œ ì¸ë‚´í•˜ë¼ê³  í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì¸ë‚´ì˜ ì‹œí—˜ í†µê³¼",
                desc: "ê³°ì´ ì¸ë‚´ë¥¼ ëê¹Œì§€ ê²¬ë””ë©° ì¸ê°„ìœ¼ë¡œ ê±°ë“­ë‚¬ìŠµë‹ˆë‹¤. í™˜ì›…ì˜ ëœ»ì— í˜¸ì‘í•˜ëŠ” ì²« ë°±ì„±ì´ íƒ„ìƒí•´ ì‹ ì‹œì˜ ì§ˆì„œê°€ ì„¸ì›Œì¡ŒìŠµë‹ˆë‹¤."
            },
            "ì•ì„ ê°€ë¡œë§‰ëŠ” ê°•(ì—„ë¦¬ëŒ€ìˆ˜)ìœ¼ë¡œ ë‹¬ë ¤ê°€ í•˜ëŠ˜ì— ê¸°ë„ë¥¼ ì˜¬ë¦°ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: í•˜ëŠ˜ì´ ì—° íƒˆì¶œë¡œ",
                desc: "ë¬¼ê³ ê¸°ì™€ ìë¼ê°€ ê¸¸ì„ ì—´ì–´ ì£¼ëª½ì´ ê°•ì„ ê±´ë„œìŠµë‹ˆë‹¤. í•˜ëŠ˜ì´ ë„ìš´ íƒˆì¶œë¡œ ê³ êµ¬ë ¤ ê±´êµ­ì˜ ë¶ˆì”¨ê°€ ì‚´ì•„ë‚¬ìŠµë‹ˆë‹¤."
            },
            "ìœ„í—˜ì„ ë¬´ë¦…ì“°ê³  í¬ìœ„ë§ì„ ëš«ê³  ê°•ìœ¼ë¡œ ë‹¬ë¦°ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: í¬ìœ„ë§ ëŒíŒŒ",
                desc: "ëª©ìˆ¨ì„ ê±´ ëŒíŒŒë¡œ ê°•ê°€ì— ë„ì°©í–ˆìŠµë‹ˆë‹¤. ì¶”ê²©ì„ ë”°ëŒë¦¬ê³  ê±´êµ­ì˜ ê¸°íšŒë¥¼ ë‹¤ì‹œ ì¡ì•˜ìŠµë‹ˆë‹¤."
            },
            "ë§ì„ ë²„ë¦¬ê³  ì•”ë²½ì„ íƒ€ê³  ë‚´ë ¤ê°€ ê°• ìª½ìœ¼ë¡œ í–¥í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì ˆë²½ì„ ë„˜ì–´ ìƒì¡´",
                desc: "í—˜í•œ ì ˆë²½ì„ ê¸°ì–´ ë‚´ë ¤ ê°•ìœ¼ë¡œ í–¥í•˜ë©° ì¶”ê²©ì„ ëŠì–´ëƒˆìŠµë‹ˆë‹¤. ì‚´ì•„ë‚¨ì€ ì£¼ëª½ì€ ë‹¤ì‹œ êµ­ê°€ ê±´êµ­ì„ ì¤€ë¹„í•©ë‹ˆë‹¤."
            },
            "í™œ ì˜ê¸°ì™€ ê¸°ë§ˆìˆ ì„ ì¤‘ì‹œí•˜ëŠ” ìƒë¬´ ì •ì‹ ìœ¼ë¡œ 'ê³ êµ¬ë ¤'ë¥¼ ì„¸ìš´ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ìƒë¬´ ì •ì‹ ì˜ ê³ êµ¬ë ¤",
                desc: "í™œì˜ê¸°ì™€ ê¸°ë§ˆìˆ ì„ ì¤‘ì‹œí•œ ìƒë¬´ ì •ì‹ ì„ ì¤‘ì‹¬ìœ¼ë¡œ, ê³ êµ¬ë ¤ëŠ” ë¶ë°©ì˜ ê°•ë ¥í•œ ê¸°ë§ˆ ì œêµ­ìœ¼ë¡œ ìë¦¬ì¡ì•˜ìŠµë‹ˆë‹¤."
            },
            "ì‹ ë¼ì˜ ë°•í˜ê±°ì„¸, ë°±ì œì˜ ì˜¨ì¡°ì™€ í•¨ê»˜ ì•Œì—ì„œ íƒœì–´ë‚œ ì‹ ì„±í•¨ì„ ê°•ì¡°í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì²œì†ì˜ ìœ„ëª…",
                desc: "ì•Œì—ì„œ íƒœì–´ë‚œ ì‹ í™”ë¥¼ ë‚´ì„¸ì›Œ ë°±ì„±ì˜ ê²°ì†ì„ ë‹¤ì¡ŒìŠµë‹ˆë‹¤. ê³ êµ¬ë ¤ëŠ” ì‹ ì„±í•œ ê¶Œìœ„ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë¶ë°© ê°•êµ­ìœ¼ë¡œ ì„±ì¥í•©ë‹ˆë‹¤."
            },
            "ë¹¼ì•—ê¸´ ê²ƒì„ ë˜ì°¾ê¸° ìœ„í•´ êµ°ì‚¬ë¥¼ ê¸°ë¥´ê³  êµ­ë°©ì„ ê°•í™”í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì•½ì†Œêµ­ì˜ ê°ì„±",
                desc: "êµ°ì‚¬ë¥¼ ê¸¸ëŸ¬ êµ­ê²½ì„ ë˜ì°¾ê³  ì•½íƒˆì„ ë§‰ì•˜ìŠµë‹ˆë‹¤. ë°±ì„±ë“¤ì€ ë‹¤ì‹œ ì‚¶ì˜ í„°ì „ì„ ì§€í‚¬ í˜ì„ ì–»ì—ˆìŠµë‹ˆë‹¤."
            },
            "ë¶ìœ¼ë¡œ ê³ êµ¬ë ¤ë¥¼ ê²¬ì œí•˜ê³ , ë°”ë‹¤ ê±´ë„ˆ ì¤‘êµ­(ìš”ì„œ)ê³¼ ì¼ë³¸(ê·œìŠˆ)ìœ¼ë¡œ ì§„ì¶œí•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: í•´ìƒ ë„¤íŠ¸ì›Œí¬ êµ¬ì¶•",
                desc: "í•œê°•ê³¼ ë°”ë‹¤ë¥¼ ë¬´ëŒ€ë¡œ êµì—­ê³¼ ì •ë³µì„ ë³‘í–‰í•˜ë©° ë°±ì œì˜ êµ­ë ¥ì´ ì ˆì •ì— ë‹¬í–ˆìŠµë‹ˆë‹¤."
            },
            "ë‹¤ì‹œ ë°”ë‹·ê¸¸ì„ ì—´ê³  í™œë°œí•œ ì •ë³µ í™œë™ì„ ì‹œì‘í•˜ì—¬ ê·€ì¡±ë“¤ì˜ ë¶ˆë§Œì„ ì ì¬ìš´ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ë°”ë‹¤ë¡œ í‘¸ëŠ” êµ­ë ¥",
                desc: "í•´ìƒ ì§„ì¶œê³¼ ì •ë³µìœ¼ë¡œ ì „ë¦¬í’ˆê³¼ êµì—­ì´ ë˜ì‚´ì•„ë‚˜ ê·€ì¡±ë“¤ì˜ ë¶ˆë§Œì´ ì ì¬ë˜ê³  êµ­ë ¥ì´ íšŒë³µë˜ì—ˆìŠµë‹ˆë‹¤."
            },
            "êµ°ëŒ€ë¥¼ ê¸‰íˆ ëŒë ¤ ê³ êµ¬ë ¤êµ°ì„ ë§‰ì•„ë‚´ê³  ì „ì„ ì„ ì¬ì •ë¹„í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ë¹ˆì§‘ì„ ì§€í‚¨ ê²°ë‹¨",
                desc: "ëŒì•„ì˜¨ êµ°ëŒ€ê°€ ìˆ˜ë„ë¥¼ ì§€ì¼œëƒˆê³ , êµ­ê²½ ë°©ì–´ì„ ì´ ì¬ì •ë¹„ë˜ì–´ ë‚˜ë¼ê°€ ë¬´ë„ˆì§€ëŠ” ê²ƒì„ ë§‰ì•˜ìŠµë‹ˆë‹¤."
            },
            "ë¶ìœ¼ë¡œ ë§Œì£¼ë¥¼ í˜¸ë ¹í•˜ê³ , ë‚¨ìœ¼ë¡œ ë‚´ë ¤ê°€ ì‹ ë¼ë¥¼ ê´´ë¡­íˆëŠ” ì™œêµ¬ë¥¼ ê²©í‡´í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì‚¬ë°©ì„ ì œì••í•œ íŒ¨ì",
                desc: "ë§Œì£¼ì™€ í•œë°˜ë„ ë‚¨ë¶€ë¥¼ ì•„ìš°ë¥´ëŠ” êµ°ëŒ€ì˜ ì§„ì¶œë¡œ ê³ êµ¬ë ¤ì˜ ìœ„ì„¸ê°€ ë†’ì•„ì§€ê³  ì‹ ë¼ëŠ” ë³´í˜¸ë¥¼ ë°›ì•˜ìŠµë‹ˆë‹¤."
            },
            "ë°°ì‹ ì ë°±ì œë¥¼ ì‘ì§•í•˜ê³  í•œê°• ì´ë¶ì˜ íŒ¨ê¶Œì„ í™•ê³ íˆ í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: í•œê°• íŒ¨ê¶Œ ì¥ì•…",
                desc: "ë°±ì œì˜ ë°°ì‹ ì„ ì‘ì§•í•˜ê³  í•œê°• ì´ë¶ì„ ì§€ì¼œ ì‚¼êµ­ ê· í˜•ì„ ë‹¤ì‹œ ë°”ë¡œì¡ì•˜ìŠµë‹ˆë‹¤."
            },
            "ìš•ì‹¬ì„ ë²„ë¦¬ê³  ì‹ ì†íˆ ì² êµ°í•˜ì—¬ ìš”ë™ ë°©ì–´ì„ ì„ êµ³ê±´íˆ í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ë³´ê¸‰ì„  ì‚¬ìˆ˜",
                desc: "ë¬´ë¦¬í•œ ì§„ê²©ì„ ì ‘ê³  ë°©ì–´ì„ ì— ì§‘ì¤‘í•´ êµ­ë ¥ì„ ì§€ì¼°ìŠµë‹ˆë‹¤. ë‹¤ìŒ ì›ì •ì„ ìœ„í•œ í˜ì´ ì¶•ì ë©ë‹ˆë‹¤."
            },
            "í™”ë‘ë„ë¥¼ êµ­ê°€ì  ì¡°ì§ìœ¼ë¡œ í‚¤ìš°ê³ , ì¤‘êµ­ê³¼ ì§ì ‘ êµë¥˜í•˜ì—¬ ì‚¼êµ­ í†µì¼ì˜ ê¸°ë°˜ì„ ë‹¦ëŠ”ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: í™”ë‘ê³¼ ì™¸êµì˜ í˜",
                desc: "í™”ë‘ë„ë¥¼ êµ­ê°€ ì¡°ì§ìœ¼ë¡œ í‚¤ì›Œ ì „ì‚¬ì™€ í–‰ì • ì¸ì¬ë¥¼ ì–‘ì„±í•˜ê³ , êµë¥˜ë¡œ ì–»ì€ ì§€ì‹ì´ ì‚¼êµ­ í†µì¼ì˜ ë°œíŒì´ ë˜ì—ˆìŠµë‹ˆë‹¤."
            },
            "ëŠ¦ê²Œë‚˜ë§ˆ ë™ë§¹ì„ ê¹¨ê³  í•œê°• ìœ ì—­ì„ ê³µê²©í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: í•œê°• ì¬íƒˆí™˜",
                desc: "í•œê°•ì„ ë˜ì°¾ì•„ í•´ìƒÂ·ë‚´ë¥™ êµí†µë¡œë¥¼ í™•ë³´í–ˆê³ , ì‹ ë¼ëŠ” ë‹¤ì‹œ ì„±ì¥ ê¶¤ë„ì— ì˜¬ëìŠµë‹ˆë‹¤."
            },
            "ê±°ì§“ íŒ¨ë°°ë¡œ ì ì„ ê¹Šìˆ™ì´ ìœ ì¸í•˜ì—¬ ì§€ì¹˜ê²Œ í•œ ë’¤, ì‚´ìˆ˜(ê°•)ë¥¼ ê±´ë„ ë•Œ ìˆ˜ì¥ì‹œí‚¨ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì‚´ìˆ˜ëŒ€ì²©ì˜ ê¸°ì ",
                desc: "ìœ ì¸ê³¼ ë§¤ë³µìœ¼ë¡œ ìˆ˜ë‚˜ë¼ ëŒ€êµ°ì„ ê°•ì—ì„œ ëª°ì‚´ì‹œì¼œ ê³ êµ¬ë ¤ë¥¼ ì§€ì¼œëƒˆìŠµë‹ˆë‹¤. ì´í›„ ìˆ˜ë‚˜ë¼ëŠ” ê³„ì†ëœ ê³ êµ¬ë ¤ ì¹¨ëµ ì‹¤íŒ¨ë¡œ ë©¸ë§í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤."
            },
            "ì ì¥ ìš°ì¤‘ë¬¸ì—ê²Œ ê±°ì§“ í•­ë³µ í¸ì§€ë¥¼ ë³´ë‚´ ë°©ì‹¬ì‹œí‚¨ í‹ˆì„ íƒ€ ê¸°ìŠµí•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: í‰ì–‘ì„± ì—­ìŠµ",
                desc: "ê¸°ë§Œ ì „ìˆ ë¡œ ì ì„ ë°©ì‹¬ì‹œì¼œ í¬ìœ„ë¥¼ í’€ê³  ë°˜ê²©ì— ì„±ê³µí–ˆìŠµë‹ˆë‹¤."
            },
            "ì™¸ì„¸ì˜ ì§€ë°°ë¥¼ ë°›ì„ ìˆœ ì—†ë‹¤. ë‹¹ë‚˜ë¼ì™€ ì „ìŸì„ ë²Œì—¬ ê·¸ë“¤ì„ ëª°ì•„ë‚¸ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ìì£¼ í†µì¼ ì™„ì„±",
                desc: "ë‚˜ë‹¹ì „ìŸì„ ìŠ¹ë¦¬ë¡œ ë§ˆì¹˜ë©° ë‹¹ë‚˜ë¼ êµ°ëŒ€ë¥¼ ëª°ì•„ëƒˆê³ , í•œë°˜ë„ì—ì„œ ì§„ì •í•œ í†µì¼ì„ ì´ë£¨ì–´ëƒˆìŠµë‹ˆë‹¤."
            },
            "ìœ ë¯¼ë“¤ì„ í¬ìš©í•˜ê³  í˜ì„ í•©ì³ ë‹¹ë‚˜ë¼ë¥¼ ëª°ì•„ë‚´ìê³  ì„¤ë“í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ë™ì¡± ì—°í•©",
                desc: "ê³ êµ¬ë ¤ ìœ ë¯¼ì„ í¬ìš©í•´ ì „ì„ ì„ ë„“íˆì§€ ì•Šê³ , í˜ì„ ëª¨ì•„ ë‹¹ë‚˜ë¼ì— ë§ì„œ ìì£¼ í†µì¼ì„ ì´ëŒì—ˆìŠµë‹ˆë‹¤."
            },
            "ë‚˜ë¼ ì´ë¦„ì„ 'ë°œí•´'ë¼ í•˜ê³ , ë‹¹ë‹¹íˆ ê³ êµ¬ë ¤ ê³„ìŠ¹ì„ ì²œëª…í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: í•´ë™ì„±êµ­ì˜ íƒ„ìƒ",
                desc: "ê³ êµ¬ë ¤ì˜ ì •í†µì„ ì‡ëŠ” ë°œí•´ê°€ ì„¸ì›Œì ¸ ë§Œì£¼ì™€ ì—°í•´ì£¼ë¥¼ ì•„ìš°ë¥´ëŠ” í•´ë™ì„±êµ­ìœ¼ë¡œ ì„±ì¥í•©ë‹ˆë‹¤."
            },
            "ê³ êµ¬ë ¤ì™€ ë§ê°ˆì„ ì•„ìš°ë¥´ëŠ” ìœµí•© ì •ì±…ì„ í´ì„œ ëª¨ë‘ë¥¼ í¬ìš©í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: í†µí•©ì˜ êµ­ë ¥",
                desc: "ê³ êµ¬ë ¤ ìœ ë¯¼ê³¼ ë§ê°ˆ ì„¸ë ¥ì´ í•˜ë‚˜ë¡œ ë­‰ì³ êµ­ë ¥ì´ ëª¨ì˜€ê³ , ë°œí•´ëŠ” ì•ˆì •ì ìœ¼ë¡œ ì„±ì¥í•  ê¸°ë°˜ì„ ì–»ì—ˆìŠµë‹ˆë‹¤."
            },
            "í­ì •ì„ ì¼ì‚¼ëŠ” ê¶ì˜ˆë¥¼ ëª°ì•„ë‚´ê³ , ë•ë§ ë†’ì€ ì™•ê±´ì„ ìƒˆ ì™•ìœ¼ë¡œ ì¶”ëŒ€í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ê³ ë ¤ ê±´êµ­ì˜ ê¸¸",
                desc: "ë¯¼ì‹¬ì„ ìƒì€ ê¶ì˜ˆë¥¼ ì¶•ì¶œí•˜ê³  ì™•ê±´ì„ ì™•ìœ¼ë¡œ ì˜¹ë¦½í•´ í›„ì‚¼êµ­ í†µì¼ì˜ ì£¼ë„ê¶Œì„ ì¡ì•˜ìŠµë‹ˆë‹¤."
            },
            "ê²¬í›¤ì˜ ë§Œí–‰ì„ ê·œíƒ„í•˜ê³ , ì‹ ë¼ì˜ ìœ ë¯¼ë“¤ì„ ë³´í˜¸í•˜ë©° ë¯¼ì‹¬ì„ ë˜ëŒë¦°ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ë¯¼ì‹¬ íšŒë³µ",
                desc: "í”¼ë‚œë¯¼ì„ ë³´í˜¸í•´ ì‹ ë¢°ë¥¼ ì–»ì—ˆê³ , ê²¬í›¤ì˜ í­ì •ì„ ë¹„íŒí•˜ë©° í†µí•© ì„¸ë ¥ì„ ëª¨ì•˜ìŠµë‹ˆë‹¤."
            },
            "ì •ëµ ê²°í˜¼ìœ¼ë¡œ í˜¸ì¡±ë“¤ì„ ê°€ì¡±ìœ¼ë¡œ ë§Œë“¤ê³ , ë¶ì§„ ì •ì±…ìœ¼ë¡œ ë¹„ì „ì„ ì œì‹œí•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: í˜¸ì¡± ì—°í•© êµ­ê°€",
                desc: "ê²°í˜¼ì„ í†µí•´ í˜¸ì¡±ë“¤ê³¼ ê°€ì¡±ì´ ë˜ë©´ì„œ í˜¸ì¡±ë“¤ì„ ì™•ì˜ í¸ìœ¼ë¡œ í¬ì„­í•˜ê³  ë¶ì§„ ì •ì±…ì„ ì œì‹œí•´ ë‚˜ë¼ ì „ì²´ë¥¼ í†µí•©í•˜ì˜€ìŠµë‹ˆë‹¤. ê³ ë ¤ ë°œì „ì˜ í† ëŒ€ê°€ ë§ˆë ¨ë˜ì—ˆìŠµë‹ˆë‹¤."
            },
            "ì—¬ëŸ¬ ì œë„ë¥¼ í†µí•´ ê·¸ë“¤ì—ê²Œ ì±…ì„ì„ ì£¼ê³  ë‹¬ëœë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ë°˜ë€ ìˆ˜ìŠµ",
                desc: "ë‹¤ì–‘í•œ ì œë„ë¡œ í˜¸ì¡±ì„ ê´€ë¦¬í•˜ë©° ë°˜ë€ì„ ì§„ì •ì‹œí‚¤ê³  ì™•ê¶Œì„ ì§€ì¼°ìŠµë‹ˆë‹¤."
            },
            "ê³¼ê±°ì œë¥¼ ë„ì…í•˜ì—¬ ì‹ ë¶„ì— ìƒê´€ì—†ì´ ëŠ¥ë ¥ ìˆëŠ” ì¸ì¬ë¥¼ ë½‘ëŠ”ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ëŠ¥ë ¥ ë³¸ìœ„ ì¸ì¬ ë“±ìš©",
                desc: "ê³¼ê±°ì œë¡œ ì‹ ë¶„ ì¥ë²½ì„ ë‚®ì¶”ê³  ìœ ëŠ¥í•œ ì¸ì¬ë¥¼ ë“±ìš©í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ìƒˆ ë‚˜ë¼ ê³ ë ¤ì—ì„œëŠ” ëŠ¥ë ¥ ìˆëŠ” ì‹ í•˜ë“¤ì´ í™œì•½í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤."
            },
            "ê±°ë€ì´ ì†¡ë‚˜ë¼ì™€ì˜ ê´€ê³„ë¥¼ ëŠê¸¸ ì›í•¨ì„ ê°„íŒŒí•˜ê³ , ë‹´íŒì„ í†µí•´ ê°•ë™ 6ì£¼ë¥¼ ì–»ì–´ë‚¸ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì™¸êµë¡œ ì–»ì€ ì˜í† ",
                desc: "ì„œí¬ì˜ í™œì•½ìœ¼ë¡œ ê°•ë™ 6ì£¼ë¥¼ í™•ë³´í•´ ì „ìŸ ì—†ì´ êµ­í† ë¥¼ ë„“íˆê³  ë°©ì–´ì„ ì„ ê°•í™”í–ˆìŠµë‹ˆë‹¤."
            },
            "ê°•ë¬¼ì„ ë§‰ì•„ ì ì„ í˜¼ë€ì‹œí‚¨ ë’¤, ë§¤ë³µí•œ êµ°ì‚¬ë¡œ ê¶¤ë©¸ì‹œí‚¨ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ê·€ì£¼ ëŒ€ì²©ì˜ ì™„ì„±",
                desc: "ê°•ë¬¼ì„ ë§‰ì•„ ê±°ë€êµ°ì„ í˜¼ë€ì— ë¹ ëœ¨ë¦° ë’¤ ë§¤ë³µìœ¼ë¡œ ì„¬ë©¸í•˜ì—¬ ê·€ì£¼ ëŒ€ì²©ì˜ ìŠ¹ë¦¬ë¥¼ ê±°ë’€ìŠµë‹ˆë‹¤. ê³ ë ¤ëŠ” ë¶ë°© ìœ„í˜‘ì„ ì ì‹œ ëˆ„ê·¸ëŸ¬ëœ¨ë¦´ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤."
            },
            "ì§€ê¸ˆì´ë¼ë„ ê°•ê²½í•˜ê²Œ ë§ì„œ ì‹¸ìš°ê³  ì™¸êµì  ì‹¤ë¦¬ë¥¼ ì°¾ëŠ”ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì¬ì¹¨ ëŒ€ë¹„",
                desc: "ì–‘ë³´ë¥¼ ê±°ë‘ê³  ë°©ì–´ë¥¼ ê°•í™”í•´ ê±°ë€ì˜ ì¶”ê°€ ìš”êµ¬ë¥¼ ì°¨ë‹¨í–ˆìŠµë‹ˆë‹¤."
            },
            "ê°ì§€ì—ì„œ ì˜ë³‘ì„ ëª¨ì•„ ì ì˜ ë³´ê¸‰ë¡œë¥¼ ëŠê³  ëˆì§ˆê¸°ê²Œ ë°˜ê²©í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ìˆ˜ë„ íƒˆí™˜",
                desc: "ì˜ë³‘ê³¼ ì •ê·œêµ°ì´ í˜‘ë ¥í•´ ë³´ê¸‰ë¡œë¥¼ ëŠê³  ê°œê²½ì„ ë˜ì°¾ì•˜ìŠµë‹ˆë‹¤."
            },
            "ì‹ ê¸°êµ°(ê¸°ë³‘), ì‹ ë³´êµ°(ë³´ë³‘), í•­ë§ˆêµ°(ìŠ¹ë³‘)ìœ¼ë¡œ êµ¬ì„±ëœ íŠ¹ìˆ˜ ë¶€ëŒ€ 'ë³„ë¬´ë°˜'ì„ ì¡°ì§í•˜ì—¬ ì—¬ì§„ì„ ì •ë²Œí•˜ê³  9ì„±ì„ ìŒ“ëŠ”ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ë³„ë¬´ë°˜ ì°½ì„¤",
                desc: "ê¸°ë³‘Â·ë³´ë³‘Â·ìŠ¹ë³‘ì´ ì¡°í™”ë¥¼ ì´ë£¬ ë³„ë¬´ë°˜ì´ ì—¬ì§„ì„ ì œì••í•˜ê³  9ì„±ì„ ìŒ“ì•„ ë¶ë°©ì„ ì•ˆì •ì‹œì¼°ìŠµë‹ˆë‹¤."
            },
            "ì§€ê¸ˆì´ë¼ë„ ë³„ë¬´ë°˜ì„ ì¡°ì§í•˜ì—¬ ê°•ë ¥í•œ í† ë²Œì— ë‚˜ì„ ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: êµ­ê²½ ì¬ì •ë¹„",
                desc: "ëŠ¦ì—ˆì§€ë§Œ ë³„ë¬´ë°˜ì„ í¸ì„±í•´ ì•½íƒˆì„ ë§‰ê³  êµ­ê²½ ë°©ì–´ë¥¼ íšŒë³µí–ˆìŠµë‹ˆë‹¤."
            },
            "ë¶€ì²˜ì˜ í˜ìœ¼ë¡œ êµ­ë‚œì„ ê·¹ë³µí•˜ê³ ì íŒ”ë§ŒëŒ€ì¥ê²½ì„ ë§Œë“¤ê³ , ì‚¼ë³„ì´ˆëŠ” ëê¹Œì§€ í•­ì „í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì‹ ì•™ê³¼ í•­ì „ì˜ ë‘ ì¶•",
                desc: "íŒ”ë§ŒëŒ€ì¥ê²½ìœ¼ë¡œ ë¯¼ì‹¬ì„ ëª¨ì•„ ëª½ê³¨ì— ëŒ€í•­í•˜ëŠ” ì •ì‹ ì„ ë“œë†’ì´ê³ , ì‚¼ë³„ì´ˆëŠ” ëê¹Œì§€ ëª½ê³¨ê³¼ ë§ì„œ ì‹¸ì›Œ ê³ ë ¤ì˜ ìì¡´ì‹¬ì„ ì§€í‚¤ë ¤ê³  ìµœì„ ì„ ë‹¤í–ˆìŠµë‹ˆë‹¤."
            },
            "ìì£¼ì„±ì„ ë˜ì°¾ê¸° ìœ„í•œ ì›€ì§ì„(ì‚¼ë³„ì´ˆ ë“±)ì„ ì§€ì›í•˜ê³  ì „í†µì„ ì§€í‚¨ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ë¬¸í™”ì™€ ì •ì‹ ì˜ ë³´ì¡´",
                desc: "ëª½ê³¨í’ì„ ê±°ë¶€í•˜ê³  ìì£¼ì„±ì„ ì§€í‚¤ë©° ê³ ë ¤ì˜ ì „í†µê³¼ ì •ì‹ ì„ ë˜ì‚´ë ¸ìŠµë‹ˆë‹¤."
            },
            "ì‚´ì•„ë‚¨ì€ ë³‘ë ¥ì„ ìˆ˜ìŠµí•˜ì—¬ ë³¸êµ­ìœ¼ë¡œ ëŒì•„ì™€ ë‚´ì‹¤ì„ ë‹¤ì§„ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì†ì‹¤ í›„ ì¬ê±´",
                desc: "ë¬´ëª¨í•œ ì›ì •ì„ ì ‘ê³  ë³‘ë ¥ì„ ë°ë¦¬ê³  ì™€ ë¯¸ë˜ì— ëª½ê³¨ì— ë°˜ê²©í•˜ê¸° ìœ„í•œ í˜ì„ ë³´ì¡´í•˜ì—¿ìŠµë‹ˆë‹¤."
            },
            "ì¹œì› ì„¸ë ¥(ì›ë‚˜ë¼ë‘ ì¹œí•˜ê²Œ ì§€ë‚´ìê³  ì£¼ì¥í•˜ëŠ” ì„¸ë ¥)ì„ ìˆ™ì²­í•˜ê³ , ë¹¼ì•—ê¸´ ì˜í† ë¥¼ ë˜ì°¾ëŠ”ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ìì£¼ ê°œí˜",
                desc: "ì¹œì› ì„¸ë ¥ì„ ëˆ„ë¥´ê³  ìƒì—ˆë˜ ëª½ê³¨ê³¼ ì „ìŸì„ ë²Œì—¬ ìƒì–´ë²„ë¦° ì˜í† ë¥¼ íšŒë³µí•˜ì˜€ìŠµë‹ˆë‹¤. ê³ ë ¤ì˜ ë¬´ë„ˆì§„ ìì¡´ì‹¬ì´ ì¼ë¶€ íšŒë³µë˜ì—ˆìŠµë‹ˆë‹¤."
            },
            "ì‹ ëˆì„ ì œê±°í•˜ê³  ë‹¤ì‹œ ì™•ì´ ë˜ì–´ ì§ì ‘ ê°œí˜ì„ ì£¼ë„í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ê°œí˜ì˜ ì£¼ë„ê¶Œ íšŒë³µ",
                desc: "ì‹ ëˆì„ ëª°ì•„ë‚´ê³  ì™•ì´ ë‹¤ì‹œ ë³µê·€í•˜ì—¬ ê°œí˜ì„ ì´ëŒì–´ ì¡°ì •ì„ ì•ˆì •ì‹œì¼°ìŠµë‹ˆë‹¤."
            },
            "4ê°€ì§€ ë¶ˆê°€ë¡ ì„ ë‚´ì„¸ì›Œ êµ°ëŒ€ë¥¼ ëŒë ¤(íšŒêµ°) ì •ê¶Œì„ ì¡ëŠ”ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: íšŒêµ°ì˜ ê²°ë‹¨",
                desc: "ìœ„í™”ë„ íšŒêµ°ìœ¼ë¡œ ì´ì„±ê³„ëŠ” ê³ ë ¤ë¥¼ ì¥ì•…í•˜ì˜€ìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ìœ„í™”ë„ íšŒêµ°ì„ ë°”íƒ•ìœ¼ë¡œ ì´ì„±ê³„ëŠ” ìƒˆë¡œìš´ ë‚˜ë¼, ì¡°ì„ ì„ ê±´êµ­í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤."
            },
            "ì‹ ë¶„ë³´ë‹¤ ëŠ¥ë ¥ì´ ìš°ì„ ì´ë‹¤. ì¥ì˜ì‹¤ì„ ë“±ìš©í•˜ì—¬ ìê²©ë£¨, ì¸¡ìš°ê¸° ë“±ì„ ë§Œë“¤ê²Œ í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ê³¼í•™ ì™•êµ­ì˜ ì‹œì‘",
                desc: "ì„¸ì¢…ëŒ€ì™•ì€ ì¥ì˜ì‹¤ì„ ì¤‘ìš©í•´ ê³¼í•™ê¸°êµ¬ë¥¼ ë°œëª…í–ˆê³ , ë°±ì„±ì˜ ì‚¶ì„ ê°œì„ í•˜ëŠ” ê¸°ìˆ  êµ­ê°€ì˜ ê¸¸ì„ ì—´ì—ˆìŠµë‹ˆë‹¤."
            },
            "ì§€ê¸ˆì´ë¼ë„ ì¸ì¬ë¥¼ ë„ë¦¬ ì°¾ì•„ ê³¼í•™ ê¸°êµ¬ë¥¼ ê°œë°œí•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ë’¤ëŠ¦ì€ ê¸°ìˆ  ë°˜ë“±",
                desc: "ì‹ ë¶„ì„ ë”°ì§€ì§€ ì•Šê³  ì¸ì¬ë¥¼ ëª¨ì•„ ê³¼í•™ì„ ì¼ìœ¼ì¼œ ê°€ë­„Â·í™ìˆ˜ì— ëŒ€ë¹„í•  í˜ì„ í‚¤ì› ìŠµë‹ˆë‹¤."
            },
            "ë°±ì„±ì„ ê°€ë¥´ì¹˜ëŠ” ë°”ë¥¸ ì†Œë¦¬, 'í›ˆë¯¼ì •ìŒ'ì„ ì°½ì œí•˜ê³  ë°˜í¬í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ê¸€ë¡œ ì„¸ìš´ ë¯¼ë³¸",
                desc: "í›ˆë¯¼ì •ìŒì´ ë°˜í¬ë˜ì–´ ë°±ì„±ì´ ê¸€ì„ ë°°ìš°ê³  ì–µìš¸í•¨ì„ ìŠ¤ìŠ¤ë¡œ í˜¸ì†Œí•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤."
            },
            "ì§€ê¸ˆì´ë¼ë„ í•œê¸€ì„ ë§Œë“¤ê³  ë³´ê¸‰í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ë’¤ëŠ¦ì€ ë¬¸ì í˜ì‹ ",
                desc: "ëŠ¦ì—ˆì§€ë§Œ ì‰¬ìš´ ê¸€ìë¥¼ ë³´ê¸‰í•´ ì§€ì‹ì´ ì–‘ë°˜ì˜ ì „ìœ ë¬¼ì´ ë˜ëŠ” ê²ƒì„ ë§‰ì•˜ìŠµë‹ˆë‹¤."
            },
            "í•œì‚°ë„ ì•ë°”ë‹¤ë¡œ ì ì„ ìœ ì¸í•´ í•™ìµì§„ì„ í¼ì³ ê¶¤ë©¸ì‹œí‚¤ê³  ë³´ê¸‰ë¡œë¥¼ ëŠëŠ”ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì œí•´ê¶Œ ì¥ì•…",
                desc: "ì´ìˆœì‹  ì¥êµ°ê»˜ì„œ í•™ìµì§„ìœ¼ë¡œ ì¼ë³¸ ìˆ˜êµ°ì„ ê¶¤ë©¸ì‹œí‚¤ê³  ë°”ë‹¤ë¥¼ ì¥ì•…í•˜ì˜€ìŠµë‹ˆë‹¤. ì´ìˆœì‹  ì¥êµ°ì˜ í™œì•½ìœ¼ë¡œ ì¼ë³¸êµ°ì€ ë³´ê¸‰ë¡œê°€ ëŠê²¼ê³ , ì¡°ì„ ì´ ìœ¡ì§€ì—ì„œ ë°˜ê²©í•  ìˆ˜ ìˆëŠ” ê¸°íšŒê°€ ì£¼ì–´ì§€ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ìˆœì‹  ì¥êµ°ì€ ì¡°ì„ ì—ì„œ íŒ¨í•˜ê³  ëŒì•„ê°€ëŠ” ë…¸ëŸ‰í•´ì „ì—ì„œ ì¼ë³¸êµ°ì— í° ìŠ¹ë¦¬ë¥¼ ê±°ë‘ê³  ì „ì‚¬í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤."
            },
            "ìˆ˜êµ°ì„ ì¬ê±´í•˜ì—¬ ë°”ë‹¤ì—ì„œ ë‹¤ì‹œ ìŠ¹ë¦¬ë¥¼ ê±°ë‘ì–´ ì „ì„¸ë¥¼ ë’¤ì§‘ëŠ”ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ë°”ë‹¤ë¥¼ ë˜ì°¾ë‹¤",
                desc: "í©ì–´ì§„ ìˆ˜êµ°ì„ ëª¨ì•„ ì œí•´ê¶Œì„ íšŒë³µí–ˆê³ , ì¡°ì„ ì˜ ìˆ¨í†µì´ ë‹¤ì‹œ íŠ¸ì˜€ìŠµë‹ˆë‹¤."
            },
            "ëª…ì— êµ°ëŒ€ë¥¼ ë³´ë‚´ë˜, í›„ê¸ˆì—ëŠ” ì‹¸ìš¸ ëœ»ì´ ì—†ìŒì„ ì•Œë¦¬ëŠ” ì¤‘ë¦½ ì™¸êµë¥¼ í¼ì¹œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì‹¤ë¦¬ ì™¸êµ ì„±ê³µ",
                desc: "ëª…ê³¼ í›„ê¸ˆ ì‚¬ì´ì—ì„œ ì¤‘ë¦½ì„ ì§€ì¼œ êµ­í† ë¥¼ ì „ìŸí„°ë¡œ ë§Œë“¤ì§€ ì•Šê³  êµ­ë ¥ì„ ë³´ì¡´í–ˆìŠµë‹ˆë‹¤."
            },
            "ê°•í™”ë„ë¡œ í”¼ì‹ í•˜ì—¬ í•­ì „í•˜ë©° í›—ë‚ ì„ ë„ëª¨í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì „ë ¥ ë³´ì¡´",
                desc: "ê°•í™”ë„ë¡œ í”¼ì‹ í•´ ì „ë©´ ë¶•ê´´ë¥¼ ë§‰ê³  ì¬ê±´ì˜ ì‹œê°„ì„ ë²Œì—ˆìŠµë‹ˆë‹¤."
            },
            "ì•ìœ¼ë¡œ ëª…ë‚˜ë¼ë¥¼ ì¡´ì¤‘í•  ê²ƒì´ë¼ í•´ëª…í•˜ê³  ì‹¤ë¦¬ë¥¼ ì±™ê¸´ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ê°ˆë“± ì™„í™”",
                desc: "ì™¸êµì ìœ¼ë¡œ í•´ëª…í•´ ëª…ì˜ ë³´ë³µì„ ëˆ„ê·¸ëŸ¬ëœ¨ë¦¬ê³  ë‚´ì •ì„ ë‹¤ë“¬ì„ ì‹œê°„ì„ í™•ë³´í–ˆìŠµë‹ˆë‹¤."
            },
            "í›„ê¸ˆ í¸ì„ ë“œëŠ” ê²ƒì´ ë‚«ë‹¤ê³  ê³„ì† ì£¼ì¥í•˜ë©° ë‚˜ì˜ ì˜ê²¬ì„ êµ½íˆì§€ ì•ŠëŠ”ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ìƒˆ ì„¸ë ¥ì— ë² íŒ…",
                desc: "ë– ì˜¤ë¥´ëŠ” í›„ê¸ˆê³¼ì˜ ê´€ê³„ë¥¼ ì—´ì–´ ë‘ì–´ ìµœì•…ì˜ ì¶©ëŒì„ í”¼í•˜ê³  ì‹¤ë¦¬ë¥¼ íƒí–ˆìŠµë‹ˆë‹¤."
            },
            "ì¹˜ìš•ìŠ¤ëŸ½ì§€ë§Œ í•­ë³µí•˜ì—¬ ì™•ì¡°ì™€ ë°±ì„±ì„ ë³´ì¡´í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì™•ì¡° ë³´ì¡´",
                desc: "ì¸ì¡°ëŠ” ì‚¼ì „ë„ì˜ êµ´ìš•ì„ ê°ìˆ˜í•´ ì™•ì¡°ì™€ ë°±ì„±ì„ ì‚´ë ¸ê³ , ë‚˜ì¤‘ì— ë°˜ê²©í•  í˜ì„ ë‚¨ê²¼ìŠµë‹ˆë‹¤."
            },
            "ì–´ëŠ í•œ ìª½ì— ì¹˜ìš°ì¹˜ì§€ ì•Šê³  ì¸ì¬ë¥¼ ê³ ë£¨ ë“±ìš©í•˜ëŠ” íƒ•í‰ì±…ì„ ì“´ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ê· í˜•ì˜ ì •ì¹˜",
                desc: "ë¶•ë‹¹ ê°„ ê· í˜•ì„ ë§ì¶”ì–´ ì™•ê¶Œì„ ê°•í™”í•˜ê³  ë‚˜ë¼ë¥¼ ë°œì „ì‹œí‚¬ ê°œí˜ì˜ í˜ì„ í™•ë³´í–ˆìŠµë‹ˆë‹¤."
            },
            "ê·œì¥ê°ì„ ì„¤ì¹˜í•˜ì—¬ ì Šì€ ì¸ì¬ë¥¼ í‚¤ìš°ê³  ë¶•ë‹¹ì˜ ê· í˜•ì„ ë§ì¶˜ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì¸ì¬ í’€ í™•ì¥",
                desc: "ê·œì¥ê°ì„ ì„¸ì›Œ ì Šì€ ì¸ì¬ë¥¼ ê¸¸ëŸ¬ ë‚˜ë¼ë¥¼ ë°œì „ì‹œí‚¤ê¸° ìœ„í•œ ì •ì±…ì„ ì‹¤í–‰í–ˆìŠµë‹ˆë‹¤."
            },
            "ë‚˜ë¼ì˜ í˜¼ë€ì„ ë°”ë¡œì¡ê³  ì•”í–‰ì–´ì‚¬ë¥¼ íŒŒê²¬í•´ ë¯¼ìƒì„ ì±™ê¸´ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ë¯¼ë€ ì§„ì •",
                desc: "ì•”í–‰ì–´ì‚¬ë¥¼ ë³´ë‚´ ë¶€ì •ì„ ë‹¨ì†í•˜ê³  ë¯¼ì‹¬ì„ ë‹¬ë˜ ë‚˜ë¼ì˜ ê¸°ê°•ì„ ì„¸ì› ìŠµë‹ˆë‹¤."
            },
            "í™”ì„±ì„ ì™„ê³µí•˜ì—¬ ìƒì—…ê³¼ êµ­ë°©ì˜ ì¤‘ì‹¬ì§€ë¡œ ì‚¼ê³  ê°œí˜ì„ ì™„ì„±í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ê°œí˜ì˜ ìƒì§• ì™„ì„±",
                desc: "ìˆ˜ì› í™”ì„±ì´ ì™„ê³µë˜ì–´ ìƒì—…Â·êµ­ë°©ì˜ ê±°ì ì´ ë˜ì—ˆê³  ì •ì¡°ì˜ ê°œí˜ì´ ìˆœì¡°ë¡­ê²Œ ì§„í–‰ë˜ì—ˆìŠµë‹ˆë‹¤."
            },
            "ê·œì¥ê°ì„ í†µí•´ ì Šì€ ì¸ì¬ë¥¼ ë“±ìš©í•˜ì—¬ ë‹¤ì‹œ ê°œí˜ì˜ ë¶ˆì”¨ë¥¼ ì‚´ë¦°ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ê°œí˜ ì¬ì‹œë™",
                desc: "ì Šì€ ì¸ì¬ë¥¼ ë“±ìš©í•´ ëŠì–´ì§„ ê°œí˜ì„ ë‹¤ì‹œ ì‹œì‘í•˜ë©° ì™•ê¶Œì„ ì§€íƒ±í–ˆìŠµë‹ˆë‹¤."
            },
            "ë‚˜ë¼ë¥¼ ìœ„í•´ ì •í™•í•œ ì§€ë„ì¸ 'ëŒ€ë™ì—¬ì§€ë„'ë¥¼ ì œì‘í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì§€ë„ë¡œ ì—¬ëŠ” ê°œí˜",
                desc: "ê¹€ì •í˜¸ ë“± ì—¬ëŸ¬ ì‹¤í•™ìë“¤ì´ ë°±ì„±ì˜ ìƒí™œì— ì‹¤ì§ˆì ì¸ ë„ì›€ì´ ë˜ëŠ” í•™ë¬¸ì„ ì—´ì‹¬íˆ ì—°êµ¬í•˜ì˜€ê³ , ì¡°ì„ ì— ë§ì€ ë°œì „ì´ ì¼ì–´ë‚¬ìŠµë‹ˆë‹¤."
            },
            "ì‹¤í•™ìë“¤ì˜ ì—°êµ¬ë¥¼ ì§€ì›í•˜ì—¬ ë‚˜ë¼ì˜ ëˆˆê³¼ ê·€ë¥¼ ë°íŒë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì •ë³´ íšŒë³µ",
                desc: "ì‹¤í•™ì„ ì§€ì›í•´ ë°±ì„±ë“¤ì˜ ìƒí™œì— ì‹¤ì œì ì¸ ë„ì›€ì´ ë˜ëŠ” ì—°êµ¬ë¥¼ ë§ì´ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤."
            },
            "ë¶í•™íŒŒì˜ ì£¼ì¥ì„ ë°›ì•„ë“¤ì—¬ ì²­ë‚˜ë¼ì™€ ì„œì–‘ì˜ ë¬¸ë¬¼ì„ ì ê·¹ ë°°ìš´ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ê²©ì°¨ ì¶•ì†Œ",
                desc: "ìƒˆ ê¸°ìˆ ê³¼ í•™ë¬¸ì„ ë°›ì•„ë“¤ì—¬ ì‚°ì—…Â·êµ°ì‚¬ ê²©ì°¨ë¥¼ ì¤„ì´ê³  ê·¼ëŒ€í™”ì˜ ê¸°ë°˜ì„ ë‹¦ì•˜ìŠµë‹ˆë‹¤."
            },
            "ì„œì–‘ ì˜¤ë‘ìºì™€ í™”ì¹œí•˜ëŠ” ê²ƒì€ ë§¤êµ­ì´ë‹¤. ì²™í™”ë¹„ë¥¼ ì„¸ìš°ê³  ê±°ë¶€í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: íì‡„ ì† ê²°ì§‘",
                desc: "ì²™í™”ë¹„ë¡œ í†µìƒì„ ê±°ë¶€í•˜ë©° ë‚´ë¶€ ê²°ì†ì„ ë‹¤ì¡Œê³ , ìì£¼ ì˜ì‹ì„ ê°•ì¡°í–ˆìŠµë‹ˆë‹¤."
            },
            "ì§€ê¸ˆì´ë¼ë„ ìì£¼ì  ê°œí˜ì„ ì‹œë„í•˜ê³  êµ°ëŒ€ë¥¼ ê¸°ë¥¸ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ë’¤ëŠ¦ì€ ëŒ€ë¹„",
                desc: "ë¶ˆí‰ë“±ì„ ìê°í•˜ê³  êµ°ì œÂ·ì¬ì •ì„ ì†ë´ ì™¸êµ­ì˜ ì¹¨ëµì— ë§ì„¤ ìµœì†Œí•œì˜ í˜ì„ ë§ˆë ¨í–ˆìŠµë‹ˆë‹¤."
            },
            "í‰ë“±ê³¼ ê·¼ëŒ€ êµ­ê°€ ìˆ˜ë¦½ì˜ ì˜ì§€ë¥¼ ë³´ì—¬ì£¼ê¸° ìœ„í•´ ê°œí˜ë°©ë²•ì„ ì œì‹œí•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ê°œí˜ì˜ ëª…ë¶„ ì œì‹œ",
                desc: "ê°œí˜ ì²­ì‚¬ì§„ì„ ë‚´ì„¸ì›Œ ê·¼ëŒ€ êµ­ê°€ì˜ ë°©í–¥ì„ ì•Œë¦¬ê³  ì§€ì§€ë¥¼ ëª¨ì•˜ìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ëŸ¬í•œ ì‹œë„ëŠ” ì²­ë‚˜ë¼ êµ°ëŒ€ì˜ ê°œì…ìœ¼ë¡œ 3ì¼ë§Œì— ì‹¤íŒ¨í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ì›ë˜ ê¸‰ì§„ê°œí™”íŒŒë¥¼ ë„ì™€ì£¼ê¸°ë¡œ í•œ ì¼ë³¸êµ°ì„ ê·¸ë“¤ì„ ë•ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤."
            },
            "ì •ë³€ì´ ì‹¤íŒ¨í–ˆìŒì„ ì¸ì •í•˜ê³  ê³§ë°”ë¡œ ë‹¤ë¥¸ ë‚˜ë¼ë¡œ ë„í”¼í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì „ì—´ ì¬ì •ë¹„",
                desc: "ê°œí˜ì„ ìœ„í•œ ë…¸ë ¥ì€ ì¡°ì„ ì— ì•„ë¬´ëŸ° ë„ì›€ì´ ë˜ì§€ ëª»í•œ ì±„ ì‹¤íŒ¨í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤."
            },
            "ì²­ë‚˜ë¼ë¥¼ ëª°ì•„ë‚´ê¸° ìœ„í•´ ì¡°ì„ ì˜ í˜ì„ ê¸°ë¥´ê³  ì™¸ì„¸ë¥¼ ëª°ì•„ë‚´ë ¤ ë…¸ë ¥í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ìì£¼ íšŒë³µ ëª¨ìƒ‰",
                desc: "ì™¸ì„¸ ì˜ì¡´ì„ ëŠê³  ìì£¼ êµ­ë°©ë ¥ì„ ê¸°ë¥´ë©° ì£¼ê¶Œ íšŒë³µì„ ë…¸ë ¸ìŠµë‹ˆë‹¤."
            },
            "ì™¸êµ­êµ°ì´ ì¡°ì„ ì— ë“¤ì–´ì˜¬ ìˆ˜ ìˆìœ¼ë‹ˆ ì •ë¶€ì˜ ë§ì„ ë°›ì•„ë“¤ì—¬ ì¼ë‹¨ í•´ì‚°í–ˆë‹¤ê°€ í˜¹ì‹œ ëª¨ë¥¼ ì™¸êµ­êµ°ì˜ ì¹¨ëµì— ëŒ€ë¹„í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì¹¨ëµ ëª…ë¶„ ì°¨ë‹¨",
                desc: "ì™¸êµ­ì˜ ì¹¨ëµì´ ë” í° ë¬¸ì œë¼ê³  íŒë‹¨í•œ ë™í•™ë†ë¯¼êµ°ì€ ìš°ì„  í•´ì‚°í•˜ì˜€ìœ¼ë‚˜, ì™¸êµ­êµ°ì´ ì¡°ì„ ì— ë“¤ì–´ì˜¤ê²Œ ë˜ì, ë‹¤ì‹œ ë´‰ê¸°í•˜ì—¬ ë§ì„œ ì‹¸ì› ìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì•ˆíƒ€ê¹ê²Œë„ ê·¸ë“¤ì€ ê²°êµ­ íŒ¨ë°°í•˜ì—¬ ì§„ì••ë˜ì—ˆìŠµë‹ˆë‹¤."
            },
            "2ì°¨ ë´‰ê¸°ë¥¼ ì¼ìœ¼ì¼œ í•­ì¼ êµ¬êµ­(ë‚˜ë¼ë¥¼ êµ¬í•˜ê¸° ìœ„í•œ) íˆ¬ìŸì„ í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ë´‰ê¸°ì˜ ë¶ˆì”¨ ë¶€í™œ",
                desc: "ë‹¤ì‹œ ë´‰ê¸°í•´ í•­ì¼ íˆ¬ìŸì„ ì´ì–´ê°€ë©° ê°œí˜ ìš”êµ¬ë¥¼ ë˜ì‚´ë ¸ìŠµë‹ˆë‹¤."
            },
            "ì™¸êµ­êµ°ì— ì €í•­í•˜ê¸° ìœ„í•´ ë¯¼ì¡±ì˜ ë‹¨ê²°ì„ í˜¸ì†Œí•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì €í•­ì˜ ê¹ƒë°œ",
                desc: "ë¯¼ì¡± ë‹¨ê²°ì„ ì™¸ì³ í©ì–´ì§„ ì„¸ë ¥ì„ ëª¨ìœ¼ê³  ì¹¨íƒˆì— ë§ì„¤ ëª…ë¶„ì„ ì„¸ì› ìŠµë‹ˆë‹¤."
            },
            "í—¤ì´ê·¸ì— íŠ¹ì‚¬ë¥¼ íŒŒê²¬í•´ ë¶€ë‹¹í•¨ì„ ì•Œë¦¬ê³ , ì „êµ­ì—ì„œ ì˜ë³‘ì„ ì¼ìœ¼ì¼œ ì €í•­í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: êµ­ì œ ì—¬ë¡  í™˜ê¸°",
                desc: "í•´ì™¸ì— ë¶€ë‹¹í•¨ì„ ì•Œë¦¬ê¸° ìœ„í•´ íŠ¹ì‚¬ë¥¼ ë³´ë‚´ì—ˆìœ¼ë‚˜ ì•ˆíƒ€ê¹ê²Œë„ í° íš¨ê³¼ë¥¼ ë‚´ì§€ëŠ” ëª»í–ˆìŠµë‹ˆë‹¤. í—¤ì´ê·¸ì— íŒŒê²¬ëœ íŠ¹ì‚¬ë“¤ì€ ì„ì‚¬ëŠ‘ì•½ì˜ ë¶€ë‹¹í•¨ì„ ì•Œë¦¬ë ¤ê³  ë…¸ë ¥í–ˆìœ¼ë‚˜ ì—¬ëŸ¬ ë‚˜ë¼ëŠ” ëŒ€í•œ ì œêµ­ì„ ë„ì™€ì£¼ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. "
            },
            "ìµœëŒ€í•œ ë¹¨ë¦¬ ë‹¤ì‹œ ëŒ€í•œì œêµ­ìœ¼ë¡œ ëŒì•„ê°€ ë‚˜ë¼ë¥¼ ì •ìƒí™” ì‹œí‚¤ê¸° ìœ„í•´ ë…¸ë ¥í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: êµ­ì • ê³µë°± ë³µì›",
                desc: "ë§ëª… ì‚¬íƒœë¥¼ ë§ˆë¬´ë¦¬í•˜ê³  ì¡°ì •ì— ë³µê·€í•´ êµ­ì • ê³µë°±ì„ ë©”ì› ìŠµë‹ˆë‹¤."
            },
            "ë‚¨ìëŠ” ë‹´ë°°ë¥¼ ëŠê³  ì—¬ìëŠ” ë¹„ë…€ë¥¼ íŒ”ì•„ ë‚˜ëë¹šì„ ê°šìê³  í˜¸ì†Œí•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ë¯¼ì¡± ëª¨ê¸ˆ ëŒ€ì¥ì •",
                desc: "êµ­ì±„ë³´ìƒìš´ë™ì´ ì „êµ­ìœ¼ë¡œ í™•ì‚°ë˜ì–´ êµ­ë¯¼ì´ ìŠ¤ìŠ¤ë¡œ ë¹šì„ ê°šê³  ìì£¼ì„±ì„ ì§€í‚¤ë ¤ ë‚˜ì„°ìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì¼ë³¸ì˜ íƒ„ì••ìœ¼ë¡œ ì¸í•´ ë‚˜ë¼ì˜ ë¹šì„ ê°šëŠ”ë°ëŠ” ì‹¤íŒ¨í•˜ì˜€ìŠµë‹ˆë‹¤."
            },
            "ê²½ì œë¥¼ íšŒë³µí•˜ê¸° ìœ„í•´ êµ­ë¯¼ë“¤ì˜ ë„ì›€ì˜ ë°›ì•„ ë¹šì„ ê°šê³  ì¡°ì„ ì˜ í™”í ê°€ì¹˜ë¥¼ íšŒë³µì‹œí‚¤ê¸° ìœ„í•´ ë…¸ë ¥í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: í™”í ì‹ ë¢° íšŒë³µ",
                desc: "êµ­ë¯¼ì´ í˜ì„ ëª¨ì•„ ë¹šì„ ê°šê¸° ìœ„í•´ í˜ì„ ëª¨ì•˜ê³  ìì£¼ êµ­ê°€ë¥¼ ìœ„í•œ ì¡°ì„  ì‚¬ëŒë“¤ì˜ ì˜ì§€ê°€ ê³„ì† ì´ì–´ì§€ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤."
            },
            "íƒ•! íƒ•! íƒ•! ì´í† ë¥¼ ì‚¬ì‚´í•˜ê³  'ì½”ë ˆì•„ ìš°ë¼(ëŒ€í•œ ë§Œì„¸)'ë¥¼ ì™¸ì¹œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: í•˜ì–¼ë¹ˆì˜ ì´ì„±",
                desc: "ì•ˆì¤‘ê·¼ì˜ ì´ì„±ì´ ìš¸ë ¤ í¼ì§€ë©° ì¹¨ëµ ì›í‰ì„ ì²˜ë‹¨í–ˆê³ , ëŒ€í•œ ì œêµ­ì˜ ë…ë¦½ ì˜ì§€ê°€ ë§Œë°©ì— ì•Œë ¤ì¡ŒìŠµë‹ˆë‹¤."
            },
            "í‹ˆì„ ë³´ì•„ ê°ì˜¥ì—ì„œ íƒˆì˜¥í•˜ì—¬ ì´í† ë¥¼ ì‚¬ì‚´í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ëˆì§ˆê¸´ ê²°í–‰",
                desc: "ì˜¥ì¤‘ì—ì„œë„ ëœ»ì„ ì ‘ì§€ ì•Šê³  ê±°ì‚¬ë¥¼ ì™„ìˆ˜í•´ ë…ë¦½ ì˜ì§€ë¥¼ ì¦ëª…í–ˆìŠµë‹ˆë‹¤."
            },
            "ë¹„í­ë ¥ í‰í™” ì‹œìœ„ë¡œ ìš°ë¦¬ ë¯¼ì¡±ì˜ ë…ë¦½ ì˜ì§€ë¥¼ ì „ ì„¸ê³„ì— ì•Œë¦°ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ë§Œì„¸ì˜ í•¨ì„±",
                desc: "ë¹„í­ë ¥ ë§Œì„¸ ì‹œìœ„ê°€ ì„¸ê³„ì— ìš¸ë ¤ í¼ì§€ë©° ë…ë¦½ì„ ìœ„í•œ ì¡°ì„  ë°±ì„±ë“¤ì˜ ì˜ì§€ê°€ ì „ ì„¸ê³„ì— ì•Œë ¤ì¡ŒìŠµë‹ˆë‹¤."
            },
            "ìƒí•˜ì´ë¡œ ê±´ë„ˆê°€ ëŒ€í•œë¯¼êµ­ ì„ì‹œì •ë¶€ë¥¼ ìˆ˜ë¦½í•˜ê³  ì²´ê³„ì ìœ¼ë¡œ ì €í•­í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì„ì‹œì •ë¶€ ìˆ˜ë¦½",
                desc: "í•´ì™¸ì— ì„ì‹œì •ë¶€ë¥¼ ì„¸ì›Œ ë…ë¦½ ì „ìŸì„ ì¡°ì§í•˜ê³  ì™¸êµÂ·êµ°ì‚¬ë¥¼ ì²´ê³„í™”í–ˆìŠµë‹ˆë‹¤."
            },
            "ìœ ì¸ì±…ê³¼ ë§¤ë³µ ì‘ì „ìœ¼ë¡œ ì¼ë³¸êµ°ì„ ëŒ€íŒŒí•˜ì—¬ ë…ë¦½ ì „ìŸ ì‚¬ìƒ ìµœëŒ€ ìŠ¹ë¦¬ë¥¼ ê±°ë‘”ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì²­ì‚°ë¦¬ì˜ ëŒ€ìŠ¹",
                desc: "ìœ ì¸Â·ë§¤ë³µìœ¼ë¡œ ì¼ë³¸ ì •ê·œêµ°ì„ ê²©íŒŒí•´ ë¬´ë ¥ ë…ë¦½ íˆ¬ìŸì„ ìœ„í•œ í° ì—…ì ì„ ë‹¬ì„±í–ˆìŠµë‹ˆë‹¤."
            },
            "ë‹¤ì‹œ 3ë¶€ê°€ í†µí•©í•˜ì—¬ êµ­ë¯¼ë¶€ë¥¼ ê²°ì„±í•˜ê³  ì „ì—´ì„ ì •ë¹„í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì „ì—´ ì¬í¸",
                desc: "í©ì–´ì§„ ë¶€ëŒ€ê°€ êµ­ë¯¼ë¶€ë¡œ í†µí•©ë˜ì–´ ì§€íœ˜ì™€ ë³´ê¸‰ì´ ì •ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤."
            },
            "ë§Œì£¼ë¡œ ëŒì•„ì™€ ìƒˆë¡œ êµ°ëŒ€ë¥¼ ì¡°ì§í•˜ì—¬ ì¼ë³¸ê³¼ ì‹¸ìš¸ ì¤€ë¹„ë¥¼ ë‹¤ì‹œ ì‹œì‘í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ì¬í¸ê³¼ ì¬ë„ì•½",
                desc: "ë§Œì£¼ì—ì„œ ë³‘ë ¥ì„ ì¬í¸í•´ ì¼ë³¸ì— ëŒ€í•œ ë¬´ë ¥ íˆ¬ìŸì„ ì´ì–´ê°”ìŠµë‹ˆë‹¤."
            },
            "ëª¨ì§„ ê³ ë¬¸ê³¼ íƒ„ì••ì„ ë¬´ë¦…ì“°ê³  ìš°ë¦¬ë§ í°ì‚¬ì „ ì›ê³ ë¥¼ ì§€ì¼œë‚¸ë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ë§ëª¨ì´ ì‚¬ìˆ˜",
                desc: "í•™ìë“¤ì´ ëª©ìˆ¨ ê±¸ê³  ì›ê³ ë¥¼ ì§€ì¼œ ìš°ë¦¬ë§ê³¼ ì •ì‹ ì˜ ë¶ˆì”¨ë¥¼ ì‚´ë ¸ìŠµë‹ˆë‹¤."
            },
            "í•´ë°© ì§ì „, ì„œìš¸ì—­ ì°½ê³ ì—ì„œ ê¸°ì ì ìœ¼ë¡œ ì›ê³ ë¥¼ ì°¾ì•„ ìš°ë¦¬ë§ í°ì‚¬ì „ í¸ì°¬í•˜ì—¬ ìš°ë¦¬ ê¸€ì„ ë³´ì¡´í•œë‹¤.": {
                title: "ì„ íƒ ê²°ê³¼: ìš°ë¦¬ë§ ë˜ì‚´ë¦¬ê¸°",
                desc: "ìƒì–´ë²„ë¦° ì›ê³ ë¥¼ ë˜ì°¾ì•„ ì‚¬ì „ì„ ì™„ì„±í•˜ë©°, ë¯¼ì¡±ì˜ ì–¸ì–´ì™€ ì •ì²´ì„±ì„ ì§€ì¼œëƒˆìŠµë‹ˆë‹¤."
            }
        };

        // ë°ì´í„° ëˆ„ë½ ë°©ì§€ë¥¼ ìœ„í•œ ì•ˆì „ ì¥ì¹˜
        function getSafeData(key) {
            if (gameData[key]) return gameData[key];
            console.error(`Missing key: ${key}`); // ê°œë°œì í™•ì¸ìš©
            return {
                type: 'ending', badge: 'badge-crisis', era: "ì‹œìŠ¤í…œ ì˜¤ë¥˜", year: "???",
                title: "ì°¨ì›ì˜ í‹ˆìƒˆ",
                desc: "ì£„ì†¡í•©ë‹ˆë‹¤. ì¹˜ëª…ì ì¸ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (ì—°ê²°ë˜ì§€ ì•Šì€ ì‹œë‚˜ë¦¬ì˜¤)",
                progress: 0, icon: "ğŸ‘¾",
                choices: [{ text: "ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸°", next: "start", style: "restart" }]
            };
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // ëª¨ë°”ì¼/ì˜¤ë²„ë ˆì´ ì‹œ í™”ë©´ ìŠ¤í¬ë¡¤ ë°©ì§€ ìœ í‹¸
        let overlayLockCount = 0;
        function lockBodyScroll(lock) {
            overlayLockCount = Math.max(0, overlayLockCount + (lock ? 1 : -1));
            const active = overlayLockCount > 0;
            document.documentElement.style.overscrollBehavior = active ? 'none' : '';
            document.body.style.overflow = active ? 'hidden' : '';
        }

        // --- ì›…ë…€ ë¯¸ë‹ˆê²Œì„ ë¡œì§ ---
        let mgInterval;
        let mgArcadeTimer;
        let mgArcadeTimeLeft = 0;
        let mgLives = 3;
        let mgScore = 0;
        let mgActive = false;
        let mgNextScene = "";
        
        // ì¹˜íŠ¸ ê´€ë ¨ ë³€ìˆ˜
        let cheatClicks = 0;
        let cheatTimeout;

        // ì¹˜íŠ¸ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        document.addEventListener('DOMContentLoaded', () => {
            const titleText = document.getElementById('mg-title-text');
            if (titleText) {
                titleText.addEventListener('click', () => {
                    if (!mgActive) return;
                    
                    cheatClicks++;
                    
                    // 1ì´ˆ ì•ˆì— ë‹¤ìŒ í´ë¦­ ì—†ìœ¼ë©´ ì´ˆê¸°í™” (ë¹ ë¥´ê²Œ í´ë¦­í•´ì•¼ í•¨)
                    clearTimeout(cheatTimeout);
                    cheatTimeout = setTimeout(() => {
                        cheatClicks = 0;
                    }, 1000);

                    if (cheatClicks >= 10) {
                        // ì¹˜íŠ¸ ë°œë™
                        mgScore = 100;
                        updateScore(0); // ì ìˆ˜ ì—…ë°ì´íŠ¸ ë° ì¢…ë£Œ íŠ¸ë¦¬ê±°
                        cheatClicks = 0;
                        showToast("âš¡ ê°œë°œì ì¹˜íŠ¸ ë°œë™: ì¸ë‚´ì‹¬ MAX!");
                    }
                });
            }
        });

        // --- ì£¼ëª½ ê°• ê±´ë„ˆê¸° ë¯¸ë‹ˆê²Œì„ ë³€ìˆ˜ ---
        let rgInterval;
        let rgActive = false;
        // ê²©ì ì‹œìŠ¤í…œ (4í–‰ 12ì—´)
        const RG_ROWS = 4;
        const RG_COLS = 12;
        let jumongRow = 2; // ì‹œì‘ í–‰ (ì¤‘ì•™)
        let jumongCol = 0; // ì‹œì‘ ì—´
        let riverGrid = []; // í˜„ì¬ í™œì„±í™”ëœ ì•„ì´í…œ ìƒíƒœ ì €ì¥

        // í‚¤ ì…ë ¥ ì œì–´ ë³€ìˆ˜
        let lastKeyTime = 0;
        const KEY_COOLDOWN = 200; // 200ms ì¿¨ë‹¤ìš´ (í•œ ë²ˆ ì…ë ¥ í›„ ë‹¤ìŒ ì…ë ¥ê¹Œì§€ ëŒ€ê¸°ì‹œê°„)

        // ì•„ì´í…œ ì œê±° ì£¼ê¸°
        const ITEM_REMOVE_INTERVAL = 1600; // 1.6ì´ˆë§ˆë‹¤ ì•„ì´í…œ í•˜ë‚˜ì”© ì œê±° (ì¢€ ë” ëŠë¦¬ê²Œ)

        // --- ì‚¼ë³„ì´ˆ ë°©ì–´ì „ ë¯¸ë‹ˆê²Œì„ ë³€ìˆ˜ ---
        let defenseInterval;
        let defenseActive = false;
        let defenseCastleHP = 100;
        let defenseScore = 0;
        let defenseMongols = []; // í™œì„±í™”ëœ ëª½ê³¨ ëª©ë¡
        let defenseWave = 1;
        let defenseSpawnRate = 200; // ì´ˆê¸° ìŠ¤í° ê°„ê²© í¬ê²Œ ë‹¨ì¶•
        let defenseMongolHP = 10; // ëª½ê³¨ ì²´ë ¥ (3ìœ¼ë¡œ ì¦ê°€)
        let defenseArrowCooldown = 0;
        const DEFENSE_MAX_MONGOLS = 80; // ìµœëŒ€ ëª½ê³¨ ìˆ˜ ë” ì¦ê°€
        const DEFENSE_Y_LINES = [20]; // í™”ë©´ ë§¨ ì•„ë˜ìª½ í•œ ì¤„ë§Œ (bottom ê¸°ì¤€)
        let defenseMoveInterval; // ì´ë™ ë£¨í”„ í´ë¦¬ì–´ìš©
        let defenseTouchHandler; // í„°ì¹˜ í•¸ë“¤ëŸ¬ ì°¸ì¡° ì €ì¥
        // ë°©ì–´ì „ ì§„í–‰ ë²„íŠ¼ ì¬ë°”ì¸ë”© ìœ í‹¸
        function bindDefenseProceedBtn() {
            const btn = document.getElementById('defense-proceed-btn');
            if (!btn) return;
            const newBtn = btn.cloneNode(true);
            btn.parentNode.replaceChild(newBtn, btn);
            newBtn.addEventListener('click', () => {
                const win = document.getElementById('defense-game-window');
                if (win) {
                    win.classList.add('hidden');
                    win.style.display = 'none';
                }
                lockBodyScroll(false);
                // mgNextSceneê°€ ë¹„ì–´ ìˆì„ ë•Œë¥¼ ëŒ€ë¹„í•œ ì•ˆì „ì¥ì¹˜
                renderScene(mgNextScene || 'start');
            });
        }

        // --- íƒ•í‰ì±… ê· í˜• ë¯¸ë‹ˆê²Œì„ ë³€ìˆ˜ ---
        const FACTION_ROWS = 4;
        const FACTION_COLS = 5;
        const FACTION_TOLERANCE = 3; // í—ˆìš© ê°€ëŠ¥í•œ ì¸ì› ì°¨ì´ (ì°¨ì´ 3 ì´í•˜ ëˆ„ì )
        const FACTION_TARGET = 60; // 60ì´ˆ ìœ ì§€ ëª©í‘œ
        let factionActive = false;
        let factionSpawnInterval;
        let factionBalanceInterval;
        let noronProb = 0.55;
        let soronProb = 0.55;
        let factionBalanceTime = 0;
        let factionUnbalanceLeft = 0; // ì•„ì¼€ì´ë“œ: ê· í˜•ì„ ë˜ì°¾ê¸°ê¹Œì§€ ë‚¨ì€ ì´ˆ(3â†’2â†’1â†’0)
        let factionTimeouts = [];

        // --- í¥ì„ ëŒ€ì›êµ° ì²™í™”ë¹„ ë¯¸ë‹ˆê²Œì„ ë³€ìˆ˜ ---
        const HG_ROWS = 36;
        const HG_COLS = 64; // Monument ë¹„ìœ¨ì„ ìœ ì§€í•˜ê¸° ìœ„í•œ 16:9 ê²©ì
        const HG_SIDE = Math.min(HG_ROWS, HG_COLS); // ì •ì‚¬ê°í˜• ì˜ì—­ í•œ ë³€
        const HG_SQ_START_R = Math.floor((HG_ROWS - HG_SIDE) / 2);
        const HG_SQ_START_C = Math.floor((HG_COLS - HG_SIDE) / 2);
        const HG_TOTAL_SQUARE = HG_SIDE * HG_SIDE; // 90% ê¸°ì¤€ ë©´ì 
        const HG_GOAL = 80; // % í•„ìš” ì˜¤í”ˆìœ¨ (ì •ì‚¬ê° ê¸°ì¤€, 80%ë¡œ ì™„í™”)
        const HG_COOLDOWN = 90; // ms
        let hgActive = false;
        let hgLives = 3;
        let hgPlayer = { r: HG_SQ_START_R, c: Math.floor(HG_SQ_START_C + HG_SIDE / 2), dir: null, drawing: false };
        let hgRespawnPos = { r: HG_SQ_START_R, c: Math.floor(HG_SQ_START_C + HG_SIDE / 2) };
        let hgShips = [];
        let hgShipInterval;
        let hgLastMove = 0;
        let hgCellW = 10, hgCellH = 10;
        let hgGrid = []; // 0: ë¯¸ê°œë°©, 1: í™•ë³´(ê°œë°©), 2: ê·¸ë¦¬ëŠ” ì¤‘ ë¼ì¸
        let hgTrail = [];
        let hgCapturedCount = 0;
        let hgTotalTiles = HG_ROWS * HG_COLS;
        let hgCapturedSquareCount = 0;
        let hgLoop;
        let hgSparxPos = 0; // ê²½ê³„ ì  ìœ„ì¹˜(ë‘˜ë ˆ ê¸°ì¤€)
        let hgStartedDrawing = false; // ì²« ì„ ì„ ê·¸ë¦¬ê¸° ì‹œì‘í–ˆëŠ”ì§€

        // ì•ˆì¤‘ê·¼ ë¦¬ë“¬ ë¯¸ë‹ˆê²Œì„ ë³€ìˆ˜
        let ahnActive = false;
        let ahnBeats = [];
        let ahnCurrent = 0;
        let ahnAllowHit = false;
        let ahnTimeouts = [];
        let ahnNotes = [];
        let ahnLoop;
        let ahnHitY = 0;
        let ahnNextScene = '';

        function startDefenseGame() {
            console.log('Starting defense game...');
            defenseActive = true;
            defenseCastleHP = 100;
            defenseScore = 0;
            defenseMongols = [];
            defenseWave = 1;
            defenseSpawnRate = 500; // ë” ìì£¼ ìŠ¤í°
            defenseMongolHP = 10;
            lockBodyScroll(true);

            const gameWindow = document.getElementById('defense-game-window');
            const resultEl = document.getElementById('defense-result');
            const gameArea = document.getElementById('defense-game-area');
            const proceedBtn = document.getElementById('defense-proceed-btn');
            const achievementBtn = document.getElementById('defense-achievement-btn');

            console.log('gameWindow element:', gameWindow);
            console.log('gameWindow classList before:', gameWindow.classList.toString());

            gameWindow.classList.remove('hidden');
            gameWindow.style.display = 'flex'; // ëª…ì‹œì ìœ¼ë¡œ í‘œì‹œ
            resultEl.classList.add('hidden');

            console.log('gameWindow classList after:', gameWindow.classList.toString());
            console.log('gameWindow display style:', getComputedStyle(gameWindow).display);

            updateDefenseUI();

            // ê¸°ì¡´ ëª½ê³¨ ì œê±°
            const oldMongols = gameArea.querySelectorAll('.defense-mongol');
            oldMongols.forEach(el => el.remove());

            // ì§„í–‰ ë²„íŠ¼ ì´ë²¤íŠ¸ ì¬ë“±ë¡
            bindDefenseProceedBtn();

            // ì—…ì  ë²„íŠ¼ ì´ë²¤íŠ¸ ì¬ë“±ë¡
            const newAchievementBtn = achievementBtn.cloneNode(true);
            achievementBtn.parentNode.replaceChild(newAchievementBtn, achievementBtn);

            newAchievementBtn.addEventListener('click', () => {
                showTitles(); // ê¸°ì¡´ ì—…ì  ì‹œìŠ¤í…œ ì‚¬ìš©
            });

            // í™”ì‚´ ë°œì‚¬ ì´ë²¤íŠ¸ ë“±ë¡ (í™”ë©´ í´ë¦­/í„°ì¹˜) - ì¤‘ë³µ ë°©ì§€
            gameArea.removeEventListener('click', handleDefenseClick);
            if (defenseTouchHandler) gameArea.removeEventListener('touchstart', defenseTouchHandler);

            gameArea.addEventListener('click', handleDefenseClick);
            defenseTouchHandler = (e) => {
                e.preventDefault();
                handleDefenseClick(e.touches ? e.touches[0] : e);
            };
            gameArea.addEventListener('touchstart', defenseTouchHandler, { passive: false });

            // ëª½ê³¨ ìŠ¤í° ì‹œì‘
            defenseInterval = setInterval(spawnMongol, defenseSpawnRate);

            // ê²Œì„ ë£¨í”„ (ëª½ê³¨ ì´ë™)
            defenseMoveInterval = setInterval(updateDefenseGame, 50);
        }

        function spawnMongol() {
            if (!defenseActive || defenseMongols.length >= DEFENSE_MAX_MONGOLS) return;

            const gameArea = document.getElementById('defense-game-area');

            // í™”ë©´ ë§¨ ì•„ë˜ ë¼ì¸ í•œ ì¤„ì—ì„œë§Œ ìƒì„±
            const yPos = DEFENSE_Y_LINES[0];

            const mongol = document.createElement('div');
            mongol.className = 'defense-mongol absolute cursor-pointer';
            mongol.style.right = '-144px'; // ì˜¤ë¥¸ìª½ ëì—ì„œ ì‹œì‘ (3ë°° í¬ê¸° ê³ ë ¤)
            mongol.style.bottom = `${yPos}px`;
            mongol.style.width = '144px'; // 48 * 3 = 144px
            mongol.style.height = '144px'; // 48 * 3 = 144px

            // ëª½ê³¨ ì´ë¯¸ì§€
            const mongolImg = document.createElement('img');
            mongolImg.src = 'mongol.png';
            mongolImg.className = 'w-full h-full object-contain';
            mongol.appendChild(mongolImg);

            // HP í‘œì‹œ
            const hpDisplay = document.createElement('div');
            hpDisplay.className = 'absolute top-0 right-0 bg-red-600 text-white text-xs px-1 rounded';
            hpDisplay.textContent = defenseMongolHP;
            mongol.appendChild(hpDisplay);

            // ëª½ê³¨ ë°ì´í„°
            const gameRect = gameArea.getBoundingClientRect();

            const mongolData = {
                element: mongol,
                imgElement: mongolImg,
                hpDisplay: hpDisplay,
                x: gameRect.width + 200, // í™”ë©´ ì˜¤ë¥¸ìª½ ë°–ì—ì„œ ì‹œì‘
                y: yPos,
                hp: defenseMongolHP,
                speed: (1.2 + Math.random() * 0.6) * 17 // ë” ë¹ ë¥´ê²Œ
            };

            defenseMongols.push(mongolData);
            mongol.style.left = mongolData.x + 'px';
            gameArea.appendChild(mongol);

            // ëª½ê³¨ í´ë¦­ ì´ë²¤íŠ¸ (ì§ì ‘ í´ë¦­ìœ¼ë¡œ íƒ€ê²©)
            mongol.addEventListener('click', (e) => {
                e.stopPropagation();
                damageMongol(mongolData);
            });
            mongol.addEventListener('touchstart', (e) => {
                e.stopPropagation();
                e.preventDefault();
                damageMongol(mongolData);
            }, { passive: false });
        }

        function updateDefenseGame() {
            if (!defenseActive) return;

            defenseMongols.forEach((mongol, index) => {
                // ì´ë¯¸ ì„±ì— ë„ì°©í•œ ëª½ê³¨ì€ ì´ë™í•˜ì§€ ì•Šê³  ì§€ì† ë°ë¯¸ì§€
                if (mongol.reachedCastle) {
                    if (!mongol.lastDamageTime || Date.now() - mongol.lastDamageTime >= 1000) {
                        damageCastle();
                        mongol.lastDamageTime = Date.now();
                    }
                    return;
                }

                // ì™¼ìª½ìœ¼ë¡œ ì´ë™
                mongol.x -= mongol.speed;
                mongol.element.style.left = mongol.x + 'px';

                // ì„± ìœ„ì¹˜ ê³„ì‚°
                const gameArea = document.getElementById('defense-game-area');
                const castle = document.getElementById('defense-castle');
                const gameRect = gameArea.getBoundingClientRect();
                const castleRect = castle.getBoundingClientRect();
                const castleLeft = castleRect.left - gameRect.left;
                const castleRight = castleLeft + castleRect.width;

                // ì„±ì— ë„ë‹¬í–ˆëŠ”ì§€ ì²´í¬
                if (mongol.x <= castleRight) {
                    // ì„±ì— ë„ì°© - ë©ˆì¶”ê³  ì§€ì† ë°ë¯¸ì§€ ì‹œì‘
                    mongol.reachedCastle = true;
                    mongol.x = castleRight;
                    mongol.element.style.left = mongol.x + 'px';
                    mongol.element.style.animation = 'none'; // ì´ë™ ì• ë‹ˆë©”ì´ì…˜ ì¤‘ì§€
                    return;
                }

                // í™”ë©´ ì™¼ìª½ìœ¼ë¡œ ë‚˜ê°”ëŠ”ì§€ ì²´í¬ (ì„±ì— ë‹¿ì§€ ëª»í•œ ê²½ìš°)
                if (mongol.x < -200) {
                    removeMongol(index);
                }
            });
        }

        function handleDefenseClick(event) {
            if (!defenseActive || defenseArrowCooldown > 0) return;

            defenseArrowCooldown = 10; // ì¿¨ë‹¤ìš´ (0.5ì´ˆ)

            // í´ë¦­í•œ ëª½ê³¨ ì°¾ê¸°
            const gameArea = document.getElementById('defense-game-area');
            const rect = gameArea.getBoundingClientRect();
            const clickX = event.clientX - rect.left;
            const clickY = event.clientY - rect.top;

            // í´ë¦­í•œ ìœ„ì¹˜ì— ëª½ê³¨ì´ ìˆëŠ”ì§€ ì°¾ê¸°
            let targetMongol = null;
            for (const mongol of defenseMongols) {
                const mongolRect = mongol.element.getBoundingClientRect();
                const gameRect = gameArea.getBoundingClientRect();

                const relativeLeft = mongolRect.left - gameRect.left;
                const relativeRight = mongolRect.right - gameRect.left;
                const relativeTop = mongolRect.top - gameRect.top;
                const relativeBottom = mongolRect.bottom - gameRect.top;

                if (clickX >= relativeLeft && clickX <= relativeRight &&
                    clickY >= relativeTop && clickY <= relativeBottom) {
                    targetMongol = mongol;
                    break;
                }
            }

            if (!targetMongol) return; // ëª½ê³¨ì„ í´ë¦­í•˜ì§€ ì•ŠìŒ

            // ì„± ìœ„ìª½ì—ì„œ í™”ì‚´ ë°œì‚¬
            const castle = document.getElementById('defense-castle');
            const castleRect = castle.getBoundingClientRect();
            const gameRect = gameArea.getBoundingClientRect();

            const startX = castleRect.left - gameRect.left + castleRect.width / 2; // ì„± ì¤‘ì•™
            const startY = castleRect.top - gameRect.top + castleRect.height / 2; // ì„± ì¤‘ì•™ ë†’ì´ (í›¨ì”¬ ì•„ë˜ë¡œ)

            const targetX = targetMongol.x - 72; // ëª½ê³¨ ì¤‘ì‹¬
            const targetY = targetMongol.y + 72; // ëª½ê³¨ ì•„ë˜ìª½

            // í™”ì‚´ ì´ë¯¸ì§€ ìƒì„±
            const arrow = document.createElement('img');
            arrow.src = 'arrow.png';
            arrow.className = 'absolute w-48 h-32 pointer-events-none z-10'; // 4ë°° í¬ê¸°ë¡œ ì¦ê°€
            arrow.style.left = startX + 'px';
            arrow.style.top = startY + 'px';

            gameArea.appendChild(arrow);

            // í™”ì‚´ íšŒì „ ê³„ì‚° (í•­ìƒ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ë°œì‚¬)
            arrow.style.transform = 'rotate(0deg)';

            // í™”ì‚´ ì• ë‹ˆë©”ì´ì…˜ (ìˆ˜í‰ìœ¼ë¡œ ë‚ ì•„ê°)
            const distance = targetX - startX;
            const duration = Math.max(Math.abs(distance) / 6, 200); // ì†ë„ ì¡°ì •

            arrow.animate([
                { left: startX + 'px' },
                { left: targetX + 'px' }
            ], {
                duration: duration,
                easing: 'linear',
                fill: 'forwards'
            });

            // í™”ì‚´ì´ ëª©í‘œì— ë„ë‹¬í•˜ë©´ ëª½ê³¨ ë°ë¯¸ì§€
            setTimeout(() => {
                if (targetMongol && !targetMongol.element.removed) {
                    damageMongol(targetMongol);
                }
                if (arrow.parentNode) {
                    arrow.remove();
                }
            }, duration);

            // ì¿¨ë‹¤ìš´ ê°ì†Œ
            const cooldownInterval = setInterval(() => {
                defenseArrowCooldown--;
                if (defenseArrowCooldown <= 0) {
                    clearInterval(cooldownInterval);
                }
            }, 50);
        }

        function damageMongol(mongol) {
            mongol.hp--;
            mongol.hpDisplay.textContent = mongol.hp; // HP í‘œì‹œ ì—…ë°ì´íŠ¸

            if (mongol.hp <= 0) {
                // ëª½ê³¨ ì œê±°
                defenseScore++;
                updateDefenseUI();
                removeMongol(defenseMongols.indexOf(mongol));
            } else {
                // í”¼ê²© íš¨ê³¼
                mongol.imgElement.style.filter = 'brightness(0.5)';
                setTimeout(() => mongol.imgElement.style.filter = 'brightness(1)', 200);
            }
        }

        function damageCastle() {
            defenseCastleHP -= 3; // ì§€ì† ë°ë¯¸ì§€ë¡œ ì¤„ì„
            updateDefenseUI();

            // ì„± í”¼ê²© íš¨ê³¼
            const castle = document.getElementById('defense-castle');
            castle.style.opacity = '0.7';
            setTimeout(() => castle.style.opacity = '1', 500);

            // HPê°€ 0ì´ ë˜ë©´ ê²Œì„ ì¢…ë£Œ
            if (defenseCastleHP <= 0) {
                endDefenseGame();
            }
        }

        function removeMongol(index) {
            if (index >= 0 && index < defenseMongols.length) {
                const mongol = defenseMongols[index];
                mongol.element.remove();
                defenseMongols.splice(index, 1);
            }
        }

        function updateDefenseUI() {
            document.getElementById('defense-castle-hp').textContent = defenseCastleHP;
            document.getElementById('defense-score').textContent = defenseScore;
        }

        function endDefenseGame() {
            defenseActive = false;
            clearInterval(defenseInterval);
            clearInterval(defenseMoveInterval);

            if (arcadeMode) {
                // ë°©ì–´ì „ì€ ì ìˆ˜ê°€ 0 ì´ìƒì´ë©´ ì¼ë‹¨ ê¸°ë¡
                showArcadeResult(defenseScore, true);
                return;
            }

            const resultEl = document.getElementById('defense-result');
            resultEl.classList.remove('hidden');
            resultEl.style.display = 'flex';

            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì œê±°
            const gameArea = document.getElementById('defense-game-area');
            gameArea.removeEventListener('click', handleDefenseClick);
            if (defenseTouchHandler) gameArea.removeEventListener('touchstart', defenseTouchHandler);
            defenseTouchHandler = null;
        }

        function startMinigame(gameType, nextScene) {
            mgNextScene = nextScene;
            // nextSceneì´ nullì´ë©´ ì•„ì¼€ì´ë“œ ëª¨ë“œ, ì•„ë‹ˆë©´ ìŠ¤í† ë¦¬ ëª¨ë“œ
            arcadeMode = (nextScene === null);

            if (gameType === 'bear_game') {
                startBearGame();
            } else if (gameType === 'river_game') {
                startRiverGame();
            } else if (gameType === 'defense_game') {
                startDefenseGame();
            } else if (gameType === 'faction_balance_game') {
                startFactionGame();
            } else if (gameType === 'heung_game') {
                startHeungGame();
            } else if (gameType === 'ahn_rhythm_game') {
                startAhnGame();
            }
        }

        // --- íƒ•í‰ì±… ê· í˜• ë¯¸ë‹ˆê²Œì„ ë¡œì§ ---
        function startFactionGame() {
            stopFactionGame(); // í˜¹ì‹œ ë‚¨ì•„ìˆëŠ” íƒ€ì´ë¨¸ ì´ˆê¸°í™”

            // ëª¨ë“  ê²Œì„ ìƒíƒœ ì™„ì „ ì´ˆê¸°í™”
            factionActive = true;
            factionBalanceTime = 0;
            factionUnbalanceLeft = 0;
            noronProb = 0.55;
            soronProb = 0.55;

            // DOM ìš”ì†Œ ì´ˆê¸°í™”
            const noronGrid = document.getElementById('noron-grid');
            const soronGrid = document.getElementById('soron-grid');
            if (noronGrid) noronGrid.innerHTML = '';
            if (soronGrid) soronGrid.innerHTML = '';

            lockBodyScroll(true);

            // ë””ë²„ê¹…: í˜„ì¬ ëª¨ë“œ í™•ì¸
            console.log('íƒ•í‰ì±… ê²Œì„ ì‹œì‘ - arcadeMode:', arcadeMode, 'mgNextScene:', mgNextScene);

            const overlay = document.getElementById('faction-game-overlay');
            const resultEl = document.getElementById('faction-result');
            const proceedBtn = document.getElementById('faction-proceed-btn');
            const noronBtn = document.getElementById('noron-btn');
            const soronBtn = document.getElementById('soron-btn');

            overlay.style.display = 'block';
            resultEl.style.display = 'none';

            buildFactionGrid();
            spawnInitialFactionMembers();
            updateFactionGauge();

            // ë²„íŠ¼ ì´ë²¤íŠ¸ ì¬ë“±ë¡ (ì¤‘ë³µ ë°©ì§€)
            const newNoronBtn = noronBtn.cloneNode(true);
            noronBtn.parentNode.replaceChild(newNoronBtn, noronBtn);
            newNoronBtn.addEventListener('click', () => adjustFactionProb('noron'));

            const newSoronBtn = soronBtn.cloneNode(true);
            soronBtn.parentNode.replaceChild(newSoronBtn, soronBtn);
            newSoronBtn.addEventListener('click', () => adjustFactionProb('soron'));

            const newProceedBtn = proceedBtn.cloneNode(true);
            proceedBtn.parentNode.replaceChild(newProceedBtn, proceedBtn);
            newProceedBtn.addEventListener('click', () => {
                document.getElementById('faction-game-overlay').style.display = 'none';
                lockBodyScroll(false);
                renderScene(mgNextScene);
            });

            // ì •ê¸° ìŠ¤í° & ê· í˜• ì²´í¬
            factionSpawnInterval = setInterval(() => {
                spawnFactionSide('noron');
                spawnFactionSide('soron');
            }, 1200);

            factionBalanceInterval = setInterval(checkFactionBalance, 1000);
            // ì‹œì‘ ì§í›„ì—ë„ ìƒíƒœ/ì¹´ìš´íŠ¸ í‘œì‹œê°€ ë°”ë¡œ ë³´ì´ë„ë¡ 1íšŒ ì¦‰ì‹œ ì²´í¬
            checkFactionBalance();
        }

        function stopFactionGame() {
            factionActive = false;
            clearInterval(factionSpawnInterval);
            clearInterval(factionBalanceInterval);
            factionTimeouts.forEach(id => clearTimeout(id));
            factionTimeouts = [];
        }

        function buildFactionGrid() {
            const noronGrid = document.getElementById('noron-grid');
            const soronGrid = document.getElementById('soron-grid');

            [noronGrid, soronGrid].forEach(grid => {
                grid.innerHTML = '';
                for (let i = 0; i < FACTION_ROWS * FACTION_COLS; i++) {
                    const cell = document.createElement('div');
                    cell.className = 'faction-cell';
                    grid.appendChild(cell);
                }
            });
        }

        function spawnInitialFactionMembers() {
            for (let i = 0; i < 3; i++) {
                spawnFactionSide('noron', true);
                spawnFactionSide('soron', true);
            }
        }

        function spawnFactionSide(side, force = false) {
            if (!factionActive) return;

            const prob = side === 'noron' ? noronProb : soronProb;
            if (!force && Math.random() > prob) return;

            const grid = side === 'noron' ? document.getElementById('noron-grid') : document.getElementById('soron-grid');
            const cells = Array.from(grid.querySelectorAll('.faction-cell'));
            let emptyCells = cells.filter(cell => cell.children.length === 0);

            if (emptyCells.length === 0 && cells.length > 0) {
                const firstFigure = grid.querySelector('.faction-figure');
                if (firstFigure) firstFigure.remove();
                emptyCells = cells.filter(cell => cell.children.length === 0);
            }

            if (emptyCells.length === 0) return;

            const spawnCount = Math.min(emptyCells.length, Math.random() < 0.5 ? 1 : 2);

            for (let i = 0; i < spawnCount; i++) {
                const idx = Math.floor(Math.random() * emptyCells.length);
                const cell = emptyCells.splice(idx, 1)[0];
                if (!cell) continue;

                const img = document.createElement('img');
                img.src = side === 'noron' ? 'noron.png' : 'soron.png';
                img.className = 'faction-figure';
                cell.appendChild(img);

                const lifetime = 5500 + Math.random() * 2500; // 5.5~8ì´ˆ ìœ ì§€
                const timeoutId = setTimeout(() => {
                    if (!factionActive) return;
                    if (img.parentNode) img.remove();
                    updateFactionGauge();
                }, lifetime);
                factionTimeouts.push(timeoutId);
            }

            updateFactionGauge();
        }

        function adjustFactionProb(side) {
            if (!factionActive) return;

            if (side === 'noron') {
                noronProb = Math.min(noronProb + 0.15, 0.95);
                soronProb = Math.max(soronProb - 0.05, 0.30);
            } else {
                soronProb = Math.min(soronProb + 0.15, 0.95);
                noronProb = Math.max(noronProb - 0.05, 0.30);
            }

            // í´ë¦­ ì‹œ ì¦‰ì‹œ ìŠ¤í°í•˜ì—¬ ë°˜ì‘ì„±ì„ ë†’ì„
            spawnFactionSide(side, true);
            updateFactionGauge();
        }

        function getFactionCounts() {
            const noronCount = document.querySelectorAll('#noron-grid .faction-figure').length;
            const soronCount = document.querySelectorAll('#soron-grid .faction-figure').length;
            return { noronCount, soronCount };
        }

        function updateFactionGauge() {
            const { noronCount, soronCount } = getFactionCounts();
            const total = Math.max(noronCount + soronCount, 1);
            const diff = Math.abs(noronCount - soronCount);
            const balanceRatio = Math.max(0, 1 - diff / total);

            const balanceTimeEl = document.getElementById('faction-balance-time');
            const targetEl = document.getElementById('faction-balance-target');
            const unbalanceWrap = document.getElementById('faction-unbalance-text');
            const unbalanceLeftEl = document.getElementById('faction-unbalance-left');

            if (balanceTimeEl) {
                balanceTimeEl.textContent = arcadeMode ? `${factionBalanceTime}` : `${Math.min(factionBalanceTime, FACTION_TARGET)}`;
            }

            if (arcadeMode) {
                // ì•„ì¼€ì´ë“œ: /60ì´ˆ í‘œê¸°ëŠ” ìˆ¨ê¸°ê³ (ê¸°ë¡ì€ 'ë²„í‹´ ì‹œê°„'), ê¹¨ì§ ì¹´ìš´íŠ¸ í‘œì‹œ
                if (targetEl) targetEl.style.display = 'none';
                if (unbalanceWrap && unbalanceLeftEl) {
                    if (factionUnbalanceLeft > 0) {
                        unbalanceLeftEl.textContent = `${factionUnbalanceLeft}`;
                        unbalanceWrap.classList.remove('hidden');
                    } else {
                        unbalanceWrap.classList.add('hidden');
                    }
                }
            } else {
                // ìŠ¤í† ë¦¬: /60ì´ˆ í‘œê¸°
                if (targetEl) targetEl.style.display = '';
                if (unbalanceWrap) unbalanceWrap.classList.add('hidden');
            }

            const bar = document.getElementById('faction-balance-bar');
            if (bar) bar.style.width = `${Math.round(balanceRatio * 100)}%`;
        }

        function checkFactionBalance() {
            if (!factionActive) return;

            const { noronCount, soronCount } = getFactionCounts();
            const diff = Math.abs(noronCount - soronCount);

            if (diff <= FACTION_TOLERANCE) {
                // ê· í˜• ìœ ì§€ ì¤‘
                factionBalanceTime++;
                if (arcadeMode) factionUnbalanceLeft = 0;
            } else {
                // ê· í˜• ê¹¨ì§ (ì•„ì¼€ì´ë“œì—ì„œë§Œ 3ì´ˆ ì¹´ìš´íŠ¸ë‹¤ìš´)
                if (arcadeMode) {
                    if (factionUnbalanceLeft === 0) factionUnbalanceLeft = 3; // ì¦‰ì‹œ 3ì´ˆë¶€í„° í‘œì‹œ
                    else factionUnbalanceLeft -= 1; // 3â†’2â†’1â†’0
                }
            }

            updateFactionGauge();

            if (arcadeMode) {
                // ì•„ì¼€ì´ë“œ ëª¨ë“œ: ê· í˜•ì´ 3ì´ˆ ì´ìƒ ìœ ì§€ë˜ì§€ ì•Šìœ¼ë©´ ê²Œì„ ì˜¤ë²„
                if (factionUnbalanceLeft <= 0 && diff > FACTION_TOLERANCE) {
                    endFactionGame(false); // ì‹¤íŒ¨ë¡œ ê¸°ë¡
                }
            } else {
                if (factionBalanceTime >= FACTION_TARGET) {
                    endFactionGame();
                }
            }
        }

        function endFactionGame(success = true) {
            stopFactionGame();
            
            if (arcadeMode) {
                showArcadeResult(factionBalanceTime, success);
                return;
            }

            const resultEl = document.getElementById('faction-result');
            resultEl.style.display = 'flex';
        }

        // --- í¥ì„ ëŒ€ì›êµ° ì²™í™”ë¹„ ë¯¸ë‹ˆê²Œì„ (Qix ìŠ¤íƒ€ì¼) ---
        function startHeungGame() {
            stopHeungGame();
            
            // ì´ì „ ê²Œì„ì˜ ì”ì—¬ ì´ì–‘ì„ (ì›€ì§ì´ì§€ ì•ŠëŠ” ë°°) ì œê±°
            const oldShips = document.querySelectorAll('.heung-ship');
            oldShips.forEach(el => el.remove());

            hgActive = true;
            hgLives = 3;
            hgPlayer = { r: HG_SQ_START_R, c: Math.floor(HG_SQ_START_C + HG_SIDE / 2), dir: null, drawing: false };
            hgRespawnPos = { ...hgPlayer };
            hgShips = [];
            hgTrail = [];
            hgSparxPos = 0;
            hgStartedDrawing = false;
            hgCapturedSquareCount = 0;
            lockBodyScroll(true);

            const overlay = document.getElementById('heung-game-overlay');
            const resultEl = document.getElementById('heung-result');
            const failEl = document.getElementById('heung-fail');
            const area = document.getElementById('heung-game-area');
            const mask = document.getElementById('heung-mask');

            overlay.style.display = 'block';
            resultEl.style.display = 'none';
            failEl.style.display = 'none';

            // ìº”ë²„ìŠ¤/ì…€ í¬ê¸° ì„¤ì • (ë°°ìœ¨ì— ë§ì¶° Monument ë¹„ìœ¨ ìœ ì§€)
            const rect = area.getBoundingClientRect();
            mask.width = rect.width;
            mask.height = rect.height;
            hgCellW = rect.width / HG_COLS;
            hgCellH = rect.height / HG_ROWS;

            initHeungGrid();
            placeHeungPlayer();
            spawnHeungShip();

            updateHeungHearts();
            renderHeungMask();
            updateHeungProgressBar();

            window.addEventListener('keydown', handleHeungKey);
            window.addEventListener('keyup', handleHeungKeyUp);
            window.addEventListener('resize', resizeHeungArea);
            const oldHeungBtns = document.querySelectorAll('.heung-vbtn');
            oldHeungBtns.forEach(btn => {
                const newBtn = btn.cloneNode(true);
                btn.parentNode.replaceChild(newBtn, btn);
            });
            document.querySelectorAll('.heung-vbtn').forEach(btn => {
                const dir = btn.dataset.dir;
                ['touchstart', 'mousedown'].forEach(ev => {
                    btn.addEventListener(ev, e => {
                        e.preventDefault();
                        hgPlayer.dir = dir;
                    }, { passive: false });
                });
                ['touchend', 'mouseup', 'mouseleave'].forEach(ev => {
                    btn.addEventListener(ev, () => {
                        hgPlayer.dir = null;
                    });
                });
            });

            resizeHeungArea();
            hgLoop = setInterval(heungTick, 40);
        }

        function stopHeungGame() {
            hgActive = false;
            clearInterval(hgLoop);
            clearInterval(hgShipInterval);
            window.removeEventListener('keydown', handleHeungKey);
            window.removeEventListener('keyup', handleHeungKeyUp);
            window.removeEventListener('resize', resizeHeungArea);
        }

        function initHeungGrid() {
            hgGrid = Array.from({ length: HG_ROWS }, () => Array(HG_COLS).fill(0));
            // ì™¸ê³½ì„ í™•ë³´ ì˜ì—­ìœ¼ë¡œ ì„¤ì • (í”Œë ˆì´ì–´ê°€ ì›€ì§ì¼ ìˆ˜ ìˆëŠ” ë²½)
            for (let r = 0; r < HG_ROWS; r++) {
                hgGrid[r][0] = 1;
                hgGrid[r][HG_COLS - 1] = 1;
            }
            for (let c = 0; c < HG_COLS; c++) {
                hgGrid[0][c] = 1;
                hgGrid[HG_ROWS - 1][c] = 1;
            }
            hgCapturedCount = (HG_ROWS * 2 + (HG_COLS - 2) * 2); // í…Œë‘ë¦¬ í™•ë³´ëŸ‰
            hgCapturedSquareCount = recalcHeungSquareCaptured(); // ì •ì‚¬ê° ê¸°ì¤€ í™•ë³´ëŸ‰
        }

        function placeHeungPlayer() {
            const player = document.getElementById('heung-player');
            if (!player) {
                const img = document.createElement('img');
                img.id = 'heung-player';
                img.src = 'heung.png';
                img.className = 'absolute z-10';
            document.getElementById('heung-game-area').appendChild(img);
            }
            const p = document.getElementById('heung-player');
            p.style.width = `${hgCellW * 1.2}px`;
            p.style.height = `${hgCellH * 1.2}px`;
            updateHeungPlayerPos();
        }

        function spawnHeungShip() {
            const shipImg = document.createElement('img');
            shipImg.src = 'Western ship.png';
            shipImg.className = 'heung-ship';
            document.getElementById('heung-game-area').appendChild(shipImg);

            const shipData = {
                el: shipImg,
                x: (HG_SQ_START_C + HG_SIDE * 0.5) * hgCellW,
                y: (HG_SQ_START_R + HG_SIDE * 0.5) * hgCellH,
                vx: (Math.random() > 0.5 ? 1 : -1) * (hgCellW * 0.35),
                vy: (Math.random() > 0.5 ? 1 : -1) * (hgCellH * 0.35)
            };
            hgShips = [shipData];
        }

        function resizeHeungArea() {
            if (!hgActive) return;
            const area = document.getElementById('heung-game-area');
            const mask = document.getElementById('heung-mask');
            if (!area || !mask) return;

            const rect = area.getBoundingClientRect();
            const prevW = hgCellW || 1;
            const prevH = hgCellH || 1;

            mask.width = rect.width;
            mask.height = rect.height;
            hgCellW = rect.width / HG_COLS;
            hgCellH = rect.height / HG_ROWS;

            const player = document.getElementById('heung-player');
            if (player) {
                player.style.width = `${hgCellW * 1.2}px`;
                player.style.height = `${hgCellH * 1.2}px`;
            }

            hgShips.forEach(ship => {
                const gx = ship.x / prevW;
                const gy = ship.y / prevH;
                ship.x = gx * hgCellW;
                ship.y = gy * hgCellH;

                const dirX = ship.vx >= 0 ? 1 : -1;
                const dirY = ship.vy >= 0 ? 1 : -1;
                const newVx = Math.max(Math.abs(ship.vx / prevW * hgCellW), hgCellW * 0.25);
                const newVy = Math.max(Math.abs(ship.vy / prevH * hgCellH), hgCellH * 0.25);
                ship.vx = dirX * newVx;
                ship.vy = dirY * newVy;
            });

            updateHeungPlayerPos();
            renderHeungMask();
        }

        function handleHeungKey(e) {
            if (!hgActive) return;
            if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(e.key)) {
                e.preventDefault();
                const map = { ArrowUp: 'up', ArrowDown: 'down', ArrowLeft: 'left', ArrowRight: 'right' };
                hgPlayer.dir = map[e.key];
            }
        }

        function handleHeungKeyUp(e) {
            if (!hgActive) return;
            if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(e.key)) {
                hgPlayer.dir = null;
            }
        }

        function heungTick() {
            if (!hgActive) return;
            moveHeungPlayer();
            moveHeungShipsQix();
            moveHeungSparx();
            renderHeungMask();
            updateHeungProgressBar();
        }

        function isWithinSquare(r, c) {
            return r >= HG_SQ_START_R && r < HG_SQ_START_R + HG_SIDE && c >= HG_SQ_START_C && c < HG_SQ_START_C + HG_SIDE;
        }

        function isPerimeterCell(r, c) {
            if (hgGrid[r][c] !== 1) return false;
            const dirs = [[1,0],[-1,0],[0,1],[0,-1]];
            for (const [dr, dc] of dirs) {
                const nr = r + dr, nc = c + dc;
                if (!isWithinSquare(nr, nc)) continue;
                if (hgGrid[nr][nc] === 0) return true;
            }
            return false;
        }

        function moveHeungPlayer() {
            if (!hgPlayer.dir) return;
            const now = Date.now();
            if (now - hgLastMove < HG_COOLDOWN) return;
            hgLastMove = now;

            const delta = { up: [-1, 0], down: [1, 0], left: [0, -1], right: [0, 1] }[hgPlayer.dir];
            const nr = hgPlayer.r + delta[0];
            const nc = hgPlayer.c + delta[1];
            if (!isWithinSquare(nr, nc)) return;

            const inTrail = hgGrid[nr][nc] === 2;
            const inSafe = hgGrid[nr][nc] === 1;
            const wasDrawing = hgPlayer.drawing;

            // ì•ˆì „ êµ¬ì—­ì´ì§€ë§Œ ë‘˜ë ˆ(perimeter)ê°€ ì•„ë‹Œ ê³³ì— ìˆì„ ë•ŒëŠ” ë°”ë¡œ ì™¸ê³½ìœ¼ë¡œ ì´ë™ì‹œì¼œ ê°‡í˜ ë°©ì§€
            if (!hgPlayer.drawing && hgGrid[hgPlayer.r][hgPlayer.c] === 1 && !isPerimeterCell(hgPlayer.r, hgPlayer.c)) {
                const p = findNearestPerimeter(hgPlayer.r, hgPlayer.c);
                hgPlayer.r = p.r;
                hgPlayer.c = p.c;
                updateHeungPlayerPos();
                hgRespawnPos = { ...hgPlayer };
                return;
            }

            // ì´ë™ ê°€ëŠ¥ì„± ì²´í¬: ê°œë°©ëœ ë‚´ë¶€(1)ë¼ë„ ì™¸ê³½ì´ ì•„ë‹ˆë©´ ì´ë™ ë¶ˆê°€
            if (!hgPlayer.drawing && hgGrid[nr][nc] === 1 && !isPerimeterCell(nr, nc)) return;
            if (hgPlayer.drawing && hgGrid[nr][nc] === 1 && !isPerimeterCell(nr, nc) && !inSafe) return;

            // ê·¸ë¦¬ê¸° ì‹œì‘ (ì™¸ê³½ì—ì„œ ë¯¸ê°œë°©ìœ¼ë¡œ ì§„ì…)
            if (!hgPlayer.drawing && hgGrid[hgPlayer.r][hgPlayer.c] === 1 && isPerimeterCell(hgPlayer.r, hgPlayer.c) && hgGrid[nr][nc] === 0) {
                hgPlayer.drawing = true;
                hgStartedDrawing = true;
                hgTrail = [];
            }

            // ì´ë™
            hgPlayer.r = nr;
            hgPlayer.c = nc;

            // ê·¸ë¦¬ëŠ” ì¤‘ì¼ ë•Œ ì„  ê¸°ë¡
            if (hgPlayer.drawing) {
                if (hgGrid[nr][nc] === 0) {
                    hgGrid[nr][nc] = 2;
                    hgTrail.push([nr, nc]);
                } else if (inTrail) {
                    // ìê¸° ì„ ê³¼ ì¶©ëŒ -> ì‹¤íŒ¨
                    loseHeungLife();
                    return;
                }
            }

            updateHeungPlayerPos();
            // ì•ˆì „ êµ¬ê°„ì¼ ë•Œ ë§ˆì§€ë§‰ ì•ˆì „ ìœ„ì¹˜ë¡œ ì €ì¥ (ë¦¬ìŠ¤í°ìš©)
            if (!hgPlayer.drawing) {
                hgRespawnPos = { r: hgPlayer.r, c: hgPlayer.c };
            }

            // ì•ˆì „ì§€ëŒ€ ë„ì°© ì‹œ ì˜ì—­ í™•ì •
            if (hgPlayer.drawing && inSafe) {
                finalizeHeungTrail();
            }

            // ì ê³¼ ì¶©ëŒ ì²´í¬
            checkHeungLineCollision();
            checkHeungPlayerCollision();
        }

        function moveHeungShipsQix() {
            const minX = HG_SQ_START_C * hgCellW;
            const maxX = (HG_SQ_START_C + HG_SIDE - 1) * hgCellW;
            const minY = HG_SQ_START_R * hgCellH;
            const maxY = (HG_SQ_START_R + HG_SIDE - 1) * hgCellH;
            const minVx = hgCellW * 0.25;
            const minVy = hgCellH * 0.25;

            hgShips.forEach(ship => {
                const w = ship.el.clientWidth || 140;
                const h = ship.el.clientHeight || 140;

                ship.x += ship.vx;
                ship.y += ship.vy;

                // ê²½ê³„ í´ë¨í”„ (ì´ë¯¸ì§€ í¬ê¸° ê³ ë ¤)
                const minXEdge = minX;
                const maxXEdge = maxX - w;
                const minYEdge = minY;
                const maxYEdge = maxY - h;

                if (ship.x < minXEdge) {
                    ship.x = minXEdge + 1;
                    ship.vx = Math.max(Math.abs(ship.vx), minVx);
                }
                if (ship.x > maxXEdge) {
                    ship.x = maxXEdge - 1;
                    ship.vx = -Math.max(Math.abs(ship.vx), minVx);
                }
                if (ship.y < minYEdge) {
                    ship.y = minYEdge + 1;
                    ship.vy = Math.max(Math.abs(ship.vy), minVy);
                }
                if (ship.y > maxYEdge) {
                    ship.y = maxYEdge - 1;
                    ship.vy = -Math.max(Math.abs(ship.vy), minVy);
                }

                // ì¤‘ì•™ì¢Œí‘œ ê¸°ì¤€ ì¶©ëŒ
                const gridX = (ship.x + w / 2) / hgCellW;
                const gridY = (ship.y + h / 2) / hgCellH;

                const gx = Math.floor(gridX);
                const gy = Math.floor(gridY);
                if (gy>=0 && gy<HG_ROWS && gx>=0 && gx<HG_COLS && hgGrid[gy][gx] === 1) {
                    // ë°˜ì‚¬ + í•œ ê±¸ìŒ ë˜ëŒë¦¬ê¸° (ë²½ ì•ˆìª½ìœ¼ë¡œ)
                    ship.vx = -(Math.max(Math.abs(ship.vx), minVx)) * Math.sign(ship.vx || 1);
                    ship.vy = -(Math.max(Math.abs(ship.vy), minVy)) * Math.sign(ship.vy || 1);
                    ship.x += ship.vx * 2;
                    ship.y += ship.vy * 2;
                    // ë‹¤ì‹œ í•œ ë²ˆ ê²½ê³„ í´ë¨í”„
                    ship.x = Math.min(Math.max(ship.x, minXEdge), maxXEdge);
                    ship.y = Math.min(Math.max(ship.y, minYEdge), maxYEdge);
                }

                ship.el.style.left = `${ship.x}px`;
                ship.el.style.top = `${ship.y}px`;
            });

            checkHeungLineCollision();
            checkHeungPlayerCollision();
        }

        function moveHeungSparx() {
            // ì²« ì„ ì„ ê·¸ë¦¬ê¸° ì „ì—ëŠ” Sparx í”¼í•´ ì—†ìŒ
            if (!hgStartedDrawing) return;
            // ê²½ê³„ë¥¼ ë”°ë¼ ì›€ì§ì´ëŠ” ì 
            const perimeter = 2 * (HG_COLS + HG_ROWS - 2);
            const speed = 0.8;
            hgSparxPos = (hgSparxPos + speed) % perimeter;
            const pos = convertPerimeterToRC(hgSparxPos);
            // ì™¸ê³½ ì•ˆì „ ì§€ëŒ€ì—ì„œ í”Œë ˆì´ì–´ê°€ ì¦‰ì‹œ ì‚¬ë§í•˜ì§€ ì•Šë„ë¡ ì¶©ëŒ íŒì • ì œê±°
        }

        function convertPerimeterToRC(t) {
            const topLen = HG_COLS - 1;
            const rightLen = HG_ROWS - 1;
            const bottomLen = HG_COLS - 1;
            // top
            if (t < topLen) return { r: 0, c: Math.floor(t) };
            t -= topLen;
            // right
            if (t < rightLen) return { r: Math.floor(t), c: HG_COLS - 1 };
            t -= rightLen;
            // bottom
            if (t < bottomLen) return { r: HG_ROWS - 1, c: HG_COLS - 1 - Math.floor(t) };
            t -= bottomLen;
            // left
            return { r: HG_ROWS - 1 - Math.floor(t), c: 0 };
        }

        function finalizeHeungTrail() {
            hgPlayer.drawing = false;
            // ì„ ì„ í™•ë³´ ì˜ì—­ìœ¼ë¡œ ë³€ê²½
            hgTrail.forEach(([r, c]) => hgGrid[r][c] = 1);

            // ì ì´ ë‹¿ì„ ìˆ˜ ìˆëŠ” ì˜ì—­ì„ flood fill í›„, ë‹¿ì§€ ì•ŠëŠ” ì˜ì—­ í™•ë³´
            const reachable = Array.from({ length: HG_ROWS }, () => Array(HG_COLS).fill(false));
            const q = [];
            hgShips.forEach(ship => {
                const seed = findNearestEmpty(Math.min(HG_ROWS - 1, Math.max(0, Math.floor((ship.y + (ship.el.clientHeight||0)/2) / hgCellH))),
                                             Math.min(HG_COLS - 1, Math.max(0, Math.floor((ship.x + (ship.el.clientWidth||0)/2) / hgCellW))));
                q.push([seed.r, seed.c]);
                reachable[seed.r][seed.c] = true;
            });
            const dirs = [[1,0],[-1,0],[0,1],[0,-1]];
            while (q.length) {
                const [r,c] = q.shift();
                for (const [dr,dc] of dirs) {
                    const nr = r + dr, nc = c + dc;
                    if (nr<0||nr>=HG_ROWS||nc<0||nc>=HG_COLS) continue;
                    if (reachable[nr][nc]) continue;
                    if (hgGrid[nr][nc] === 1) continue;
                    reachable[nr][nc] = true;
                    q.push([nr,nc]);
                }
            }
            // ë‹¿ì§€ ì•ŠëŠ” ë¹ˆ ì˜ì—­ì„ í™•ë³´
            for (let r = 0; r < HG_ROWS; r++) {
                for (let c = 0; c < HG_COLS; c++) {
                    if (hgGrid[r][c] === 0 && !reachable[r][c]) {
                        hgGrid[r][c] = 1;
                        hgCapturedCount++;
                    }
                }
            }
            // ì„ ë„ í¬í•¨
            hgCapturedCount += hgTrail.length;
            hgTrail = [];
            renderHeungMask();
            hgCapturedSquareCount = recalcHeungSquareCaptured();

            // í™•ë³´ í›„ í”Œë ˆì´ì–´ë¥¼ ê°€ì¥ ê°€ê¹Œìš´ ì™¸ê³½ìœ¼ë¡œ ì´ë™ì‹œì¼œ ë‚´ë¶€ì— ê°‡íˆì§€ ì•Šë„ë¡ ì²˜ë¦¬
            const p = findNearestPerimeter(hgPlayer.r, hgPlayer.c);
            hgPlayer = { r: p.r, c: p.c, dir: null, drawing: false };
            hgRespawnPos = { ...hgPlayer };
            updateHeungPlayerPos();
        }

        function findNearestEmpty(r, c) {
            if (hgGrid[r][c] !== 1) return { r, c };
            const visited = Array.from({ length: HG_ROWS }, () => Array(HG_COLS).fill(false));
            const q = [[r, c]];
            visited[r][c] = true;
            const dirs = [[1,0],[-1,0],[0,1],[0,-1]];
            while (q.length) {
                const [cr, cc] = q.shift();
                for (const [dr, dc] of dirs) {
                    const nr = cr + dr, nc = cc + dc;
                    if (nr<0 || nr>=HG_ROWS || nc<0 || nc>=HG_COLS) continue;
                    if (visited[nr][nc]) continue;
                    visited[nr][nc] = true;
                    if (hgGrid[nr][nc] !== 1) return { r: nr, c: nc };
                    q.push([nr, nc]);
                }
            }
            return { r, c };
        }

        function checkHeungLineCollision() {
            // ì„ ì„ ê·¸ë¦´ ë•Œë§Œ ì„  ì¶©ëŒ íŒì •
            if (!hgPlayer.drawing) return;
            for (const ship of hgShips) {
                const gx = Math.floor((ship.x + (ship.el.clientWidth||0)/2) / hgCellW);
                const gy = Math.floor((ship.y + (ship.el.clientHeight||0)/2) / hgCellH);
                if (gy>=0 && gy<HG_ROWS && gx>=0 && gx<HG_COLS) {
                    if (hgGrid[gy][gx] === 2) {
                        loseHeungLife();
                        return;
                    }
                }
            }
        }

        function checkHeungPlayerCollision() {
            // ì„ ì„ ê·¸ë¦¬ê¸° ì „(ì•ˆì „ì§€ëŒ€)ì—ëŠ” ëª©ìˆ¨ ê°ì†Œ ì—†ìŒ
            if (!hgPlayer.drawing) return;
            const pRect = document.getElementById('heung-player').getBoundingClientRect();
            for (const ship of hgShips) {
                const sRect = ship.el.getBoundingClientRect();
                // íˆíŠ¸ë°•ìŠ¤ë¥¼ ë” ì¤„ì—¬ ì˜¤ê²€ì¶œ ë°©ì§€
                const inset = 18;
                const p = {
                    left: pRect.left + inset,
                    right: pRect.right - inset,
                    top: pRect.top + inset,
                    bottom: pRect.bottom - inset
                };
                const s = {
                    left: sRect.left + inset,
                    right: sRect.right - inset,
                    top: sRect.top + inset,
                    bottom: sRect.bottom - inset
                };
                const overlap = !(p.right < s.left || p.left > s.right || p.bottom < s.top || p.top > s.bottom);
                if (overlap) {
                    loseHeungLife();
                    return;
                }
            }
        }

        function loseHeungLife() {
            hgLives--;
            updateHeungHearts();
            // ì„  ì œê±° (ë¯¸ì™„ì„±)
            for (let r = 0; r < HG_ROWS; r++) {
                for (let c = 0; c < HG_COLS; c++) {
                    if (hgGrid[r][c] === 2) hgGrid[r][c] = 0;
                }
            }
            hgTrail = [];
            // ë§ˆì§€ë§‰ ìœ„ì¹˜(í˜¹ì€ ê°€ì¥ ê°€ê¹Œìš´ ì™¸ê³½)ë¡œ ë¦¬ìŠ¤í°
            const nearestPerimeter = findNearestPerimeter(hgRespawnPos.r, hgRespawnPos.c);
            hgPlayer = { r: nearestPerimeter.r, c: nearestPerimeter.c, dir: null, drawing: false };
            hgStartedDrawing = false;
            updateHeungPlayerPos();
            renderHeungMask();

            if (hgLives <= 0) {
                endHeungGame(false);
            }
        }

        function findNearestPerimeter(r, c) {
            // BFSë¡œ ê°€ì¥ ê°€ê¹Œìš´ ì •ì‚¬ê° ë‚´ë¶€ì˜ perimeter(ì™¸ê³½ í™•ë³´ ì…€) íƒìƒ‰
            const visited = Array.from({ length: HG_ROWS }, () => Array(HG_COLS).fill(false));
            const q = [];
            const clampInSquare = (rr, cc) => ({
                r: Math.min(HG_SQ_START_R + HG_SIDE - 1, Math.max(HG_SQ_START_R, rr)),
                c: Math.min(HG_SQ_START_C + HG_SIDE - 1, Math.max(HG_SQ_START_C, cc)),
            });
            const start = clampInSquare(r, c);
            q.push([start.r, start.c]);
            visited[start.r][start.c] = true;
            const dirs = [[1,0],[-1,0],[0,1],[0,-1]];
            while (q.length) {
                const [cr, cc] = q.shift();
                if (isWithinSquare(cr, cc) && hgGrid[cr][cc] === 1 && isPerimeterCell(cr, cc)) {
                    return { r: cr, c: cc };
                }
                for (const [dr, dc] of dirs) {
                    const nr = cr + dr, nc = cc + dc;
                    if (!isWithinSquare(nr, nc)) continue;
                    if (visited[nr][nc]) continue;
                    visited[nr][nc] = true;
                    q.push([nr, nc]);
                }
            }
            // fallback: ì •ì‚¬ê° ë‚´ë¶€ ì‹œì‘ì  ì¤‘ì•™
            return { r: HG_SQ_START_R, c: Math.floor(HG_SQ_START_C + HG_SIDE / 2) };
        }

        function updateHeungHearts() {
            const hearts = document.getElementById('heung-hearts');
            hearts.textContent = 'â¤ï¸'.repeat(Math.max(0, hgLives)) + 'ğŸ¤'.repeat(Math.max(0, 3 - hgLives));
        }

        function renderHeungMask() {
            const canvas = document.getElementById('heung-mask');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            ctx.fillStyle = 'rgba(0,0,0,1)'; // ì™„ì „ ê°€ë¦¼
            for (let r = 0; r < HG_ROWS; r++) {
                for (let c = 0; c < HG_COLS; c++) {
                    if (hgGrid[r][c] === 0) {
                        ctx.fillRect(c * hgCellW, r * hgCellH, hgCellW + 1, hgCellH + 1);
                    }
                }
            }
            // ê·¸ë¦¬ëŠ” ì„ 
            ctx.fillStyle = 'rgba(59,130,246,0.8)';
            for (let r = 0; r < HG_ROWS; r++) {
                for (let c = 0; c < HG_COLS; c++) {
                    if (hgGrid[r][c] === 2) {
                        ctx.fillRect(c * hgCellW, r * hgCellH, hgCellW + 1, hgCellH + 1);
                    }
                }
            }
        }

        function updateHeungPlayerPos() {
            const player = document.getElementById('heung-player');
            if (!player) return;
            // ìœ„ì¹˜ë¥¼ ì •ì‚¬ê° ê²½ê³„ ì•ˆìœ¼ë¡œ í´ë¨í”„ (CSS ì˜¤í”„ì…‹ ì œê±°)
            const x = hgPlayer.c * hgCellW;
            const y = hgPlayer.r * hgCellH;
            player.style.left = `${x}px`;
            player.style.top = `${y}px`;
        }

        function updateHeungProgressBar() {
            const percent = Math.min(100, Math.round((recalcHeungSquareCaptured() / HG_TOTAL_SQUARE) * 100));
            document.getElementById('heung-progress-bar').style.width = `${percent}%`;
            if (percent >= HG_GOAL) {
                endHeungGame(true);
            }
        }

        function recalcHeungSquareCaptured() {
            let cnt = 0;
            for (let r = HG_SQ_START_R; r < HG_SQ_START_R + HG_SIDE; r++) {
                for (let c = HG_SQ_START_C; c < HG_SQ_START_C + HG_SIDE; c++) {
                    if (hgGrid[r][c] === 1) cnt++;
                }
            }
            hgCapturedSquareCount = cnt;
            return cnt;
        }

        function endHeungGame(success) {
            if (!hgActive) return;
            hgActive = false;
            clearInterval(hgLoop);
            clearInterval(hgShipInterval);
            window.removeEventListener('keydown', handleHeungKey);
            window.removeEventListener('resize', resizeHeungArea);

            if (arcadeMode) {
                if (success) {
                    const time = Date.now() - arcadeStartTime;
                    showArcadeResult(time, true);
                } else {
                    showArcadeResult(0, false);
                }
                return;
            }

            if (success) {
                document.getElementById('heung-result').style.display = 'flex';
            } else {
                document.getElementById('heung-fail').style.display = 'flex';
            }
        }

        let ahnArcadeInterval;

        // --- ì•ˆì¤‘ê·¼ ë¦¬ë“¬ ë¯¸ë‹ˆê²Œì„ ---
        function startAhnGame() {
            stopAhnGame();
            ahnActive = true;
            ahnCurrent = 0;
            ahnNotes = [];
            ahnNextScene = mgNextScene;
            lockBodyScroll(true);

            const overlay = document.getElementById('ahn-game-overlay');
            const ok = document.getElementById('ahn-result-ok');
            const fail = document.getElementById('ahn-result-fail');
            const lights = [1,2,3].map(i => document.getElementById(`ahn-light-${i}`));

            overlay.style.display = 'block';
            ok.style.display = 'none';
            fail.style.display = 'none';
            lights.forEach(l => l.classList.remove('active'));

            // ë²„íŠ¼ ì¬ë°”ì¸ë”©
            const hitBtn = document.getElementById('ahn-hit-btn');
            const proceed = document.getElementById('ahn-proceed-btn');
            const retry = document.getElementById('ahn-retry-btn');

            const newHit = hitBtn.cloneNode(true);
            hitBtn.parentNode.replaceChild(newHit, hitBtn);
            newHit.addEventListener('click', handleAhnHit, { passive: false });
            newHit.addEventListener('touchstart', (e) => {
                e.preventDefault();
                handleAhnHit();
            }, { passive: false });

            const newProceed = proceed.cloneNode(true);
            proceed.parentNode.replaceChild(newProceed, proceed);
            newProceed.addEventListener('click', () => {
                stopAhnGame();
                overlay.style.display = 'none';
                lockBodyScroll(false);
                renderScene(ahnNextScene);
            });

            const newRetry = retry.cloneNode(true);
            retry.parentNode.replaceChild(newRetry, retry);
            newRetry.addEventListener('click', () => {
                stopAhnGame();
                startAhnGame();
            });

            recalcAhnLayout();
            window.addEventListener('resize', recalcAhnLayout);

            if (arcadeMode) {
                // ì•„ì¼€ì´ë“œ ëª¨ë“œ: ë¬´í•œ ìƒì„±
                spawnAhnArcadeNote(); // ì¦‰ì‹œ í•˜ë‚˜ ìƒì„±
                ahnArcadeInterval = setInterval(spawnAhnArcadeNote, 1200);
            } else {
                ahnBeats = generateBeats();
                scheduleAhnBeats();
            }
            
            ahnLoop = setInterval(updateAhnNotes, 16);
        }

        function spawnAhnArcadeNote() {
            if (!ahnActive) return;
            const lane = document.querySelector('.ahn-lane');
            const note = document.createElement('div');
            note.className = 'ahn-note';
            
            // ì ìˆ˜ì— ë”°ë¼ ë‚œì´ë„(ì†ë„) ì¦ê°€
            const difficulty = Math.min(3, 1 + ahnCurrent * 0.05); 
            const speed = (4 + Math.random() * 2) * difficulty;

            if (speed > 8) note.classList.add('fast');
            else if (speed < 5) note.classList.add('slow');

            const laneWidth = lane.getBoundingClientRect().width;
            const offset = (Math.random() - 0.5) * (laneWidth * 0.18);
            note.style.left = `calc(50% + ${offset}px)`;
            lane.appendChild(note);

            ahnNotes.push({ el: note, y: -80, speed, hit: false });

            // ìŠ¤í° ê°„ê²© ì¡°ì ˆ (ì ì°¨ ë¹¨ë¼ì§)
            clearInterval(ahnArcadeInterval);
            const nextInterval = Math.max(400, 1200 - ahnCurrent * 30);
            ahnArcadeInterval = setInterval(spawnAhnArcadeNote, nextInterval);
        }

        function stopAhnGame() {
            ahnActive = false;
            ahnAllowHit = false;
            ahnTimeouts.forEach(t => clearTimeout(t));
            ahnTimeouts = [];
            ahnNotes.forEach(n => n.el.remove());
            ahnNotes = [];
            clearInterval(ahnLoop);
            clearInterval(ahnArcadeInterval);
            window.removeEventListener('resize', recalcAhnLayout);
        }

        function generateBeats() {
            // ì„¸ ë°•, 0msì—ì„œ ì‹œì‘ í›„ ëœë¤ ê°„ê²© 600~1100ms
            const beats = [0];
            beats.push(beats[0] + 600 + Math.random() * 500);
            beats.push(beats[1] + 600 + Math.random() * 500);
            return beats;
        }

        function scheduleAhnBeats() {
            const lane = document.querySelector('.ahn-lane');
            ahnBeats.forEach((beat, idx) => {
                const timeoutId = setTimeout(() => {
                    if (!ahnActive) return;
                    const note = document.createElement('div');
                    note.className = 'ahn-note';
                    // ì†ë„: fast/normal/slow ëœë¤
                    const speedType = Math.random();
                    let speed = 5.2;
                    if (speedType < 0.33) { speed = 6.4; note.classList.add('fast'); }
                    else if (speedType > 0.66) { speed = 4.1; note.classList.add('slow'); }

                    // ì¢Œìš° ì‚´ì§ ëœë¤
                    const laneWidth = lane.getBoundingClientRect().width;
                    const offset = (Math.random() - 0.5) * (laneWidth * 0.18);
                    note.style.left = `calc(50% + ${offset}px)`;
                    lane.appendChild(note);

                    ahnNotes.push({ el: note, y: -80, speed, hit: false });
                }, beat);
                ahnTimeouts.push(timeoutId);
            });
        }

        function handleAhnHit() {
            if (!ahnActive) return;
            const hitY = ahnHitY;
            const windowPx = 60; // íŒì • ë²”ìœ„

            // íˆíŠ¸ë¼ì¸ì— ê°€ì¥ ê°€ê¹Œìš´ ë…¸íŠ¸ ì°¾ê¸°
            let target = null;
            let bestDist = Infinity;
            ahnNotes.forEach(n => {
                const dist = Math.abs(n.y - hitY);
                if (!n.hit && dist < bestDist) {
                    bestDist = dist;
                    target = n;
                }
            });

            if (target && bestDist <= windowPx) {
                target.hit = true;
                target.el.classList.add('hit');
                target.el.style.opacity = '0.15';
                setTimeout(() => target.el.remove(), 120);
                ahnCurrent++;
                
                // ì•„ì¼€ì´ë“œ ëª¨ë“œì—ì„œëŠ” ë¼ì´íŠ¸ ëŒ€ì‹  ì ìˆ˜ íŒì—… ë“±ìœ¼ë¡œ ëŒ€ì²´í•˜ë©´ ì¢‹ê² ì§€ë§Œ
                // ì¼ë‹¨ ë¼ì´íŠ¸ëŠ” 3ê°œë¿ì´ë¯€ë¡œ ë°˜ë³µ ì ë“±
                flashAhnLights(arcadeMode ? (ahnCurrent % 3) + 1 : ahnCurrent);
                
                if (!arcadeMode && ahnCurrent >= 3) {
                    finishAhnGame();
                }
            }
        }

        function finishAhnGame() {
            if (!ahnActive) return;
            
            if (arcadeMode) {
                // ì•„ì¼€ì´ë“œ ëª¨ë“œì—ì„œëŠ” ì‹¤íŒ¨í–ˆì„ ë•Œë§Œ í˜¸ì¶œë¨ (updateAhnNotesì—ì„œ í˜¸ì¶œ)
                // ì„±ê³µì ìœ¼ë¡œ ë§ì¶˜ íšŸìˆ˜(ahnCurrent)ê°€ ì ìˆ˜
                stopAhnGame();
                showArcadeResult(ahnCurrent, false); // ì‹¤íŒ¨í•´ì„œ ëë‚¬ì§€ë§Œ ì ìˆ˜ëŠ” ê¸°ë¡
                return;
            }

            const ok = document.getElementById('ahn-result-ok');
            const fail = document.getElementById('ahn-result-fail');
            if (ahnCurrent >= 3) {
                ok.style.display = 'flex';
            } else {
                fail.style.display = 'flex';
            }
        }

        function updateAhnNotes() {
            if (!ahnActive) return;
            const lane = document.querySelector('.ahn-lane');
            if (!lane) return;
            const laneRect = lane.getBoundingClientRect();
            const maxY = laneRect.height + 100;

            ahnNotes.forEach(n => {
                n.y += n.speed;
                n.el.style.transform = `translate(-50%, ${n.y}px)`;
            });

            // ë¯¸ìŠ¤ íŒì •: íˆíŠ¸ë¼ì¸ ì§€ë‚˜ì³¤ëŠ”ë° ë¯¸ìŠ¤
            ahnNotes = ahnNotes.filter(n => {
                if (n.hit) return false;
                if (n.y - ahnHitY > 70) {
                    // ë¯¸ìŠ¤
                    if (arcadeMode) {
                        finishAhnGame(); // ì•„ì¼€ì´ë“œ ëª¨ë“œ ì¢…ë£Œ
                    } else {
                        finishAhnGame();
                    }
                    n.el.remove();
                    return false;
                }
                if (n.y > maxY) {
                    n.el.remove();
                    return false;
                }
                return true;
            });
        }

        function flashAhnLights(count) {
            const lights = [1,2,3].map(i => document.getElementById(`ahn-light-${i}`));
            lights.forEach((l, idx) => {
                if (idx < count) {
                    l.classList.add('active');
                    setTimeout(() => l.classList.remove('active'), 250);
                }
            });
        }

        function recalcAhnLayout() {
            const hitLineEl = document.getElementById('ahn-hitline');
            const stageEl = document.querySelector('.ahn-stage');
            if (!hitLineEl || !stageEl) return;
            const stageRect = stageEl.getBoundingClientRect();
            const hitRect = hitLineEl.getBoundingClientRect();
            ahnHitY = hitRect.top - stageRect.top;
        }


        function startBearGame() {
            mgScore = 0;
            mgActive = true;
            lockBodyScroll(true);

            const overlay = document.getElementById('minigame-overlay');
            const scoreEl = document.getElementById('mg-score');
            const resultEl = document.getElementById('mg-result');
            const gameArea = document.getElementById('mg-game-area');
            const proceedBtn = document.getElementById('mg-proceed-btn');
            const titleText = document.getElementById('mg-title-text');

            overlay.style.display = 'block';
            resultEl.classList.add('hidden');
            scoreEl.textContent = '0';
            gameArea.innerHTML = ''; // ê¸°ì¡´ ì•„ì´í…œ ì œê±°
            
            if (arcadeMode) {
                mgLives = 3;
                mgArcadeTimeLeft = 30;
                titleText.innerHTML = `30ì´ˆ ëª¨ë“œ: <span id="mg-score">0</span> <span class="text-red-400 text-sm ml-2">(ë‚¨ì€ ê¸°íšŒ: <span id="mg-lives">3</span>)</span> <span class="text-amber-300 text-sm ml-3">â± <span id="mg-timer">30.0s</span></span>`;
            } else {
                titleText.innerHTML = `ì¸ë‚´ì‹¬: <span id="mg-score">0</span> / 100`;
            }

            // ê¸°ì¡´ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì œê±° (ì¤‘ë³µ ë°©ì§€)
            const newProceedBtn = proceedBtn.cloneNode(true);
            proceedBtn.parentNode.replaceChild(newProceedBtn, proceedBtn);
            
            newProceedBtn.addEventListener('click', () => {
                document.getElementById('minigame-overlay').style.display = 'none';
                lockBodyScroll(false);
                if (arcadeMode) {
                    // ì•„ì¼€ì´ë“œì—ì„œëŠ” ë©”ë‰´ë¡œ ë³µê·€
                    showMinigameMenu();
                } else {
                    renderScene(mgNextScene);
                }
            });

            // ê²Œì„ ë£¨í”„ ì‹œì‘ (0.4ì´ˆë§ˆë‹¤ ìƒì„±)
            mgInterval = setInterval(spawnItem, 400);

            // ì•„ì¼€ì´ë“œ ì „ìš© 30ì´ˆ íƒ€ì´ë¨¸
            if (arcadeMode) {
                const timerEl = document.getElementById('mg-timer');
                clearInterval(mgArcadeTimer);
                mgArcadeTimer = setInterval(() => {
                    mgArcadeTimeLeft = Math.max(0, mgArcadeTimeLeft - 0.1);
                    if (timerEl) timerEl.textContent = `${mgArcadeTimeLeft.toFixed(1)}s`;
                    if (mgArcadeTimeLeft <= 0) {
                        clearInterval(mgArcadeTimer);
                        endMinigame(true); // íƒ€ì„ì—… ì‹œ ê²Œì„ ì¢…ë£Œ (ì ìˆ˜ ê¸°ë¡)
                    }
                }, 100);
            }
        }

        function startRiverGame() {
            rgActive = true;
            jumongCol = 0;
            jumongRow = Math.floor(RG_ROWS / 2);
            riverGrid = [];
            lockBodyScroll(true);

            const overlay = document.getElementById('river-game-overlay');
            const resultEl = document.getElementById('rg-result');
            const gameArea = document.getElementById('rg-game-area');
            const jumongChar = document.getElementById('jumong-char');
            const proceedBtn = document.getElementById('rg-proceed-btn');

            overlay.style.display = 'block';
            resultEl.classList.add('hidden');
            document.getElementById('rg-failure').classList.add('hidden');
            
            updateJumongPos();
            
            // ê¸°ì¡´ ì•„ì´í…œ ì œê±° (ì£¼ëª½ ì œì™¸)
            const oldItems = gameArea.querySelectorAll('.river-item');
            oldItems.forEach(el => el.remove());

            // ì§„í–‰ ë²„íŠ¼ ì´ë²¤íŠ¸ ì¬ë“±ë¡
            const newProceedBtn = proceedBtn.cloneNode(true);
            proceedBtn.parentNode.replaceChild(newProceedBtn, proceedBtn);

            newProceedBtn.addEventListener('click', () => {
                document.getElementById('river-game-overlay').style.display = 'none';
                lockBodyScroll(false);
                renderScene(mgNextScene);
            });

            // ì´ˆê¸° ì•„ì´í…œ ìƒì„±: ê°€ìš´ë° 2ì¤„ë§Œ ì±„ìš°ê¸° (ìœ—ì¤„ê³¼ ì•„ë«ì¤„ì€ ë¹ˆ ìƒíƒœë¡œ ìœ ì§€)
            for (let r = 1; r < RG_ROWS - 1; r++) { // í–‰ 1ê³¼ 2ë§Œ ì±„ì›€ (ìœ—ì¤„ 0, ì•„ë«ì¤„ 3 ì œì™¸)
                for (let c = 0; c < RG_COLS; c++) {
                    spawnSingleItem(r, c, gameArea);
                }
            }

            // ì•„ì´í…œ ì œê±° íƒ€ì´ë¨¸ (2ì´ˆë§ˆë‹¤ ëœë¤í•˜ê²Œ í•˜ë‚˜ì”© ì œê±°)
            rgInterval = setInterval(removeRandomItem, ITEM_REMOVE_INTERVAL);
            
            // í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ë“±ë¡
            window.addEventListener('keydown', handleRgKeydown);
            
            // ê°€ìƒ í‚¤íŒ¨ë“œ ì´ë²¤íŠ¸ ë“±ë¡ (í•œ ë²ˆ í„°ì¹˜/í´ë¦­í•  ë•Œë§ˆë‹¤ í•œ ë²ˆë§Œ ì´ë™)
            const oldVBtns = document.querySelectorAll('.v-btn');
            oldVBtns.forEach(btn => {
                const newBtn = btn.cloneNode(true);
                btn.parentNode.replaceChild(newBtn, btn);
            });
            const vBtns = document.querySelectorAll('.v-btn');
            vBtns.forEach(btn => {
                btn.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    const currentTime = Date.now();
                    if (currentTime - lastKeyTime >= KEY_COOLDOWN) {
                        lastKeyTime = currentTime;
                        handleRgMove(btn.dataset.dir);
                    }
                }, { passive: false });

                btn.addEventListener('mousedown', (e) => {
                    e.preventDefault();
                    const currentTime = Date.now();
                    if (currentTime - lastKeyTime >= KEY_COOLDOWN) {
                        lastKeyTime = currentTime;
                        handleRgMove(btn.dataset.dir);
                    }
                });
            });
        }

        function stopRiverGame() {
            rgActive = false;
            clearInterval(rgInterval);
            window.removeEventListener('keydown', handleRgKeydown);
        }

        function handleRgKeydown(e) {
            if (!rgActive) return;

            const currentTime = Date.now();
            if (currentTime - lastKeyTime < KEY_COOLDOWN) return; // ì¿¨ë‹¤ìš´ ì¤‘ì´ë©´ ë¬´ì‹œ

            let direction = null;
            if (e.key === 'ArrowUp') direction = 'up';
            else if (e.key === 'ArrowDown') direction = 'down';
            else if (e.key === 'ArrowLeft') direction = 'left';
            else if (e.key === 'ArrowRight') direction = 'right';

            if (direction) {
                lastKeyTime = currentTime;
                handleRgMove(direction);
            }
        }

        function handleRgMove(dir) {
            let nextRow = jumongRow;
            let nextCol = jumongCol;

            if (dir === 'up') nextRow--;
            if (dir === 'down') nextRow++;
            if (dir === 'left') nextCol--;
            if (dir === 'right') nextCol++;

            // ê²©ì ë²”ìœ„ ì²´í¬
            if (nextRow < 0 || nextRow >= RG_ROWS) return;
            if (nextCol < 0) return; // ì™¼ìª½ìœ¼ë¡œëŠ” ëª» ë‚˜ê°

            // ì˜¤ë¥¸ìª½ ë ë„ë‹¬ (ìŠ¹ë¦¬)
            if (nextCol >= RG_COLS) {
                endRiverGame(true);
                return;
            }

            // ì´ë™í•˜ë ¤ëŠ” ì¹¸ì— ì•„ì´í…œì´ ìˆëŠ”ì§€ í™•ì¸
            const item = riverGrid.find(i => i.r === nextRow && i.c === nextCol);

            if (item) {
                // ì•ˆì „í•˜ê²Œ ì´ë™
                jumongRow = nextRow;
                jumongCol = nextCol;
                updateJumongPos();

                // ì´ë™ í›„ ê²Œì„ ì˜¤ë²„ ì²´í¬
                setTimeout(() => checkGameOver(), 100);
            } else {
                // ë¬¼ì— ë¹ ì§
                resetJumong();
                // ì‹¤íŒ¨ ì‹œì—ë„ ê²Œì„ ì˜¤ë²„ ì²´í¬
                setTimeout(() => checkGameOver(), 100);
            }
        }

        // ê²Œì„ ì˜¤ë²„ ì²´í¬ í•¨ìˆ˜
        function checkGameOver() {
            // ì´ë™ ê°€ëŠ¥í•œ ë°©í–¥ì´ ìˆëŠ”ì§€ ì²´í¬
            const directions = [
                { r: jumongRow - 1, c: jumongCol }, // ìœ„
                { r: jumongRow + 1, c: jumongCol }, // ì•„ë˜
                { r: jumongRow, c: jumongCol + 1 }  // ì˜¤ë¥¸ìª½ (ì£¼ìš” ì´ë™ ë°©í–¥)
            ];

            let canMove = false;

            // ì˜¤ë¥¸ìª½ ë ë„ë‹¬ ê°€ëŠ¥í•œì§€ ë¨¼ì € ì²´í¬
            if (jumongCol >= RG_COLS - 1) {
                // ì´ë¯¸ ëì— ê°€ê¹Œì´ ì™”ìŒ - ì„±ê³µìœ¼ë¡œ ì²˜ë¦¬
                endRiverGame(true);
                return;
            }

            for (const dir of directions) {
                // ë²”ìœ„ ì²´í¬
                if (dir.r < 0 || dir.r >= RG_ROWS) continue;
                if (dir.c < 0) continue;
                if (dir.c >= RG_COLS) {
                    canMove = true; // ì˜¤ë¥¸ìª½ ë ë„ë‹¬ ê°€ëŠ¥
                    break;
                }

                // í•´ë‹¹ ìœ„ì¹˜ì— ì•„ì´í…œì´ ìˆëŠ”ì§€ ì²´í¬
                const item = riverGrid.find(i => i.r === dir.r && i.c === dir.c);
                if (item) {
                    canMove = true;
                    break;
                }
            }

            if (!canMove && riverGrid.length <= 2) {
                // ì´ë™í•  ìˆ˜ ì—†ê³  ì•„ì´í…œë„ ê±°ì˜ ì—†ìŒ - ê²Œì„ ì˜¤ë²„
                endRiverGame(false);
            }
        }

        function updateJumongPos() {
            const jumongChar = document.getElementById('jumong-char');
            // ê²©ì ì¢Œí‘œë¥¼ %ë¡œ ë³€í™˜
            // ì—´: 6ê°œ -> 16.66% ì”©. ì¤‘ì•™ ì •ë ¬ì„ ìœ„í•´ ì•½ê°„ ì¡°ì •.
            // í–‰: 4ê°œ -> 25% ì”©.
            const x = (jumongCol * (100 / RG_COLS)) + (50 / RG_COLS); // ì—´ì˜ ì¤‘ì•™
            const y = (jumongRow * (100 / RG_ROWS)) + (50 / RG_ROWS); // í–‰ì˜ ì¤‘ì•™
            
            // ì£¼ëª½ í¬ê¸°(60px) ê³ ë ¤í•´ì„œ ì¤‘ì•™ ë°°ì¹˜ (transformì´ -50% -50% ë˜ì–´ìˆë‹¤ê³  ê°€ì •)
            // CSSì—ì„œ transform: translateY(-50%)ë§Œ ë˜ì–´ìˆìœ¼ë¯€ë¡œ leftë„ ì¡°ì • í•„ìš”
            // CSS ìˆ˜ì • ëŒ€ì‹  left, topì„ ì¤‘ì•™ê°’ìœ¼ë¡œ ì£¼ê³  transformì„ translate(-50%, -50%)ë¡œ ë³€ê²½í•˜ëŠ” ê²Œ ì¢‹ìŒ
            // ì¼ë‹¨ í˜„ì¬ CSS: transform: translateY(-50%); left: %; top: %;
            // ê°€ë¡œ ì¤‘ì•™ ì •ë ¬ì„ ìœ„í•´ JSì—ì„œ ì˜¤í”„ì…‹ ì¡°ì •í•˜ê±°ë‚˜ CSS ë³€ê²½.
            // ì—¬ê¸°ì„œëŠ” ê°„ë‹¨íˆ ê³„ì‚°ëœ % ì‚¬ìš©.
            
            jumongChar.style.left = `calc(${x}% - 30px)`; // 30pxëŠ” widthì˜ ì ˆë°˜
            jumongChar.style.top = `${y}%`; 
        }


        function spawnSingleItem(r, c, gameArea) {
             const items = ['fish.png', 'Terrapin.png'];
            const src = items[Math.floor(Math.random() * items.length)];

            const img = document.createElement('img');
            img.src = src;
            img.className = 'river-item';

            // ìœ„ì¹˜ ê³„ì‚°
            const x = (c * (100 / RG_COLS)) + (50 / RG_COLS);
            const y = (r * (100 / RG_ROWS)) + (50 / RG_ROWS);

            img.style.left = `calc(${x}% - 105px)`;
            img.style.top = `calc(${y}% - 75px)`;

            gameArea.appendChild(img);

            const itemObj = { r, c, el: img };
            riverGrid.push(itemObj);

            // ì´ˆê¸° ìƒì„±ëœ ì•„ì´í…œë“¤ë„ ëœë¤ ì‹œê°„ í›„ ì‚¬ë¼ì§€ê²Œ í•¨ (ì¢€ ë” ëŠë¦¬ê²Œ)
            const randomDuration = 4000 + Math.random() * 4000; // 4-8ì´ˆ ëœë¤
            setTimeout(() => {
                if (!rgActive) return;

                if (jumongRow === r && jumongCol === c) {
                    resetJumong();
                }

                riverGrid = riverGrid.filter(i => i !== itemObj);

                if (img.parentNode) {
                    img.style.opacity = '0';
                    setTimeout(() => img.remove(), 500);
                }
            }, randomDuration);
        }

        // ëœë¤í•˜ê²Œ ì•„ì´í…œ í•˜ë‚˜ ì œê±°
        function removeRandomItem() {
            if (!rgActive || riverGrid.length === 0) return;

            // í˜„ì¬ ì£¼ëª½ì´ ë°Ÿê³  ìˆëŠ” ì•„ì´í…œì€ ì œê±°í•˜ì§€ ì•ŠìŒ (ì•ˆì „ì¥ì¹˜)
            const safeItems = riverGrid.filter(item => !(item.r === jumongRow && item.c === jumongCol));

            if (safeItems.length === 0) return;

            // ëœë¤í•˜ê²Œ í•˜ë‚˜ ì„ íƒí•´ì„œ ì œê±°
            const randomIndex = Math.floor(Math.random() * safeItems.length);
            const itemToRemove = safeItems[randomIndex];

            // ë°°ì—´ì—ì„œ ì œê±°
            riverGrid = riverGrid.filter(i => i !== itemToRemove);

            // DOMì—ì„œ ì œê±°
            if (itemToRemove.el.parentNode) {
                itemToRemove.el.style.opacity = '0';
                setTimeout(() => itemToRemove.el.remove(), 500);
            }

            // ì•„ì´í…œ ì œê±° í›„ ê²Œì„ ì˜¤ë²„ ì²´í¬
            setTimeout(() => checkGameOver(), 100);
        }

        function resetJumong() {
            // íš¨ê³¼: ê¹œë¹¡ì„ + ìœ„ì¹˜ ì´ˆê¸°í™”
            const jumongChar = document.getElementById('jumong-char');
            jumongChar.style.transition = 'none';
            jumongChar.style.opacity = '0';
            
            setTimeout(() => {
                jumongCol = 0;
                jumongRow = Math.floor(RG_ROWS / 2);
                updateJumongPos();
                
                jumongChar.style.opacity = '1';
                setTimeout(() => jumongChar.style.transition = 'all 0.3s ease-out', 50);
            }, 300);
        }

        function endRiverGame(success) {
            stopRiverGame();

            if (arcadeMode) {
                if (success) {
                    const time = Date.now() - arcadeStartTime;
                    showArcadeResult(time, true);
                } else {
                    showArcadeResult(0, false);
                }
                return;
            }

            if (success) {
                const resultEl = document.getElementById('rg-result');
                resultEl.classList.remove('hidden');
            } else {
                // ì‹¤íŒ¨ ì¼€ì´ìŠ¤
                const failureEl = document.getElementById('rg-failure');
                failureEl.classList.remove('hidden');
            }
        }

        // ì›…ë…€ ê²Œì„ ì§„í–‰ ë²„íŠ¼
        document.getElementById('mg-proceed-btn').addEventListener('click', () => {
            document.getElementById('minigame-overlay').style.display = 'none';
            lockBodyScroll(false);
            renderScene(mgNextScene);
        });

        // ì£¼ëª½ ê²Œì„ ì§„í–‰ ë²„íŠ¼
        document.getElementById('rg-proceed-btn').addEventListener('click', () => {
            document.getElementById('river-game-overlay').style.display = 'none';
            lockBodyScroll(false);
            renderScene(mgNextScene);
        });

        // ì£¼ëª½ ê²Œì„ ë‹¤ì‹œ ì‹œì‘ ë²„íŠ¼
        document.getElementById('rg-restart-btn').addEventListener('click', () => {
            document.getElementById('river-game-overlay').style.display = 'none';
            lockBodyScroll(false);
            // ê²Œì„ ì‹œì‘ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°
            renderScene('start');
        });

        // ë°©ì–´ì „ ê²Œì„ ì§„í–‰ ë²„íŠ¼
        bindDefenseProceedBtn();

        // í¥ì„ ëŒ€ì›êµ° ê²Œì„ ì§„í–‰ / ì¬ì‹œì‘ ë²„íŠ¼
        document.getElementById('heung-proceed-btn').addEventListener('click', () => {
            document.getElementById('heung-game-overlay').style.display = 'none';
            lockBodyScroll(false);
            renderScene(mgNextScene);
        });
        document.getElementById('heung-restart-btn').addEventListener('click', () => {
            document.getElementById('heung-game-overlay').style.display = 'none';
            lockBodyScroll(false);
            renderScene('start');
        });

        function spawnItem() {
            if (!mgActive) return;

            const gameArea = document.getElementById('mg-game-area');
            const items = [
                { src: 'garlic.png', type: 'good' },
                { src: 'Mugwort.png', type: 'good' },
                { src: 'meat.png', type: 'bad' },
                { src: 'byu.png', type: 'bad' }
            ];

            const itemData = items[Math.floor(Math.random() * items.length)];
            
            const img = document.createElement('img');
            img.src = itemData.src;
            img.className = 'falling-item';
            
            // ëœë¤ ìœ„ì¹˜ (í™”ë©´ ë„ˆë¹„ ê³ ë ¤)
            const itemWidth = window.innerWidth < 768 ? 60 : 80;
            const x = Math.random() * (window.innerWidth - itemWidth);
            img.style.left = `${x}px`;
            
            // ëœë¤ ì†ë„
            const duration = 2 + Math.random() * 3;
            img.style.animationDuration = `${duration}s`;

            const clickHandler = (e) => {
                if (!mgActive) return;
                
                const change = itemData.type === 'good' ? 2 : -2;
                updateScore(change);
                showScorePopup(e.clientX, e.clientY, change);
                img.remove();
            };

            img.addEventListener('mousedown', clickHandler);
            img.addEventListener('touchstart', (e) => {
                e.preventDefault();
                const touch = e.touches[0];
                clickHandler({ clientX: touch.clientX, clientY: touch.clientY });
            }, { passive: false });

            img.addEventListener('animationend', () => img.remove());
            gameArea.appendChild(img);
        }

        function updateScore(change) {
            mgScore += change;
            if (mgScore < 0) mgScore = 0;

            const scoreEl = document.getElementById('mg-score');
            if (scoreEl) scoreEl.textContent = mgScore;

            if (arcadeMode) {
                if (change < 0) {
                    mgLives--;
                    const livesEl = document.getElementById('mg-lives');
                    if(livesEl) livesEl.textContent = mgLives;
                    if (mgLives <= 0) {
                        endMinigame(true); // ì•„ì¼€ì´ë“œ ëª¨ë“œ ì¢…ë£Œ (ì„±ê³µ íŒì •ìœ¼ë¡œ ì ìˆ˜ ê¸°ë¡)
                    }
                }
            } else {
                if (mgScore >= 100) {
                    endMinigame(true);
                }
            }
        }

        function showScorePopup(x, y, change) {
            const popup = document.createElement('div');
            popup.className = 'score-popup';
            popup.textContent = change > 0 ? "+2" : "-2";
            popup.style.color = change > 0 ? "#4ade80" : "#ef4444";
            popup.style.left = `${x}px`;
            popup.style.top = `${y}px`;
            document.getElementById('minigame-overlay').appendChild(popup);
            
            popup.addEventListener('animationend', () => popup.remove());
        }

        function endMinigame(success) {
            mgActive = false;
            clearInterval(mgInterval);
            clearInterval(mgArcadeTimer);
            
            if (arcadeMode) {
                showArcadeResult(mgScore, true); // í•­ìƒ ê²°ê³¼ì°½ í‘œì‹œ
                return;
            }

            if (success) {
                const resultEl = document.getElementById('mg-result');
                resultEl.classList.remove('hidden');
            }
        }

        // ì§„í–‰í•˜ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸
        document.getElementById('mg-proceed-btn').addEventListener('click', () => {
            document.getElementById('minigame-overlay').style.display = 'none';
            lockBodyScroll(false);
            renderScene(mgNextScene);
        });

        // ê²Œì„ ì‹œì‘ ì‹œ ì´ˆê¸°í™”
        window.addEventListener('DOMContentLoaded', () => {
            // ì´ˆê¸° ë²„íŠ¼ ìƒíƒœ ì²´í¬
            if (localStorage.getItem('korean_history_true_ending') === 'true') {
                const btn = document.getElementById('minigame-menu-btn');
                if (btn) btn.classList.remove('hidden');
                
                const hofBtn = document.getElementById('hof-menu-btn');
                if (hofBtn) hofBtn.classList.remove('hidden');
            }
            
            // ê¸°ì¡´ ì´ˆê¸°í™” ë¡œì§
            startGame();
        });

        function startGame() {
            renderScene('start');
        }

        let turnCount = 0;

        function renderScene(sceneId) {
            // ì§„ì—”ë”© ì²´í¬ ë° í•´ê¸ˆ
            if (sceneId === 'liberation_day') {
                localStorage.setItem('korean_history_true_ending', 'true');
                // íŠ¸ë£¨ì—”ë”© í´ë¦¬ì–´ íšŸìˆ˜ ì¦ê°€
                const trueEndingCount = parseInt(localStorage.getItem('korean_history_true_ending_count') || '0');
                localStorage.setItem('korean_history_true_ending_count', (trueEndingCount + 1).toString());
            }
            // ë¯¸ë‹ˆê²Œì„ ë²„íŠ¼ ë…¸ì¶œ ì—¬ë¶€ ì²´í¬
            if (localStorage.getItem('korean_history_true_ending') === 'true') {
                const btn = document.getElementById('minigame-menu-btn');
                if (btn) btn.classList.remove('hidden');
                
                const hofBtn = document.getElementById('hof-menu-btn');
                if (hofBtn) hofBtn.classList.remove('hidden');
            }

            const data = getSafeData(sceneId);
            const container = document.getElementById('game-container');
            const choicesDiv = document.getElementById('choices');

            // ì¹­í˜¸ í•´ê¸ˆ ì²´í¬
            if (data.unlock) {
                unlockTitle(data.unlock);
            }

            // í„´ìˆ˜ ì¦ê°€ (ì •ì‚¬ ì§„í–‰ì¼ ë•Œë§Œ)
            if (data.type === 'history') turnCount++;
            document.getElementById('turn-count').textContent = `Turn: ${turnCount}`;

            // ì• ë‹ˆë©”ì´ì…˜ ë¦¬ì…‹
            container.classList.remove('fade-in');
            void container.offsetWidth;
            container.classList.add('fade-in');

            // í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            document.getElementById('scene-title-header').textContent = data.title;
            document.getElementById('scene-desc').innerHTML = data.desc;
            document.getElementById('scene-icon').textContent = data.icon || "ğŸ“œ";
            document.getElementById('game-year').textContent = data.year || "";
            
            // ì‹œëŒ€ ë±ƒì§€ ì„¤ì •
            const badgeSpan = document.getElementById('current-era-badge');
            badgeSpan.className = `text-xs font-bold px-2 py-1 rounded mb-1 w-fit ${data.badge || 'bg-stone-500 text-white'}`;
            badgeSpan.textContent = data.era || (data.type === 'crisis' ? "ìœ„ê¸° ìƒí™©" : "ì—­ì‚¬ì˜ ê°ˆë¦¼ê¸¸");
            
            document.getElementById('era-name').textContent = data.era || "";

            // ì§„í–‰ë°” ì—…ë°ì´íŠ¸
            const progressBar = document.getElementById('progress-bar');
            progressBar.style.width = (data.progress || 0) + '%';
            
            if (data.type === 'crisis') {
                progressBar.className = 'h-2 transition-all duration-500 ease-out relative bg-red-600';
            } else if (data.type === 'ending' && data.progress === 100) {
                progressBar.className = 'h-2 transition-all duration-500 ease-out relative bg-blue-600';
            } else {
                progressBar.className = 'h-2 transition-all duration-500 ease-out relative bg-amber-700';
            }

            // ì„ íƒì§€ ë Œë”ë§
            choicesDiv.innerHTML = '';
            
            let choicesToRender = [...data.choices];
            if (data.type !== 'ending') {
                choicesToRender = shuffleArray(choicesToRender);
            }

            choicesToRender.forEach(choice => {
                const btn = document.createElement('button');
                let btnClass = "w-full py-4 px-6 rounded-lg font-bold text-lg text-left mb-3 btn-card break-keep min-h-[80px] flex items-center";
                
                if (choice.style === 'restart') btnClass += " btn-special";

                btn.className = btnClass;
                btn.textContent = choice.text;
                
                // ì„ íƒì§€ í´ë¦­ ì‹œ ì¹­í˜¸ í•´ê¸ˆ (ì„ íƒì§€ì— unlock ì†ì„±ì´ ìˆëŠ” ê²½ìš°)
                btn.addEventListener('click', () => {
                    console.log('Choice clicked:', choice.text, 'minigame:', choice.minigame);
                    if (choice.unlock) unlockTitle(choice.unlock);

                    // onclick ì†ì„±ì´ ìˆìœ¼ë©´ ì‹¤í–‰ (ì»¤ìŠ¤í…€ ë™ì‘)
                    if (choice.onclick) {
                        // ê°„ë‹¨í•œ í•¨ìˆ˜ í˜¸ì¶œ ì²˜ë¦¬
                        try {
                            // window ê°ì²´ì— ìˆëŠ” í•¨ìˆ˜ ì‹¤í–‰
                            const parts = choice.onclick.split('(');
                            const funcName = parts[0];
                            const args = parts[1] ? parts[1].replace(')', '').split(',').map(a => a.trim().replace(/['"]/g, '')) : [];
                            
                            if (typeof window[funcName] === 'function') {
                                if (args[0] === "true") window[funcName](true);
                                else if (args[0] === "false") window[funcName](false);
                                else window[funcName](...args);
                            }
                        } catch (e) {
                            console.error("Custom action failed:", e);
                        }
                        return; // ì”¬ ì´ë™ ì•ˆí•¨
                    }

                    if (choice.minigame) {
                        console.log('Starting minigame:', choice.minigame, 'from story mode');
                        arcadeMode = false; // ìŠ¤í† ë¦¬ì—ì„œ ë¯¸ë‹ˆê²Œì„ ì‹¤í–‰ ì‹œ ê°•ì œ ì¼ë°˜ ëª¨ë“œ
                        startMinigame(choice.minigame, choice.next);
                    } else {
                        // ì˜¬ë°”ë¥¸ ì„ íƒ(ì—”ë”©/ìœ„ê¸° ì œì™¸)ì¼ ë•Œ ë°©ê¸ˆ ì„ íƒ ê²°ê³¼ ì˜¤ë²„ë ˆì´ í‘œì‹œ
                        const currentData = data;
                        
                        // nextê°€ ì—†ëŠ” ê²½ìš° (ì˜ˆ: ë‹¨ìˆœ í…ìŠ¤íŠ¸ íŒì—… ë“±) ì²˜ë¦¬
                        if (!choice.next) return;

                        const nextData = getSafeData(choice.next);
                        if (nextData.type !== 'ending' && nextData.type !== 'crisis') {
                            showChoiceResult(choice, currentData, choice.next);
                        } else {
                            renderScene(choice.next);
                        }
                    }
                });
                
                choicesDiv.appendChild(btn);
            });
        }

        function showChoiceResult(choice, currentScene, nextId) {
            const overlay = document.getElementById('choice-result-overlay');
            const nextData = getSafeData(nextId);

            const override = choiceResultOverrides[choice.text];
            let title = choice.resultTitle || `ì„ íƒ ê²°ê³¼: ${choice.text}`;
            let desc = choice.resultDesc || null;

            if (override) {
                title = override.title;
                desc = override.desc;
            }

            if (!desc) {
                const nextTitle = nextData.title || 'ë‹¤ìŒ ë‹¨ê³„';
                const nextDesc = nextData.desc || '';
                if (currentScene?.type === 'crisis') {
                    desc = `${choice.text}ë¡œ ìœ„ê¸°ë¥¼ ìˆ˜ìŠµí–ˆìŠµë‹ˆë‹¤.<br><br>${nextTitle}<br>${nextDesc}`;
                } else if (nextData.type === 'crisis') {
                    desc = `${choice.text}ì„(ë¥¼) ì‹¤í–‰í–ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ìƒˆë¡œìš´ ìœ„ê¸°ê°€ ë‹¤ê°€ì˜µë‹ˆë‹¤.<br><br>${nextTitle}<br>${nextDesc}`;
                } else {
                    desc = `${choice.text}ì„(ë¥¼) ì‹¤í–‰í–ˆìŠµë‹ˆë‹¤.<br><br>${nextTitle}<br>${nextDesc}`;
                }
            }

            document.getElementById('choice-result-title').textContent = title;
            document.getElementById('choice-result-desc').innerHTML = desc;

            // ì§„í–‰ ë²„íŠ¼ ì¬ë°”ì¸ë”©
            const proceed = document.getElementById('choice-result-proceed');
            const newBtn = proceed.cloneNode(true);
            proceed.parentNode.replaceChild(newBtn, proceed);
            newBtn.addEventListener('click', () => {
                overlay.classList.add('hidden');
                renderScene(nextId);
            });

            overlay.classList.remove('hidden');
        }
    </script>
</body>
</html>
